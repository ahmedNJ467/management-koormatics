"use strict";(()=>{var a={};a.id=4955,a.ids=[636,3220,4955],a.modules={5223:(a,b,c)=>{c.d(b,{U:()=>f});var d=c(8732),e=c(82015);function f({children:a}){let[b,c]=(0,e.useState)("authenticated");return(0,d.jsxs)(d.Fragment,{children:["unauthenticated"===b&&(0,d.jsxs)("div",{className:"p-4 mb-4 border rounded-md bg-destructive/10 text-destructive",children:[(0,d.jsx)("p",{className:"font-medium",children:"Authentication required"}),(0,d.jsx)("p",{className:"text-sm",children:"You need to be logged in to add or edit vehicles."})]}),a]})}c(95965)},8732:a=>{a.exports=require("react/jsx-runtime")},8938:a=>{a.exports=import("class-variance-authority")},9640:a=>{a.exports=import("@radix-ui/react-slot")},13020:a=>{a.exports=import("@radix-ui/react-dialog")},14225:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{e:()=>i});var e=c(8732),f=c(66345),g=c(74952),h=a([f]);function i({onAddVehicle:a}){return(0,e.jsxs)("div",{className:"flex flex-col items-center justify-center p-8 text-center",children:[(0,e.jsx)(g.THT,{className:"h-16 w-16 text-muted-foreground mb-4"}),(0,e.jsx)("h3",{className:"text-lg font-medium",children:"No vehicles found"}),(0,e.jsx)("p",{className:"text-muted-foreground mb-4",children:"Add your first vehicle to get started."}),(0,e.jsx)(f.$,{variant:"outline",onClick:a,children:"Add Vehicle"})]})}f=(h.then?(await h)():h)[0],d()}catch(a){d(a)}})},14505:a=>{a.exports=import("@radix-ui/react-scroll-area")},15248:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{M:()=>k});var e=c(82015),f=c(95965),g=c(76569),h=c(28462),i=c(96301),j=a([h]);function k(a,b,c){let{toast:d}=(0,g.dj)(),{handleError:j}=(0,i.ud)(),k=(0,h.useQueryClient)(),[l,m]=(0,e.useState)(!1),n=async()=>{try{let{error:a}=await f.N.from("vehicles").select("fuel_type").limit(1);return!a}catch{return!1}};return{onSubmit:async e=>{try{m(!0);let g=!1,h=!1,j=await n();console.log("Fuel type column supported:",j);let l={make:e.make,model:e.model,registration:e.registration.trim().toUpperCase(),type:e.type,status:e.status,year:e.year?Number(e.year):null,color:e.color||null,vin:e.vin||null,insurance_expiry:e.insurance_expiry||null,notes:e.notes||null},o=j&&e.fuel_type?{...l,fuel_type:e.fuel_type}:l,p=!j&&e.fuel_type;if(a){try{let{data:b,error:c}=await f.N.from("vehicles").select("id").eq("registration",l.registration).not("id","eq",a.id).maybeSingle();if(c)throw console.error("Check existing vehicle error:",c),c;if(b)throw new i.hD(`A vehicle with registration ${l.registration} already exists`,409)}catch(a){if(a instanceof i.hD&&409===a.status)throw a;console.warn("Error checking existing vehicle:",a)}let{error:b}=await f.N.from("vehicles").update(o).eq("id",a.id);if(b)if(console.error("Update vehicle error:",b),console.error("Error details:",{message:b.message,code:b.code,details:b.details,hint:b.hint}),console.error("Data being sent:",o),b.message?.includes("fuel_type")||"42703"===b.code){let{fuel_type:b,...c}=o;console.log("Retrying without fuel_type:",c);let{error:d}=await f.N.from("vehicles").update(c).eq("id",a.id);if(d)throw console.error("Retry error:",d),d;h=!0}else throw b;else g=!0;await c(a.id,a)}else{try{let{data:a,error:b}=await f.N.from("vehicles").select("id").eq("registration",l.registration).maybeSingle();if(b)throw console.error("Check existing vehicle error:",b),b;if(a)throw new i.hD(`A vehicle with registration ${l.registration} already exists`,409)}catch(a){if(a instanceof i.hD&&409===a.status)throw a;console.warn("Error checking existing vehicle:",a)}let{data:a,error:b}=await f.N.from("vehicles").insert([o]).select().single();if(b)if(console.error("Insert vehicle error:",b),console.error("Error details:",{message:b.message,code:b.code,details:b.details,hint:b.hint}),console.error("Data being sent:",o),b.message?.includes("fuel_type")||"42703"===b.code){let{fuel_type:a,...b}=o;console.log("Retrying insert without fuel_type:",b);let{data:d,error:e}=await f.N.from("vehicles").insert([b]).select().single();if(e)throw console.error("Retry insert error:",e),e;d&&await c(d.id,d),h=!0}else throw b;else a&&(await c(a.id,a),g=!0)}h?d({title:"Partial Success",description:`Vehicle ${a?"updated":"added"} successfully. Fuel type will be available after database migration.`,variant:"default"}):g&&(p?d({title:"Success",description:`Vehicle ${a?"updated":"added"} successfully. Fuel type will be available after database migration.`}):d({title:"Success",description:`Vehicle ${a?"updated":"added"} successfully`})),k.invalidateQueries({queryKey:["vehicles"]}),b(!1)}catch(a){j(a,a instanceof i.hD?a.message:"Failed to save vehicle. Please check if a vehicle with the same registration already exists.")}finally{m(!1)}},isSubmitting:l}}h=(j.then?(await j)():j)[0],d()}catch(a){d(a)}})},16235:a=>{a.exports=import("@radix-ui/react-toast")},19948:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{j:()=>i});var e=c(8732),f=c(52307),g=c(57049),h=a([f,g]);function i({form:a}){return(0,e.jsx)(f.zB,{control:a.control,name:"status",render:({field:a})=>(0,e.jsxs)(f.eI,{children:[(0,e.jsx)(f.lR,{children:"Status"}),(0,e.jsxs)(g.l6,{onValueChange:a.onChange,value:a.value,children:[(0,e.jsx)(f.MJ,{children:(0,e.jsx)(g.bq,{children:(0,e.jsx)(g.yv,{placeholder:"Select status"})})}),(0,e.jsxs)(g.gC,{children:[(0,e.jsx)(g.eb,{value:"active",children:"Active"}),(0,e.jsx)(g.eb,{value:"in_service",children:"In Service"}),(0,e.jsx)(g.eb,{value:"inactive",children:"Inactive"})]})]}),(0,e.jsx)(f.C5,{})]})})}[f,g]=h.then?(await h)():h,d()}catch(a){d(a)}})},20217:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{x:()=>q});var e=c(8732),f=c(56884),g=c(52307),h=c(26866),i=c(67972),j=c(79819),k=c(19948),l=c(99737),m=c(49152),n=c(92875),o=c(59271),p=a([f,g,h,i,j,k,l,n,o]);function q({vehicle:a,onSubmit:b,onCancel:c,isSubmitting:d,images:p,setImages:q,imagePreviewUrls:r,setImagePreviewUrls:s}){let t=(0,f.useForm)({defaultValues:{type:a?.type||"soft_skin",make:a?.make||"",model:a?.model||"",registration:a?.registration||"",status:a?.status||"active",fuel_type:a?.fuel_type||"petrol",year:a?.year,color:a?.color||"",vin:a?.vin||"",insurance_expiry:a?.insurance_expiry?new Date(a.insurance_expiry).toISOString().split("T")[0]:void 0,notes:a?.notes||""}});return(0,e.jsx)(g.lV,{...t,children:(0,e.jsxs)("form",{onSubmit:t.handleSubmit(b),className:"space-y-8",children:[(0,e.jsxs)("div",{className:"rounded-xl border border-border bg-muted/30 p-4 space-y-4",children:[(0,e.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Vehicle Images"}),(0,e.jsx)(m.X,{vehicle:a,images:p,setImages:q,imagePreviewUrls:r,setImagePreviewUrls:s})]}),(0,e.jsxs)("div",{className:"rounded-xl border border-border bg-muted/30 p-4 space-y-4",children:[(0,e.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Basic Information"}),(0,e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,e.jsx)(h.$,{form:t}),(0,e.jsx)(o.B,{form:t}),(0,e.jsx)(i.M,{form:t})]})]}),(0,e.jsxs)("div",{className:"rounded-xl border border-border bg-muted/30 p-4 space-y-4",children:[(0,e.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Vehicle Details"}),(0,e.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(0,e.jsx)(j.W,{form:t})})]}),(0,e.jsxs)("div",{className:"rounded-xl border border-border bg-muted/30 p-4 space-y-4",children:[(0,e.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Status & Notes"}),(0,e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,e.jsx)(k.j,{form:t}),(0,e.jsx)(l.m,{form:t})]})]}),(0,e.jsx)(n.c,{onCancel:c,isSubmitting:d,isEdit:!!a})]})})}[f,g,h,i,j,k,l,n,o]=p.then?(await p)():p,d()}catch(a){d(a)}})},20598:a=>{a.exports=import("@radix-ui/react-label")},26866:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{$:()=>i});var e=c(8732),f=c(52307),g=c(57049),h=a([f,g]);function i({form:a}){return(0,e.jsx)(f.zB,{control:a.control,name:"type",render:({field:a})=>(0,e.jsxs)(f.eI,{children:[(0,e.jsx)(f.lR,{children:"Type"}),(0,e.jsxs)(g.l6,{onValueChange:a.onChange,value:a.value,children:[(0,e.jsx)(f.MJ,{children:(0,e.jsx)(g.bq,{children:(0,e.jsx)(g.yv,{placeholder:"Select vehicle type"})})}),(0,e.jsxs)(g.gC,{children:[(0,e.jsx)(g.eb,{value:"armoured",children:"Armoured"}),(0,e.jsx)(g.eb,{value:"soft_skin",children:"Soft Skin"})]})]}),(0,e.jsx)(f.C5,{})]})})}[f,g]=h.then?(await h)():h,d()}catch(a){d(a)}})},27806:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{m:()=>l});var e=c(8732),f=c(66345),g=c(78059),h=c(57049),i=c(74952),j=c(4720),k=a([f,g,h,j]);function l({searchTerm:a,setSearchTerm:b,typeFilter:c,setTypeFilter:d,statusFilter:k,setStatusFilter:l,onClearFilters:m,hasActiveFilters:n,viewMode:o,setViewMode:p}){return(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4",children:[(0,e.jsxs)("div",{className:"flex-1 relative group",children:[(0,e.jsx)(i.vji,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground group-focus-within:text-primary transition-colors"}),(0,e.jsx)(g.p,{placeholder:"Search vehicles by make, model, registration, or VIN...",value:a,onChange:a=>b(a.target.value),className:"pl-9 h-11 border-border/50 focus:border-primary/50 transition-all duration-200"}),a&&(0,e.jsx)(f.$,{variant:"ghost",size:"sm",className:"absolute right-1 top-1 h-7 w-7 p-0 hover:bg-muted/50",onClick:()=>b(""),children:(0,e.jsx)(i.X,{className:"h-3 w-3"})})]}),(0,e.jsxs)("div",{className:"flex items-center gap-3",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[(0,e.jsxs)(h.l6,{value:c,onValueChange:d,children:[(0,e.jsxs)(h.bq,{className:"w-[140px] h-11 border-border/50 focus:border-primary/50",children:[(0,e.jsx)(i.dJT,{className:"mr-2 h-4 w-4"}),(0,e.jsx)(h.yv,{placeholder:"Vehicle Type"})]}),(0,e.jsxs)(h.gC,{children:[(0,e.jsx)(h.eb,{value:"all",children:"All Types"}),(0,e.jsx)(h.eb,{value:"armoured",children:"Armoured"}),(0,e.jsx)(h.eb,{value:"soft_skin",children:"Soft Skin"})]})]}),(0,e.jsxs)(h.l6,{value:k,onValueChange:l,children:[(0,e.jsx)(h.bq,{className:"w-[140px] h-11 border-border/50 focus:border-primary/50",children:(0,e.jsx)(h.yv,{placeholder:"Status"})}),(0,e.jsxs)(h.gC,{children:[(0,e.jsx)(h.eb,{value:"all",children:"All Status"}),(0,e.jsx)(h.eb,{value:"active",children:"Active"}),(0,e.jsx)(h.eb,{value:"in_service",children:"In Service"}),(0,e.jsx)(h.eb,{value:"inactive",children:"Inactive"})]})]})]}),(0,e.jsxs)("div",{className:"flex items-center gap-1 p-1 bg-muted/30 rounded-lg border border-border/50",children:[(0,e.jsxs)(f.$,{variant:"ghost",size:"sm",className:`h-8 px-3 rounded-md transition-all ${"table"===o?"bg-background text-foreground shadow-sm border border-border/50":"text-muted-foreground hover:text-foreground"}`,onClick:()=>p("table"),"aria-label":"List view",children:[(0,e.jsx)(i.B8B,{className:"h-4 w-4 mr-2"}),"List"]}),(0,e.jsxs)(f.$,{variant:"ghost",size:"sm",className:`h-8 px-3 rounded-md transition-all ${"cards"===o?"bg-background text-foreground shadow-sm border border-border/50":"text-muted-foreground hover:text-foreground"}`,onClick:()=>p("cards"),"aria-label":"Grid view",children:[(0,e.jsx)(i.xA9,{className:"h-4 w-4 mr-2"}),"Grid"]})]})]})]}),n&&(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{className:"flex flex-wrap gap-2",children:[a&&(0,e.jsxs)(j.E,{variant:"secondary",className:"gap-1",children:['Search: "',a,'"',(0,e.jsx)(f.$,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-transparent",onClick:()=>b(""),children:(0,e.jsx)(i.X,{className:"h-3 w-3"})})]}),"all"!==c&&(0,e.jsxs)(j.E,{variant:"secondary",className:"gap-1",children:["Type: ",c.replace("_"," "),(0,e.jsx)(f.$,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-transparent",onClick:()=>d("all"),children:(0,e.jsx)(i.X,{className:"h-3 w-3"})})]}),"all"!==k&&(0,e.jsxs)(j.E,{variant:"secondary",className:"gap-1",children:["Status: ",k.replace("_"," "),(0,e.jsx)(f.$,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-transparent",onClick:()=>l("all"),children:(0,e.jsx)(i.X,{className:"h-3 w-3"})})]})]}),(0,e.jsxs)(f.$,{variant:"outline",size:"sm",onClick:m,className:"shrink-0 text-muted-foreground hover:text-foreground",children:[(0,e.jsx)(i.X,{className:"mr-2 h-4 w-4"}),"Clear All"]})]})]})}[f,g,h,j]=k.then?(await k)():k,d()}catch(a){d(a)}})},28446:(a,b,c)=>{c.d(b,{s:()=>e});var d=c(8732);function e(){return(0,d.jsx)("div",{className:"flex items-center justify-center p-8 text-destructive",children:"Failed to load vehicles"})}},28462:a=>{a.exports=import("@tanstack/react-query")},33873:a=>{a.exports=require("path")},34489:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{default:()=>t});var e=c(8732),f=c(82015),g=c(28462),h=c(66345),i=c(95965),j=c(76569),k=c(14225),l=c(41324),m=c(28446),n=c(54166),o=c(90085),p=c(53866),q=c(69006),r=c(27806),s=a([g,h,k,n,o,p,q,r]);function t(){let{toast:a}=(0,j.dj)(),b=(0,g.useQueryClient)(),[c,d]=(0,f.useState)(!1),[s,t]=(0,f.useState)(null),[u,v]=(0,f.useState)(""),[w,x]=(0,f.useState)("all"),[y,z]=(0,f.useState)("all"),[A,B]=(0,f.useState)("table"),[C,D]=(0,f.useState)(1),{data:E,isLoading:F,error:G}=(0,g.useQuery)({queryKey:["vehicles"],queryFn:async()=>{let{data:b,error:c}=await i.N.from("vehicles").select("id, make, model, registration, type, status, year, color, vin, insurance_expiry, notes, created_at, updated_at, images").order("created_at",{ascending:!1});if(c)throw a({title:"Error fetching vehicles",description:c.message,variant:"destructive"}),c;return b?b.map(a=>({...a,id:a.id||"",make:a.make||"Unknown",model:a.model||"Model",registration:a.registration||"N/A",type:a.type||"armoured",status:a.status||"active",year:a.year||null,color:a.color||"N/A",vin:a.vin||"N/A",insurance_expiry:a.insurance_expiry||null,notes:a.notes||"",created_at:a.created_at||new Date().toISOString(),updated_at:a.updated_at||new Date().toISOString(),images:Array.isArray(a.images)?a.images:[]})):[]},staleTime:5e3,gcTime:3e5,refetchOnWindowFocus:!0,refetchOnMount:!0,placeholderData:a=>a,retry:1}),H=(0,f.useMemo)(()=>E?E.filter(a=>{let b=""===u||a.make.toLowerCase().includes(u.toLowerCase())||a.model.toLowerCase().includes(u.toLowerCase())||a.registration.toLowerCase().includes(u.toLowerCase())||(a.vin||"").toLowerCase().includes(u.toLowerCase()),c="all"===w||a.type===w,d="all"===y||a.status===y;return b&&c&&d}):[],[E,u,w,y]),I=Math.ceil(H.length/20),J=(C-1)*20,K=J+20,L=H.slice(J,K);(0,f.useMemo)(()=>E?{total:E.length,active:E.filter(a=>"active"===a.status).length,inService:E.filter(a=>"in_service"===a.status).length,inactive:E.filter(a=>"inactive"===a.status).length,armoured:E.filter(a=>"armoured"===a.type).length,softSkin:E.filter(a=>"soft_skin"===a.type).length}:{total:0,active:0,inService:0,inactive:0,armoured:0,softSkin:0},[E]);let M=(0,g.useMutation)({mutationFn:async a=>{let{error:b}=await i.N.from("vehicles").delete().eq("id",a);if(b)throw b;return a},onSuccess:()=>{b.invalidateQueries({queryKey:["vehicles"]}),a({title:"Vehicle deleted",description:"Vehicle has been successfully deleted"}),t(null)},onError:b=>{a({title:"Error",description:b.message,variant:"destructive"})}}),N=(0,f.useCallback)(()=>{s&&M.mutate(s.id)},[s,M]),O=(0,f.useCallback)(()=>{t(null)},[]),P=(0,f.useCallback)(a=>{t(a)},[]),Q=(0,f.useCallback)(()=>{d(!0)},[]),R=(0,f.useCallback)(()=>{v(""),x("all"),z("all")},[]),S=""!==u||"all"!==w||"all"!==y;return(0,e.jsx)("div",{className:"min-h-screen bg-background",children:(0,e.jsxs)("div",{className:"p-4 px-6 space-y-6",children:[(0,e.jsx)("div",{className:"border-b border-border pb-4 pt-4",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsx)("div",{children:(0,e.jsx)("h1",{className:"text-2xl font-semibold text-foreground",children:"Vehicles"})}),(0,e.jsx)(h.$,{variant:"outline",size:"sm",className:"text-foreground border-border/50",onClick:Q,children:"Add Vehicle"})]})}),(0,e.jsx)("div",{className:"space-y-4",children:(0,e.jsx)(r.m,{searchTerm:u,setSearchTerm:v,typeFilter:w,setTypeFilter:x,statusFilter:y,setStatusFilter:z,onClearFilters:R,hasActiveFilters:S,viewMode:A,setViewMode:B})}),F?(0,e.jsx)(l.G,{}):G?(0,e.jsx)(m.s,{}):L&&L.length>0?"table"===A?(0,e.jsx)(o.f,{vehicles:L,onVehicleClick:P}):(0,e.jsx)(q.q,{vehicles:L,onVehicleClick:P}):(0,e.jsx)(k.e,{onAddVehicle:Q}),(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsx)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:(0,e.jsxs)("span",{children:["Showing ",J+1,"-",Math.min(K,H.length)," of"," ",H.length," vehicles"]})}),(0,e.jsx)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:(0,e.jsxs)("span",{children:["Page ",C," of ",I]})})]}),I>1&&(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[(0,e.jsx)(h.$,{variant:"outline",size:"sm",onClick:()=>D(Math.max(1,C-1)),disabled:1===C,className:"h-8 px-3",children:"Previous"}),(0,e.jsx)("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,I)},(a,b)=>{let c=b+1;return I<=5||1===c||c===I||c>=C-1&&c<=C+1?(0,e.jsx)(h.$,{variant:C===c?"default":"outline",size:"sm",onClick:()=>D(c),className:"h-8 w-8 p-0",children:c},c):c===C-2||c===C+2?(0,e.jsx)("span",{className:"px-2 text-muted-foreground",children:"..."},c):null})}),(0,e.jsx)(h.$,{variant:"outline",size:"sm",onClick:()=>D(Math.min(I,C+1)),disabled:C===I,className:"h-8 px-3",children:"Next"})]}),(0,e.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,e.jsx)("span",{children:"â€¢"}),(0,e.jsxs)("span",{children:["Last updated: ",new Date().toLocaleTimeString()]})]})]}),(0,e.jsx)(n.J,{open:c,onOpenChange:d}),(0,e.jsx)(p.j,{selectedVehicle:s,onClose:O,onDelete:N})]})})}[g,h,k,n,o,p,q,r]=s.then?(await s)():s,d()}catch(a){d(a)}})},38827:a=>{a.exports=import("@radix-ui/react-separator")},39655:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{BT:()=>l,Wu:()=>m,ZB:()=>k,Zp:()=>i,aR:()=>j,wL:()=>n});var e=c(8732),f=c(82015),g=c(87092),h=a([g]);g=(h.then?(await h)():h)[0];let i=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("div",{ref:c,className:(0,g.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...b}));i.displayName="Card";let j=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("div",{ref:c,className:(0,g.cn)("flex flex-col space-y-1.5 p-6",a),...b}));j.displayName="CardHeader";let k=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("h3",{ref:c,className:(0,g.cn)("text-2xl font-semibold leading-none tracking-tight",a),...b}));k.displayName="CardTitle";let l=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("p",{ref:c,className:(0,g.cn)("text-sm text-muted-foreground",a),...b}));l.displayName="CardDescription";let m=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("div",{ref:c,className:(0,g.cn)("p-6 pt-0",a),...b}));m.displayName="CardContent";let n=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("div",{ref:c,className:(0,g.cn)("flex items-center p-6 pt-0",a),...b}));n.displayName="CardFooter",d()}catch(a){d(a)}})},40361:a=>{a.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},41324:(a,b,c)=>{c.d(b,{G:()=>f});var d=c(8732),e=c(74952);function f(){return(0,d.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,d.jsx)(e.THT,{className:"h-8 w-8 animate-pulse text-muted-foreground"})})}},41415:a=>{a.exports=import("sonner")},46060:a=>{a.exports=require("next/dist/shared/lib/no-fallback-error.external.js")},47860:a=>{a.exports=import("@radix-ui/react-select")},48303:a=>{a.exports=import("@radix-ui/react-tooltip")},49152:(a,b,c)=>{c.d(b,{X:()=>i});var d=c(8732),e=c(74952),f=c(82015),g=c(95965),h=c(76569);function i({vehicle:a,images:b,setImages:c,imagePreviewUrls:i,setImagePreviewUrls:j}){let{toast:k}=(0,h.dj)(),[l,m]=(0,f.useState)([]),n=async d=>{let e=i[d],f=l.findIndex(a=>a.image_url===e);if(-1!==f&&a)try{let b=(a.images||[]).filter(a=>a.id!==l[f].id),{error:c}=await g.N.from("vehicles").update({images:b}).eq("id",a.id);if(c)return void k({title:"Error",description:"Failed to remove image from database",variant:"destructive"});let d=l.filter((a,b)=>b!==f);m(d),k({title:"Success",description:"Image removed successfully"})}catch(a){console.error("Error removing image:",a),k({title:"Error",description:"Failed to remove image",variant:"destructive"});return}else{let a=d-l.length;a>=0&&c(b.filter((b,c)=>c!==a))}j(i.filter((a,b)=>b!==d)),e.startsWith("blob:")&&URL.revokeObjectURL(e)};return(0,d.jsx)("div",{className:"space-y-4",children:(0,d.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[i.map((a,b)=>(0,d.jsxs)("div",{className:"relative group",children:[(0,d.jsx)("img",{src:a,alt:`Vehicle ${b+1}`,className:"w-full h-32 object-cover rounded-lg border shadow-sm"}),(0,d.jsx)("button",{type:"button",onClick:()=>n(b),className:"absolute top-2 right-2 p-1.5 bg-destructive/90 rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-destructive",children:(0,d.jsx)(e.X,{className:"h-4 w-4 text-white"})})]},b)),(0,d.jsxs)("label",{className:"flex items-center justify-center h-32 border-2 border-dashed border-muted-foreground/30 rounded-lg cursor-pointer hover:border-primary/50 hover:bg-muted/20 transition-all duration-200",children:[(0,d.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:a=>{let d=Array.from(a.target.files||[]);c([...b,...d]),j([...i,...d.map(a=>URL.createObjectURL(a))])},className:"hidden"}),(0,d.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,d.jsx)(e.ePb,{className:"h-6 w-6 text-muted-foreground mb-2"}),(0,d.jsx)("span",{className:"text-sm text-muted-foreground font-medium",children:"Add Images"}),(0,d.jsx)("span",{className:"text-xs text-muted-foreground mt-1",children:"Click to upload"})]})]})]})})}},50802:a=>{a.exports=import("clsx")},52307:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{C5:()=>u,MJ:()=>s,Rr:()=>t,eI:()=>q,lR:()=>r,lV:()=>l,zB:()=>n});var e=c(8732),f=c(82015),g=c(9640),h=c(56884),i=c(87092),j=c(40273),k=a([g,h,i,j]);[g,h,i,j]=k.then?(await k)():k;let l=h.FormProvider,m=f.createContext({}),n=({...a})=>(0,e.jsx)(m.Provider,{value:{name:a.name},children:(0,e.jsx)(h.Controller,{...a})}),o=()=>{let a=f.useContext(m),b=f.useContext(p),{getFieldState:c,formState:d}=(0,h.useFormContext)(),e=c(a.name,d);if(!a)throw Error("useFormField should be used within <FormField>");let{id:g}=b;return{id:g,name:a.name,formItemId:`${g}-form-item`,formDescriptionId:`${g}-form-item-description`,formMessageId:`${g}-form-item-message`,...e}},p=f.createContext({}),q=f.forwardRef(({className:a,...b},c)=>{let d=f.useId();return(0,e.jsx)(p.Provider,{value:{id:d},children:(0,e.jsx)("div",{ref:c,className:(0,i.cn)("space-y-2",a),...b})})});q.displayName="FormItem";let r=f.forwardRef(({className:a,...b},c)=>{let{error:d,formItemId:f}=o();return(0,e.jsx)(j.J,{ref:c,className:(0,i.cn)(d&&"text-destructive",a),htmlFor:f,...b})});r.displayName="FormLabel";let s=f.forwardRef(({...a},b)=>{let{error:c,formItemId:d,formDescriptionId:f,formMessageId:h}=o();return(0,e.jsx)(g.Slot,{ref:b,id:d,"aria-describedby":c?`${f} ${h}`:`${f}`,"aria-invalid":!!c,...a})});s.displayName="FormControl";let t=f.forwardRef(({className:a,...b},c)=>{let{formDescriptionId:d}=o();return(0,e.jsx)("p",{ref:c,id:d,className:(0,i.cn)("text-sm text-muted-foreground",a),...b})});t.displayName="FormDescription";let u=f.forwardRef(({className:a,children:b,...c},d)=>{let{error:f,formMessageId:g}=o(),h=f?String(f?.message):b;return h?(0,e.jsx)("p",{ref:d,id:g,className:(0,i.cn)("text-sm font-medium text-destructive",a),...c,children:h}):null});u.displayName="FormMessage",d()}catch(a){d(a)}})},53866:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{j:()=>o});var e=c(8732),f=c(82015),g=c(38661),h=c(66345),i=c(74952),j=c(87092),k=c(98439),l=c(54166),m=c(28462),n=a([g,h,j,k,l,m]);function o({selectedVehicle:a,onClose:b,onDelete:c}){let d=(0,m.useQueryClient)(),[n,o]=(0,f.useState)("view"),[p,q]=(0,f.useState)(0),[r,s]=(0,f.useState)(!1),t=(0,f.useCallback)(b=>{b.stopPropagation(),a?.images&&q(b=>b===(a.images?.length||0)-1?0:b+1)},[a]),u=(0,f.useCallback)(b=>{b.stopPropagation(),a?.images&&q(b=>0===b?(a.images?.length||0)-1:b-1)},[a]),v=(0,f.useCallback)(a=>{q(a)},[]),w=(0,f.useCallback)(()=>{o("view"),d.invalidateQueries({queryKey:["vehicles"]})},[d]),x=(0,f.useCallback)(()=>{o("view"),q(0),b()},[b]),y=(0,f.useCallback)(()=>{s(!0)},[]),z=(0,f.useCallback)(()=>{s(!1)},[]),A=(0,f.useCallback)(()=>{c(),s(!1)},[c]);return a?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(g.lG,{open:!!a,onOpenChange:x,children:(0,e.jsxs)(g.Cf,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,e.jsxs)(g.c7,{children:[(0,e.jsxs)(g.L3,{className:"pr-10",children:["Vehicle Details - ",(0,j.r)(a.id)]}),(0,e.jsx)(g.rr,{children:"View and manage vehicle information, images, and details."})]}),"view"===n&&(0,e.jsx)(k.E,{selectedVehicle:a,currentImageIndex:p,handlePrevImage:u,handleNextImage:t,selectThumbnail:v,setViewMode:o,setShowDeleteConfirm:y}),"edit"===n&&(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between pb-4 border-b",children:[(0,e.jsx)("h3",{className:"text-lg font-semibold",children:"Edit Vehicle"}),(0,e.jsxs)(h.$,{variant:"outline",size:"sm",onClick:()=>o("view"),children:[(0,e.jsx)(i.X,{className:"mr-2 h-4 w-4"}),"Cancel Edit"]})]}),(0,e.jsx)(l.J,{open:!0,onOpenChange:a=>{a||w()},vehicle:a})]})]})}),(0,e.jsx)(g.lG,{open:r,onOpenChange:z,children:(0,e.jsxs)(g.Cf,{children:[(0,e.jsxs)(g.c7,{children:[(0,e.jsx)(g.L3,{children:"Delete Vehicle"}),(0,e.jsx)(g.rr,{children:"Confirm vehicle deletion - this action cannot be undone."})]}),(0,e.jsx)("p",{className:"text-muted-foreground",children:"Are you sure you want to delete this vehicle? This action cannot be undone."}),(0,e.jsxs)("div",{className:"flex justify-end space-x-4 mt-4",children:[(0,e.jsx)(h.$,{variant:"outline",onClick:z,children:"Cancel"}),(0,e.jsx)(h.$,{variant:"destructive",onClick:A,children:"Delete"})]})]})})]}):null}[g,h,j,k,l,m]=n.then?(await n)():n,d()}catch(a){d(a)}})},54166:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{J:()=>l});var e=c(8732),f=c(38661),g=c(20217),h=c(5223),i=c(95951),j=c(15248),k=a([f,g,j]);function l({open:a,onOpenChange:b,vehicle:c}){let{uploadVehicleImages:d,images:k,setImages:l,imagePreviewUrls:m,setImagePreviewUrls:n}=(0,i.Y)(),{onSubmit:o,isSubmitting:p}=(0,j.M)(c,b,d);return(0,e.jsx)(f.lG,{open:a,onOpenChange:b,children:(0,e.jsxs)(f.Cf,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[(0,e.jsxs)(f.c7,{children:[(0,e.jsx)(f.L3,{children:c?"Edit Vehicle":"Add New Vehicle"}),(0,e.jsx)(f.rr,{children:c?"Update the details of your vehicle below.":"Fill in the details of your new vehicle below."})]}),(0,e.jsx)(h.U,{children:(0,e.jsx)(g.x,{vehicle:c,onSubmit:o,onCancel:()=>b(!1),isSubmitting:p,images:k,setImages:l,imagePreviewUrls:m,setImagePreviewUrls:n})})]})})}[f,g,j]=k.then?(await k)():k,d()}catch(a){d(a)}})},56884:a=>{a.exports=import("react-hook-form")},57312:a=>{a.exports=import("next-themes")},59271:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{B:()=>i});var e=c(8732),f=c(52307),g=c(57049),h=a([f,g]);function i({form:a}){return(0,e.jsx)(f.zB,{control:a.control,name:"fuel_type",render:({field:a})=>(0,e.jsxs)(f.eI,{children:[(0,e.jsx)(f.lR,{children:"Fuel Type"}),(0,e.jsxs)(g.l6,{onValueChange:a.onChange,value:a.value,children:[(0,e.jsx)(f.MJ,{children:(0,e.jsx)(g.bq,{children:(0,e.jsx)(g.yv,{placeholder:"Select fuel type"})})}),(0,e.jsxs)(g.gC,{children:[(0,e.jsx)(g.eb,{value:"petrol",children:"Petrol"}),(0,e.jsx)(g.eb,{value:"diesel",children:"Diesel"})]})]}),(0,e.jsx)(f.C5,{})]})})}[f,g]=h.then?(await h)():h,d()}catch(a){d(a)}})},60461:a=>{a.exports=import("@radix-ui/react-popover")},62287:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{config:()=>r,default:()=>n,getServerSideProps:()=>q,getStaticPaths:()=>p,getStaticProps:()=>o,handler:()=>z,reportWebVitals:()=>s,routeModule:()=>y,unstable_getServerProps:()=>w,unstable_getServerSideProps:()=>x,unstable_getStaticParams:()=>v,unstable_getStaticPaths:()=>u,unstable_getStaticProps:()=>t});var e=c(63885),f=c(80237),g=c(81413),h=c(65611),i=c.n(h),j=c(74780),k=c(34489),l=c(12289),m=a([j,k]);[j,k]=m.then?(await m)():m;let n=(0,g.M)(k,"default"),o=(0,g.M)(k,"getStaticProps"),p=(0,g.M)(k,"getStaticPaths"),q=(0,g.M)(k,"getServerSideProps"),r=(0,g.M)(k,"config"),s=(0,g.M)(k,"reportWebVitals"),t=(0,g.M)(k,"unstable_getStaticProps"),u=(0,g.M)(k,"unstable_getStaticPaths"),v=(0,g.M)(k,"unstable_getStaticParams"),w=(0,g.M)(k,"unstable_getServerProps"),x=(0,g.M)(k,"unstable_getServerSideProps"),y=new e.PagesRouteModule({definition:{kind:f.RouteKind.PAGES,page:"/Vehicles",pathname:"/Vehicles",bundlePath:"",filename:""},distDir:".next-fleet",relativeProjectDir:"",components:{App:j.default,Document:i()},userland:k}),z=(0,l.U)({srcPage:"/Vehicles",config:r,userland:k,routeModule:y,getStaticPaths:p,getStaticProps:o,getServerSideProps:q});d()}catch(a){d(a)}})},67972:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{M:()=>i});var e=c(8732),f=c(52307),g=c(78059),h=a([f,g]);function i({form:a}){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(f.zB,{control:a.control,name:"make",render:({field:a})=>(0,e.jsxs)(f.eI,{children:[(0,e.jsx)(f.lR,{children:"Make"}),(0,e.jsx)(f.MJ,{children:(0,e.jsx)(g.p,{placeholder:"Toyota",...a})}),(0,e.jsx)(f.C5,{})]})}),(0,e.jsx)(f.zB,{control:a.control,name:"model",render:({field:a})=>(0,e.jsxs)(f.eI,{children:[(0,e.jsx)(f.lR,{children:"Model"}),(0,e.jsx)(f.MJ,{children:(0,e.jsx)(g.p,{placeholder:"Land Cruiser",...a})}),(0,e.jsx)(f.C5,{})]})}),(0,e.jsx)(f.zB,{control:a.control,name:"registration",render:({field:a})=>(0,e.jsxs)(f.eI,{children:[(0,e.jsx)(f.lR,{children:"Registration"}),(0,e.jsx)(f.MJ,{children:(0,e.jsx)(g.p,{placeholder:"KBZ 123A",...a})}),(0,e.jsx)(f.C5,{})]})}),(0,e.jsx)(f.zB,{control:a.control,name:"year",render:({field:a})=>(0,e.jsxs)(f.eI,{children:[(0,e.jsx)(f.lR,{children:"Year"}),(0,e.jsx)(f.MJ,{children:(0,e.jsx)(g.p,{type:"text",placeholder:"2024",...a,value:a.value||""})}),(0,e.jsx)(f.C5,{})]})})]})}[f,g]=h.then?(await h)():h,d()}catch(a){d(a)}})},69006:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{q:()=>l});var e=c(8732),f=c(82015),g=c(39655),h=c(4720),i=c(74952),j=c(87092),k=a([g,h,j]);[g,h,j]=k.then?(await k)():k;let l=(0,f.memo)(({vehicles:a,onVehicleClick:b})=>{let c=(0,f.useCallback)(a=>{b(a)},[b]);return a&&Array.isArray(a)?(0,e.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 p-6",children:a.map(a=>{if(!a||"object"!=typeof a)return console.warn("Invalid vehicle object:",a),null;let b=Array.isArray(a.images)&&a.images.length>0,d=(a=>{if(!a)return!1;let b=new Date(a),c=new Date,d=Math.ceil((b.getTime()-c.getTime())/864e5);return d<=30&&d>0})(a.insurance_expiry||null),f=(a=>{if(!a)return!1;let b=new Date(a),c=new Date;return b<c})(a.insurance_expiry||null),k=(a=>"in_service"===a.status?{text:"In Service",color:"bg-blue-50 text-blue-700 border-blue-200"}:"inactive"===a.status?{text:"Inactive",color:"bg-gray-50 text-gray-700 border-gray-200"}:{text:"Active",color:"bg-green-50 text-green-700 border-green-200"})(a);return(0,e.jsxs)(g.Zp,{className:"cursor-pointer hover:shadow-md transition-shadow duration-200 border",onClick:()=>c(a),children:[(0,e.jsx)(g.aR,{className:"pb-3",children:(0,e.jsxs)("div",{className:"flex items-start justify-between",children:[(0,e.jsx)("div",{className:"text-sm text-muted-foreground",children:(0,j.r)(a.id)}),(0,e.jsx)(h.E,{variant:"outline",className:`text-xs ${k.color}`,children:k.text})]})}),(0,e.jsxs)(g.Wu,{className:"space-y-3",children:[(0,e.jsxs)("div",{className:"relative aspect-video bg-gray-50 rounded-lg overflow-hidden border flex items-center justify-center",children:[b?(0,e.jsx)("img",{src:Array.isArray(a.images)&&a.images[0]?.url||"",alt:`${a.make} ${a.model}`,className:"w-full h-full object-contain",onError:a=>{a.currentTarget.style.display="none"}}):null,(0,e.jsx)("div",{className:`w-full h-full flex items-center justify-center ${b?"hidden":""}`,children:(0,e.jsx)(i.THT,{className:"h-8 w-8 text-muted-foreground"})}),(d||f)&&(0,e.jsx)("div",{className:"absolute top-2 right-2",children:(0,e.jsx)(h.E,{variant:"destructive",className:"text-xs",children:f?"Expired":"Expiring"})})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsxs)("div",{children:[(0,e.jsxs)("h3",{className:"font-medium text-base",children:[a.make," ",a.model]}),(0,e.jsx)("p",{className:"text-sm text-muted-foreground font-mono",children:a.registration})]}),(0,e.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("span",{className:"text-muted-foreground",children:"Year:"}),(0,e.jsx)("span",{className:"ml-1",children:a.year||"N/A"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("span",{className:"text-muted-foreground",children:"Type:"}),(0,e.jsx)("span",{className:"ml-1 capitalize",children:a.type||"N/A"})]})]}),a.insurance_expiry&&(0,e.jsxs)("div",{className:"text-sm",children:[(0,e.jsxs)("span",{className:"text-muted-foreground",children:["Insurance expires:"," "]}),(0,e.jsx)("span",{className:f?"text-red-600":d?"text-orange-600":"",children:new Date(a.insurance_expiry).toLocaleDateString()})]})]})]})]},a.id||Math.random())}).filter(Boolean)}):(0,e.jsx)("div",{className:"p-8 text-center text-muted-foreground",children:"No vehicles data available"})});l.displayName="VehicleCards",d()}catch(a){d(a)}})},75979:a=>{a.exports=import("tailwind-merge")},79819:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{W:()=>l});var e=c(8732),f=c(52307),g=c(78059),h=c(52670),i=c(81575),j=c(71913),k=a([f,g,h]);function l({form:a}){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(f.zB,{control:a.control,name:"color",render:({field:a})=>(0,e.jsxs)(f.eI,{children:[(0,e.jsx)(f.lR,{children:"Color"}),(0,e.jsx)(f.MJ,{children:(0,e.jsx)(g.p,{placeholder:"White",...a})}),(0,e.jsx)(f.C5,{})]})}),(0,e.jsx)(f.zB,{control:a.control,name:"vin",render:({field:a})=>(0,e.jsxs)(f.eI,{children:[(0,e.jsx)(f.lR,{children:"VIN"}),(0,e.jsx)(f.MJ,{children:(0,e.jsx)(g.p,{placeholder:"Vehicle Identification Number",...a})}),(0,e.jsx)(f.C5,{})]})}),(0,e.jsx)(f.zB,{control:a.control,name:"insurance_expiry",render:({field:a})=>(0,e.jsxs)(f.eI,{children:[(0,e.jsx)(f.lR,{children:"Insurance Expiry"}),(0,e.jsx)(f.MJ,{children:(0,e.jsx)(h.l,{date:a.value?(0,i.H)(a.value):void 0,onDateChange:b=>a.onChange(b?(0,j.GP)(b,"yyyy-MM-dd"):void 0)})}),(0,e.jsx)(f.C5,{})]})})]})}[f,g,h]=k.then?(await k)():k,d()}catch(a){d(a)}})},81575:(a,b,c)=>{c.d(b,{H:()=>e});var d=c(73502);function e(a,b){let c,e,n=b?.additionalDigits??2,o=function(a){let b,c={},d=a.split(f.dateTimeDelimiter);if(d.length>2)return c;if(/:/.test(d[0])?b=d[0]:(c.date=d[0],b=d[1],f.timeZoneDelimiter.test(c.date)&&(c.date=a.split(f.timeZoneDelimiter)[0],b=a.substr(c.date.length,a.length))),b){let a=f.timezone.exec(b);a?(c.time=b.replace(a[1],""),c.timezone=a[1]):c.time=b}return c}(a);if(o.date){let a=function(a,b){let c=RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+b)+"})|(\\d{2}|[+-]\\d{"+(2+b)+"})$)"),d=a.match(c);if(!d)return{year:NaN,restDateString:""};let e=d[1]?parseInt(d[1]):null,f=d[2]?parseInt(d[2]):null;return{year:null===f?e:100*f,restDateString:a.slice((d[1]||d[2]).length)}}(o.date,n);c=function(a,b){var c,d,e,f,h,i,k;if(null===b)return new Date(NaN);let n=a.match(g);if(!n)return new Date(NaN);let o=!!n[4],p=j(n[1]),q=j(n[2])-1,r=j(n[3]),s=j(n[4]),t=j(n[5])-1;if(o){return(c=s,d=t,c>=1&&c<=53&&d>=0&&d<=6)?function(a,b,c){let d=new Date(0);d.setUTCFullYear(a,0,4);let e=d.getUTCDay()||7;return d.setUTCDate(d.getUTCDate()+((b-1)*7+c+1-e)),d}(b,s,t):new Date(NaN)}{let a=new Date(0);return(e=b,f=q,h=r,f>=0&&f<=11&&h>=1&&h<=(l[f]||(m(e)?29:28))&&(i=b,(k=p)>=1&&k<=(m(i)?366:365)))?(a.setUTCFullYear(b,q,Math.max(p,r)),a):new Date(NaN)}}(a.restDateString,a.year)}if(!c||isNaN(c.getTime()))return new Date(NaN);let p=c.getTime(),q=0;if(o.time&&isNaN(q=function(a){var b,c,e;let f=a.match(h);if(!f)return NaN;let g=k(f[1]),i=k(f[2]),j=k(f[3]);return(b=g,c=i,e=j,24===b?0===c&&0===e:e>=0&&e<60&&c>=0&&c<60&&b>=0&&b<25)?g*d.s0+i*d.Cg+1e3*j:NaN}(o.time)))return new Date(NaN);if(o.timezone){if(isNaN(e=function(a){var b;if("Z"===a)return 0;let c=a.match(i);if(!c)return 0;let e="+"===c[1]?-1:1,f=parseInt(c[2]),g=c[3]&&parseInt(c[3])||0;return(b=g)>=0&&b<=59?e*(f*d.s0+g*d.Cg):NaN}(o.timezone)))return new Date(NaN)}else{let a=new Date(p+q),b=new Date(0);return b.setFullYear(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()),b.setHours(a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()),b}return new Date(p+q+e)}let f={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},g=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,h=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,i=/^([+-])(\d{2})(?::?(\d{2}))?$/;function j(a){return a?parseInt(a):1}function k(a){return a&&parseFloat(a.replace(",","."))||0}let l=[31,null,31,30,31,30,31,31,30,31,30,31];function m(a){return a%400==0||a%4==0&&a%100!=0}},82015:a=>{a.exports=require("react")},86093:a=>{a.exports=require("react-day-picker")},87967:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{T:()=>i});var e=c(8732),f=c(82015),g=c(87092),h=a([g]);g=(h.then?(await h)():h)[0];let i=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("textarea",{className:(0,g.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-0 focus-visible:ring-0 focus:ring-offset-0 focus-visible:ring-offset-0 focus:border-ring focus-visible:border-ring disabled:cursor-not-allowed disabled:opacity-50 transition-colors",a),ref:c,...b}));i.displayName="Textarea",d()}catch(a){d(a)}})},90085:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{f:()=>l});var e=c(8732),f=c(82015),g=c(48383),h=c(4720),i=c(74952),j=c(87092),k=a([g,h,j]);[g,h,j]=k.then?(await k)():k;let l=(0,f.memo)(({vehicles:a,onVehicleClick:b})=>{let c=(0,f.useCallback)(a=>{b(a)},[b]),d=(a,b="")=>{if(null==a||"undefined"===a||"null"===a)return b;try{return String(a)}catch(c){return console.warn("Error in safeString:",c,"value:",a),b}};return a&&Array.isArray(a)?(0,e.jsxs)(g.XI,{children:[(0,e.jsx)(g.A0,{children:(0,e.jsxs)(g.Hj,{children:[(0,e.jsx)(g.nd,{children:"Vehicle"}),(0,e.jsx)(g.nd,{children:"Type"}),(0,e.jsx)(g.nd,{children:"Status"}),(0,e.jsx)(g.nd,{children:"Registration"}),(0,e.jsx)(g.nd,{children:"Year"}),(0,e.jsx)(g.nd,{children:"Insurance"}),(0,e.jsx)(g.nd,{children:"VIN"})]})}),(0,e.jsx)(g.BF,{children:a.map(a=>{let b;if(!a||"object"!=typeof a)return console.warn("Invalid vehicle object:",a),null;let f=(a=>{if(!a)return!1;let b=new Date(a),c=new Date,d=Math.ceil((b.getTime()-c.getTime())/864e5);return d<=30&&d>0})(a.insurance_expiry||null),k=(a=>{if(!a)return!1;let b=new Date(a),c=new Date;return b<c})(a.insurance_expiry||null);return(0,e.jsxs)(g.Hj,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>c(a),children:[(0,e.jsx)(g.nA,{children:(0,e.jsxs)("div",{className:"flex items-center gap-3",children:[(0,e.jsx)("div",{className:"relative",children:a.images&&Array.isArray(a.images)&&a.images.length>0?(0,e.jsx)("img",{src:a.images[0]?.url||"",alt:`${d(a.make,"Vehicle")} ${d(a.model)}`,className:"w-24 h-16 object-cover rounded-none"}):(0,e.jsx)("div",{className:"w-24 h-16 bg-muted flex items-center justify-center rounded-none",children:(0,e.jsx)(i.THT,{className:"h-8 w-8 text-muted-foreground"})})}),(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"font-medium",children:[d(a.make,"Unknown")," ",d(a.model,"Model")]}),(0,e.jsx)("div",{className:"text-sm text-muted-foreground font-mono",children:(0,j.r)(d(a.id,""))})]})]})}),(0,e.jsx)(g.nA,{children:(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[(b=a.type,"armoured"===b?(0,e.jsx)(i.ekZ,{className:"h-4 w-4"}):(0,e.jsx)(i.THT,{className:"h-4 w-4"})),(0,e.jsx)("span",{className:"capitalize",children:a.type?a.type.replace("_"," "):"N/A"})]})}),(0,e.jsx)(g.nA,{children:(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[(a=>{switch(a){case"active":return(0,e.jsx)(i.rAV,{className:"h-4 w-4 text-green-600"});case"in_service":return(0,e.jsx)(i.zD7,{className:"h-4 w-4 text-blue-600"});case"inactive":return(0,e.jsx)(i.hcu,{className:"h-4 w-4 text-orange-600"});default:return(0,e.jsx)(i.THT,{className:"h-4 w-4 text-muted-foreground"})}})(a.status),(0,e.jsx)(h.E,{variant:"outline",className:`text-xs ${(a=>{switch(a){case"active":return"bg-green-100 text-green-800 border-green-200";case"in_service":return"bg-blue-100 text-blue-800 border-blue-200";case"inactive":return"bg-orange-100 text-orange-800 border-orange-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(a.status)}`,children:(a=>{switch(a){case"active":return"Active";case"in_service":return"In Service";case"inactive":return"Inactive";default:return"Unknown"}})(a.status)})]})}),(0,e.jsx)(g.nA,{className:"font-mono",children:d(a.registration,"N/A")}),(0,e.jsx)(g.nA,{children:a.year||"N/A"}),(0,e.jsx)(g.nA,{children:(0,e.jsx)("div",{className:"flex items-center gap-2",children:a.insurance_expiry?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(i.VvS,{className:"h-3 w-3 text-muted-foreground"}),(0,e.jsx)("span",{className:`text-sm ${k?"text-red-600":f?"text-orange-600":""}`,children:new Date(a.insurance_expiry).toLocaleDateString()}),(f||k)&&(0,e.jsx)(h.E,{variant:"destructive",className:"text-xs",children:k?"Expired":"Expiring"})]}):(0,e.jsx)("span",{className:"text-muted-foreground",children:"N/A"})})}),(0,e.jsx)(g.nA,{className:"font-mono text-sm",children:d(a.vin,"N/A")})]},a.id||Math.random())}).filter(Boolean)})]}):(0,e.jsx)("div",{className:"p-4 text-center text-muted-foreground",children:"No vehicles data available"})});l.displayName="VehicleTable",d()}catch(a){d(a)}})},92875:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{c:()=>h});var e=c(8732),f=c(66345),g=a([f]);function h({onCancel:a,isSubmitting:b,isEdit:c}){return(0,e.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 pt-4",children:[(0,e.jsx)(f.$,{type:"button",variant:"outline",onClick:a,children:"Cancel"}),(0,e.jsx)(f.$,{type:"submit",disabled:b,variant:"default",className:"w-full sm:w-auto font-semibold shadow",children:b?"Saving...":c?"Update Vehicle":"Add Vehicle"})]})}f=(g.then?(await g)():g)[0],d()}catch(a){d(a)}})},93939:a=>{a.exports=require("@supabase/supabase-js")},94142:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{F:()=>j});var e=c(8732),f=c(82015),g=c(14505),h=c(87092),i=a([g,h]);[g,h]=i.then?(await i)():i;let j=f.forwardRef(({className:a,children:b,...c},d)=>(0,e.jsxs)(g.Root,{ref:d,className:(0,h.cn)("relative overflow-hidden",a),...c,children:[(0,e.jsx)(g.Viewport,{className:"h-full w-full rounded-[inherit]",children:b}),(0,e.jsx)(k,{}),(0,e.jsx)(g.Corner,{})]}));j.displayName=g.Root.displayName;let k=f.forwardRef(({className:a,orientation:b="vertical",...c},d)=>(0,e.jsx)(g.ScrollAreaScrollbar,{ref:d,orientation:b,className:(0,h.cn)("flex touch-none select-none transition-colors","vertical"===b&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===b&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...c,children:(0,e.jsx)(g.ScrollAreaThumb,{className:"relative flex-1 rounded-full bg-border"})}));k.displayName=g.ScrollAreaScrollbar.displayName,d()}catch(a){d(a)}})},95148:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{w:()=>j});var e=c(8732),f=c(82015),g=c(38827),h=c(87092),i=a([g,h]);[g,h]=i.then?(await i)():i;let j=f.forwardRef(({className:a,orientation:b="horizontal",decorative:c=!0,...d},f)=>(0,e.jsx)(g.Root,{ref:f,decorative:c,orientation:b,className:(0,h.cn)("shrink-0 bg-border","horizontal"===b?"h-[1px] w-full":"h-full w-[1px]",a),...d}));j.displayName=g.Root.displayName,d()}catch(a){d(a)}})},95951:(a,b,c)=>{c.d(b,{Y:()=>g});var d=c(82015),e=c(95965),f=c(96301);function g(){let[a,b]=(0,d.useState)([]),[c,g]=(0,d.useState)([]),h=async(d,h)=>{if(0!==a.length)try{let i=a.map(async a=>{let b=a.name.split(".").pop(),c=`${d}/${crypto.randomUUID()}.${b}`,{data:g}=await e.N.storage.from("vehicle-images").list(d);if(g?.some(a=>a.name===c))throw new f.hD("File already exists",409);let{error:h,data:i}=await e.N.storage.from("vehicle-images").upload(c,a,{cacheControl:"3600",upsert:!1});if(h)throw h;let{data:{publicUrl:j}}=e.N.storage.from("vehicle-images").getPublicUrl(c);return j}),j=(await Promise.all(i)).map(a=>({id:crypto.randomUUID(),url:a,created_at:new Date().toISOString()})),k=[...h?.images||[],...j],{error:l}=await e.N.from("vehicles").update({images:k}).eq("id",d);if(l)throw l;c.forEach(a=>{a.startsWith("blob:")&&URL.revokeObjectURL(a)}),b([]),g([])}catch(a){throw console.error("Error uploading images:",a),a}};return{images:a,setImages:b,imagePreviewUrls:c,setImagePreviewUrls:g,uploadVehicleImages:h}}},96301:(a,b,c)=>{c.d(b,{hD:()=>e,ud:()=>f});var d=c(76569);class e extends Error{constructor(a,b,c){super(a),this.name="ApiError",this.status=b,this.code=c}}let f=()=>{let{toast:a}=(0,d.dj)();return{handleError:(b,c)=>{let d=(a=>a instanceof e?a:a instanceof Error?new e(a.message):a&&"object"==typeof a&&"message"in a?new e(a.message,a.status,a.code):new e("string"==typeof a?a:"An unknown error occurred"))(b);return console.error("API Error:",d),a({title:"Error",description:c||d.message,variant:"destructive"}),d}}}},98439:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{E:()=>n});var e=c(8732),f=c(82015),g=c(66345),h=c(94142),i=c(39655),j=c(4720),k=c(95148),l=c(74952),m=a([g,h,i,j,k]);[g,h,i,j,k]=m.then?(await m)():m;let n=(0,f.memo)(({selectedVehicle:a,currentImageIndex:b,handlePrevImage:c,handleNextImage:d,selectThumbnail:f,setViewMode:m,setShowDeleteConfirm:n})=>{let o,p=a.images&&a.images.length>1,q=a.images?.[b]?.url,r=a=>{switch(a){case"active":return(0,e.jsx)(l.rAV,{className:"h-5 w-5 text-green-600"});case"in_service":return(0,e.jsx)(l.zD7,{className:"h-5 w-5 text-blue-600"});case"inactive":return(0,e.jsx)(l.hcu,{className:"h-5 w-5 text-orange-600"});default:return(0,e.jsx)(l.THT,{className:"h-5 w-5 text-muted-foreground"})}},s=a=>{switch(a){case"active":return"bg-green-100 text-green-800 border-green-200";case"in_service":return"bg-blue-100 text-blue-800 border-blue-200";case"inactive":return"bg-orange-100 text-orange-800 border-orange-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},t=a=>{switch(a){case"active":return"Active";case"in_service":return"In Service";case"inactive":return"Inactive";default:return"Unknown"}},u=a=>{if(!a)return!1;let b=new Date(a),c=new Date,d=Math.ceil((b.getTime()-c.getTime())/864e5);return d<=30&&d>0},v=a=>{if(!a)return!1;let b=new Date(a),c=new Date;return b<c};return(0,e.jsxs)("div",{className:"space-y-6",children:[(0,e.jsxs)("div",{className:"flex items-start justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsxs)("h2",{className:"text-2xl font-bold",children:[a.make," ",a.model]}),(0,e.jsx)("p",{className:"text-muted-foreground font-mono",children:a.registration})]}),(0,e.jsxs)("div",{className:"flex items-center gap-3",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[(o=a.type,"armoured"===o?(0,e.jsx)(l.ekZ,{className:"h-5 w-5"}):(0,e.jsx)(l.THT,{className:"h-5 w-5"})),(0,e.jsx)(j.E,{variant:"outline",className:"capitalize",children:a.type?.replace("_"," ")||"Unknown"})]}),(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[r(a.status),(0,e.jsx)(j.E,{variant:"outline",className:`capitalize ${s(a.status)}`,children:t(a.status)})]})]})]}),a.images&&a.images.length>0?(0,e.jsx)(i.Zp,{children:(0,e.jsx)(i.Wu,{className:"p-0",children:(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsxs)("div",{className:"w-full aspect-video bg-white rounded-t-xl overflow-hidden relative border border-border shadow-sm flex items-center justify-center",children:[q&&(0,e.jsx)("img",{src:q,alt:`Vehicle ${b+1}`,className:"w-full h-full object-contain rounded-t-xl transition-all duration-200"}),p&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(g.$,{variant:"outline",size:"icon",className:"absolute left-2 top-1/2 transform -translate-y-1/2 bg-background/80 hover:bg-background",onClick:c,children:(0,e.jsx)(l.JGc,{className:"h-4 w-4"})}),(0,e.jsx)(g.$,{variant:"outline",size:"icon",className:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-background/80 hover:bg-background",onClick:d,children:(0,e.jsx)(l.c_$,{className:"h-4 w-4"})})]})]}),a.images.length>1&&(0,e.jsx)(h.F,{className:"w-full h-24 border-t",children:(0,e.jsx)("div",{className:"flex gap-2 p-2",children:a.images.map((a,c)=>(0,e.jsx)("div",{className:`w-20 h-16 flex-shrink-0 cursor-pointer rounded-md overflow-hidden border-2 ${b===c?"border-primary":"border-transparent"}`,onClick:()=>f(c),children:(0,e.jsx)("img",{src:a.url,alt:`Vehicle thumbnail ${c+1}`,className:"w-full h-full object-cover"})},`thumb-${c}`))})})]})})}):(0,e.jsx)(i.Zp,{children:(0,e.jsx)(i.Wu,{className:"flex items-center justify-center w-full h-80 bg-muted rounded-lg",children:(0,e.jsx)(l.THT,{className:"h-16 w-16 text-muted-foreground"})})}),(0,e.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,e.jsxs)(i.Zp,{children:[(0,e.jsx)(i.aR,{children:(0,e.jsx)(i.ZB,{className:"text-lg",children:"Basic Information"})}),(0,e.jsxs)(i.Wu,{className:"space-y-4",children:[(0,e.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Make"}),(0,e.jsx)("p",{className:"text-sm font-medium",children:a.make})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Model"}),(0,e.jsx)("p",{className:"text-sm font-medium",children:a.model})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Year"}),(0,e.jsx)("p",{className:"text-sm font-medium",children:a.year||"N/A"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Color"}),(0,e.jsx)("p",{className:"text-sm font-medium",children:a.color||"N/A"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Fuel Type"}),(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[(0,e.jsx)(l.XHo,{className:"h-4 w-4 text-muted-foreground"}),(0,e.jsx)("p",{className:`text-sm font-medium ${(a=>{switch(a){case"electric":return"text-green-600";case"hybrid":return"text-blue-600";case"diesel":return"text-orange-600";case"petrol":return"text-gray-600";default:return"text-muted-foreground"}})(a.fuel_type)}`,children:(a=>a?({petrol:"Petrol",diesel:"Diesel",hybrid:"Hybrid",electric:"Electric"})[a]||a:"N/A")(a.fuel_type)})]})]})]}),(0,e.jsx)(k.w,{}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Registration"}),(0,e.jsx)("p",{className:"text-sm font-mono font-medium",children:a.registration})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"VIN"}),(0,e.jsx)("p",{className:"text-sm font-mono font-medium",children:a.vin||"N/A"})]})]})]}),(0,e.jsxs)(i.Zp,{children:[(0,e.jsx)(i.aR,{children:(0,e.jsx)(i.ZB,{className:"text-lg",children:"Status & Insurance"})}),(0,e.jsxs)(i.Wu,{className:"space-y-4",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Current Status"}),(0,e.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[r(a.status),(0,e.jsx)(j.E,{variant:"outline",className:`capitalize ${s(a.status)}`,children:t(a.status)})]})]}),(0,e.jsx)(k.w,{}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Insurance Expiry"}),(0,e.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,e.jsx)(l.VvS,{className:"h-4 w-4 text-muted-foreground"}),a.insurance_expiry?(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[(0,e.jsx)("span",{className:`text-sm font-medium ${v(a.insurance_expiry||null)?"text-red-600":u(a.insurance_expiry||null)?"text-orange-600":""}`,children:new Date(a.insurance_expiry).toLocaleDateString()}),(u(a.insurance_expiry||null)||v(a.insurance_expiry||null))&&(0,e.jsx)(j.E,{variant:"destructive",className:"text-xs",children:v(a.insurance_expiry||null)?"Expired":"Expiring Soon"})]}):(0,e.jsx)("span",{className:"text-sm text-muted-foreground",children:"Not specified"})]})]})]})]})]}),a.notes&&(0,e.jsxs)(i.Zp,{children:[(0,e.jsx)(i.aR,{children:(0,e.jsx)(i.ZB,{className:"text-lg",children:"Notes"})}),(0,e.jsx)(i.Wu,{children:(0,e.jsx)("p",{className:"text-sm text-muted-foreground whitespace-pre-wrap",children:a.notes})})]}),(0,e.jsxs)("div",{className:"flex justify-end gap-4 pt-4 border-t",children:[(0,e.jsxs)(g.$,{variant:"outline",onClick:()=>m("edit"),children:[(0,e.jsx)(l.ffu,{className:"mr-2 h-4 w-4"}),"Edit Vehicle"]}),(0,e.jsxs)(g.$,{variant:"destructive",onClick:()=>n(!0),children:[(0,e.jsx)(l.TBR,{className:"mr-2 h-4 w-4"}),"Delete Vehicle"]})]})]})});n.displayName="VehicleDetailsContent",d()}catch(a){d(a)}})},99737:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{m:()=>i});var e=c(8732),f=c(52307),g=c(87967),h=a([f,g]);function i({form:a}){return(0,e.jsx)(f.zB,{control:a.control,name:"notes",render:({field:a})=>(0,e.jsxs)(f.eI,{children:[(0,e.jsx)(f.lR,{children:"Notes"}),(0,e.jsx)(f.MJ,{children:(0,e.jsx)(g.T,{placeholder:"Additional notes about the vehicle",...a})}),(0,e.jsx)(f.C5,{})]})})}[f,g]=h.then?(await h)():h,d()}catch(a){d(a)}})}};var b=require("../webpack-runtime.js");b.C(a);var c=b.X(0,[4952,5611,5781,1913,4780,5833],()=>b(b.s=62287));module.exports=c})();