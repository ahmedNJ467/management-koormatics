"use strict";(()=>{var a={};a.id=9573,a.ids=[636,3220,9573],a.modules={4720:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{E:()=>i});var e=c(8732);c(82015);var f=c(8938),g=c(87092),h=a([f,g]);[f,g]=h.then?(await h)():h;let j=(0,f.cva)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i({className:a,variant:b,...c}){return(0,e.jsx)("div",{className:(0,g.cn)(j({variant:b}),a),...c})}d()}catch(a){d(a)}})},8732:a=>{a.exports=require("react/jsx-runtime")},8938:a=>{a.exports=import("class-variance-authority")},9640:a=>{a.exports=import("@radix-ui/react-slot")},13020:a=>{a.exports=import("@radix-ui/react-dialog")},16235:a=>{a.exports=import("@radix-ui/react-toast")},19771:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{V:()=>m});var e=c(8732),f=c(82015),g=c(74952),h=c(86093),i=c(87092),j=c(66345),k=c(57049),l=a([i,j,k]);function m({className:a,classNames:b,showOutsideDays:c=!0,...d}){return(0,e.jsx)(h.DayPicker,{showOutsideDays:c,className:(0,i.cn)("p-3",a),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,i.cn)((0,j.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,i.cn)((0,j.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...b},components:{Dropdown:({value:a,onChange:b,children:c,...d})=>{let g=f.Children.toArray(c),h=g.find(b=>b.props.value===a);return(0,e.jsxs)(k.l6,{value:a?.toString(),onValueChange:a=>{b?.({target:{value:a}})},children:[(0,e.jsx)(k.bq,{className:"h-7 w-fit gap-1 rounded-md border-0 bg-transparent px-2 py-1 font-medium focus:ring-0 focus:ring-offset-0 [&>*:first-child]:mr-1",children:(0,e.jsx)(k.yv,{children:h?.props?.children||a})}),(0,e.jsx)(k.gC,{children:g.map((a,b)=>(0,e.jsx)(k.eb,{value:a.props.value?.toString()??"",children:a.props.children},`${a.props.value}-${b}`))})]})},IconLeft:({...a})=>(0,e.jsx)(g.JGc,{className:"h-4 w-4"}),IconRight:({...a})=>(0,e.jsx)(g.c_$,{className:"h-4 w-4"})},...d})}[i,j,k]=l.then?(await l)():l,m.displayName="Calendar",d()}catch(a){d(a)}})},20598:a=>{a.exports=import("@radix-ui/react-label")},23835:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{default:()=>w});var e=c(8732),f=c(82015),g=c(66345),h=c(48383),i=c(74952),j=c(28462),k=c(95965),l=c(78059),m=c(57049),n=c(49229),o=c(65409),p=c(4720),q=c(34750),r=c(19771),s=c(71913),t=c(87092),u=c(58894),v=a([g,h,j,l,m,n,o,p,q,r,t]);function w(){let a=(0,j.useQueryClient)(),[b,c]=(0,f.useState)(!1),[d,v]=(0,f.useState)(),[w,x]=(0,f.useState)(""),[y,z]=(0,f.useState)("all"),[A,B]=(0,f.useState)(),[C,D]=(0,f.useState)(),{data:E,isLoading:F}=(0,j.useQuery)({queryKey:["maintenance"],queryFn:async()=>{let{data:a,error:b}=await k.N.from("maintenance").select(`
          *,
          vehicle:vehicles (
            id,
            make,
            model,
            registration
          )
        `).order("date",{ascending:!1});if(b)throw b;return(0,u.wH)(a)}}),G=E?.filter(a=>{let b=a.description.toLowerCase().includes(w.toLowerCase())||a.vehicle?.registration.toLowerCase().includes(w.toLowerCase())||a.service_provider?.toLowerCase().includes(w.toLowerCase()),c="all"===y||a.status===y,d=new Date(a.date),e=!A||d>=A,f=!C||d<=C;return b&&c&&e&&f}),[H,I]=(0,f.useState)(1),J=Math.ceil((G?.length||0)/20),K=(H-1)*20,L=K+20,M=G?.slice(K,L)||[];return G?.reduce((a,b)=>a+b.cost,0),G?.filter(a=>"completed"===a.status).length,G?.filter(a=>{let b=new Date(a.date),c=new Date;return"scheduled"===a.status&&b>=c}).length,G&&G.length>0&&G.length,(0,e.jsx)("div",{className:"min-h-screen bg-background",children:(0,e.jsxs)("div",{className:"p-4 px-6 space-y-6",children:[(0,e.jsx)("div",{className:"border-b border-border pb-4 pt-4",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsx)("div",{children:(0,e.jsx)("h1",{className:"text-2xl font-semibold text-foreground",children:"Maintenance"})}),(0,e.jsxs)("div",{className:"flex gap-2",children:[(0,e.jsxs)(g.$,{variant:"outline",size:"sm",className:"gap-2 text-foreground border-border/50",onClick:()=>{if(!G)return;let a=["Date,Vehicle,Description,Service Provider,Status,Cost,Next Scheduled",...G.map(a=>[new Date(a.date).toLocaleDateString(),a.vehicle?`${a.vehicle.make} ${a.vehicle.model} - ${a.vehicle.registration}`:"Unknown Vehicle",`"${a.description}"`,a.service_provider||"",a.status,a.cost,a.next_scheduled?new Date(a.next_scheduled).toLocaleDateString():""].join(","))].join("\n"),b=new Blob([a],{type:"text/csv"}),c=window.URL.createObjectURL(b),d=document.createElement("a");d.href=c,d.download=`maintenance-records-${new Date().toISOString().split("T")[0]}.csv`,d.click(),window.URL.revokeObjectURL(c)},children:[(0,e.jsx)(i.f5X,{className:"mr-2 h-4 w-4"})," Export"]}),(0,e.jsx)(g.$,{onClick:()=>c(!0),variant:"outline",size:"sm",className:"text-foreground border-border/50",children:"Add Record"})]})]})}),(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4",children:[(0,e.jsxs)("div",{className:"flex-1 relative group",children:[(0,e.jsx)(i.vji,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground group-focus-within:text-primary transition-colors"}),(0,e.jsx)(l.p,{placeholder:"Search records...",value:w,onChange:a=>x(a.target.value),className:"pl-9 h-11 border-border/50 focus:border-primary/50 transition-all duration-200"}),w&&(0,e.jsx)(g.$,{variant:"ghost",size:"sm",className:"absolute right-1 top-1 h-7 w-7 p-0 hover:bg-muted/50",onClick:()=>x(""),children:(0,e.jsx)(i.X,{className:"h-3 w-3"})})]}),(0,e.jsx)("div",{className:"flex items-center gap-3",children:(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[(0,e.jsxs)(m.l6,{value:y,onValueChange:z,children:[(0,e.jsxs)(m.bq,{className:"w-[140px] h-11 border-border/50 focus:border-primary/50",children:[(0,e.jsx)(i.dJT,{className:"mr-2 h-4 w-4"}),(0,e.jsx)(m.yv,{placeholder:"Status"})]}),(0,e.jsxs)(m.gC,{children:[(0,e.jsx)(m.eb,{value:"all",children:"All Status"}),(0,e.jsx)(m.eb,{value:"scheduled",children:"Scheduled"}),(0,e.jsx)(m.eb,{value:"in_progress",children:"In Progress"}),(0,e.jsx)(m.eb,{value:"completed",children:"Completed"}),(0,e.jsx)(m.eb,{value:"cancelled",children:"Cancelled"})]})]}),(0,e.jsxs)(q.AM,{children:[(0,e.jsx)(q.Wv,{asChild:!0,children:(0,e.jsxs)(g.$,{variant:"outline",className:(0,t.cn)("w-[200px] h-11 justify-start text-left font-normal border-border/50 focus:border-primary/50",!A&&!C&&"text-muted-foreground"),children:[(0,e.jsx)(i.VvS,{className:"mr-2 h-4 w-4"}),A?C?(0,e.jsxs)(e.Fragment,{children:[(0,s.GP)(A,"LLL dd, y")," -"," ",(0,s.GP)(C,"LLL dd, y")]}):(0,s.GP)(A,"LLL dd, y"):(0,e.jsx)("span",{children:"Pick a date range"})]})}),(0,e.jsx)(q.hl,{className:"w-auto p-0",align:"start",children:(0,e.jsx)(r.V,{initialFocus:!0,mode:"range",defaultMonth:A,selected:{from:A,to:C},onSelect:a=>{B(a?.from),D(a?.to)},numberOfMonths:2})})]})]})})]}),(w||"all"!==y||A||C)&&(0,e.jsxs)("div",{className:"flex items-center justify-between pt-3 border-t border-border/20",children:[(0,e.jsxs)("div",{className:"flex flex-wrap gap-2",children:[w&&(0,e.jsxs)(p.E,{variant:"secondary",className:"gap-1",children:['Search: "',w,'"',(0,e.jsx)(g.$,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-transparent",onClick:()=>x(""),children:(0,e.jsx)(i.X,{className:"h-3 w-3"})})]}),"all"!==y&&(0,e.jsxs)(p.E,{variant:"secondary",className:"gap-1",children:["Status: ",y.replace("_"," "),(0,e.jsx)(g.$,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-transparent",onClick:()=>z("all"),children:(0,e.jsx)(i.X,{className:"h-3 w-3"})})]}),A&&(0,e.jsxs)(p.E,{variant:"secondary",className:"gap-1",children:["From: ",(0,s.GP)(A,"LLL dd, y"),(0,e.jsx)(g.$,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-transparent",onClick:()=>B(void 0),children:(0,e.jsx)(i.X,{className:"h-3 w-3"})})]}),C&&(0,e.jsxs)(p.E,{variant:"secondary",className:"gap-1",children:["To: ",(0,s.GP)(C,"LLL dd, y"),(0,e.jsx)(g.$,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-transparent",onClick:()=>D(void 0),children:(0,e.jsx)(i.X,{className:"h-3 w-3"})})]})]}),(0,e.jsxs)(g.$,{variant:"outline",size:"sm",onClick:()=>{x(""),z("all"),B(void 0),D(void 0)},className:"shrink-0 text-muted-foreground hover:text-foreground",children:[(0,e.jsx)(i.X,{className:"mr-2 h-4 w-4"}),"Clear All"]})]})]}),(0,e.jsx)("div",{className:"rounded-lg border overflow-x-auto",children:(0,e.jsxs)(h.XI,{className:"min-w-[800px]",children:[(0,e.jsx)(h.A0,{children:(0,e.jsxs)(h.Hj,{children:[(0,e.jsx)(h.nd,{children:"Date"}),(0,e.jsx)(h.nd,{children:"Vehicle"}),(0,e.jsx)(h.nd,{children:"Description"}),(0,e.jsx)(h.nd,{children:"Service Provider"}),(0,e.jsx)(h.nd,{children:"Status"}),(0,e.jsx)(h.nd,{className:"text-right",children:"Expense (USD)"}),(0,e.jsx)(h.nd,{children:"Next Scheduled"})]})}),(0,e.jsx)(h.BF,{children:F?(0,e.jsx)(h.Hj,{children:(0,e.jsx)(h.nA,{colSpan:7,className:"text-center",children:"Loading records..."})}):M?.length===0?(0,e.jsx)(h.Hj,{children:(0,e.jsx)(h.nA,{colSpan:7,className:"text-center py-12",children:(0,e.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,e.jsx)(i.HL4,{className:"w-10 h-10 text-muted-foreground mb-2"}),(0,e.jsx)("span",{className:"text-lg font-medium",children:"No maintenance records found."}),(0,e.jsx)(g.$,{variant:"outline",size:"lg",className:"gap-2 mt-2 text-white border-white/20",onClick:()=>c(!0),children:"Add your first record"})]})})}):M?.map(a=>(0,e.jsxs)(h.Hj,{className:`cursor-pointer hover:bg-muted/50 ${"completed"===a.status?"opacity-75":""}`,onClick:()=>{v(a)},title:"completed"===a.status?"Click to view completed record (read-only)":"Click to edit record",children:[(0,e.jsx)(h.nA,{children:new Date(a.date).toLocaleDateString()}),(0,e.jsx)(h.nA,{children:a.vehicle?`${a.vehicle.make} ${a.vehicle.model} - ${a.vehicle.registration}`:"Unknown Vehicle"}),(0,e.jsx)(h.nA,{children:a.description}),(0,e.jsx)(h.nA,{children:a.service_provider||"-"}),(0,e.jsx)(h.nA,{children:(0,e.jsx)(o.z,{status:a.status})}),(0,e.jsxs)(h.nA,{className:"text-right",children:["$",a.cost.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),(0,e.jsx)(h.nA,{children:a.next_scheduled?new Date(a.next_scheduled).toLocaleDateString():"-"})]},a.id))})]})}),(0,e.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,e.jsx)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:(0,e.jsxs)("span",{children:["Showing ",K+1,"-",Math.min(L,G?.length||0)," of"," ",G?.length||0," maintenance records"]})}),(0,e.jsx)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:(0,e.jsxs)("span",{children:["Page ",H," of ",J]})})]}),J>1&&(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[(0,e.jsx)(g.$,{variant:"outline",size:"sm",onClick:()=>I(Math.max(1,H-1)),disabled:1===H,className:"h-8 px-3",children:"Previous"}),(0,e.jsx)("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,J)},(a,b)=>{let c=b+1;return J<=5||1===c||c===J||c>=H-1&&c<=H+1?(0,e.jsx)(g.$,{variant:H===c?"default":"outline",size:"sm",onClick:()=>I(c),className:"h-8 w-8 p-0",children:c},c):c===H-2||c===H+2?(0,e.jsx)("span",{className:"px-2 text-muted-foreground",children:"..."},c):null})}),(0,e.jsx)(g.$,{variant:"outline",size:"sm",onClick:()=>I(Math.min(J,H+1)),disabled:H===J,className:"h-8 px-3",children:"Next"})]}),(0,e.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,e.jsx)("span",{children:"â€¢"}),(0,e.jsxs)("span",{children:["Last updated: ",new Date().toLocaleTimeString()]})]})]}),(0,e.jsx)(n.E,{open:b||!!d,onOpenChange:a=>{c(a),a||v(void 0)},maintenance:d,onMaintenanceDeleted:()=>{a.invalidateQueries({queryKey:["maintenance"]}),v(void 0)}})]})})}[g,h,j,l,m,n,o,p,q,r,t]=v.then?(await v)():v,d()}catch(a){d(a)}})},25665:a=>{a.exports=import("@radix-ui/react-checkbox")},28462:a=>{a.exports=import("@tanstack/react-query")},33873:a=>{a.exports=require("path")},34750:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{AM:()=>j,Wv:()=>k,hl:()=>l});var e=c(8732),f=c(82015),g=c(60461),h=c(87092),i=a([g,h]);[g,h]=i.then?(await i)():i;let j=g.Root,k=g.Trigger,l=f.forwardRef(({className:a,align:b="center",sideOffset:c=4,...d},f)=>(0,e.jsx)(g.Portal,{children:(0,e.jsx)(g.Content,{ref:f,align:b,sideOffset:c,className:(0,h.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...d})}));l.displayName=g.Content.displayName,d()}catch(a){d(a)}})},38661:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{Cf:()=>o,Es:()=>q,HM:()=>m,L3:()=>r,c7:()=>p,lG:()=>j,rr:()=>s,zM:()=>k});var e=c(8732),f=c(82015),g=c(13020),h=c(87092),i=a([g,h]);[g,h]=i.then?(await i)():i;let j=g.Root,k=g.Trigger,l=g.Portal,m=g.Close,n=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Overlay,{ref:c,className:(0,h.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...b}));n.displayName=g.Overlay.displayName;let o=f.forwardRef(({className:a,children:b,...c},d)=>(0,e.jsxs)(l,{children:[(0,e.jsx)(n,{}),(0,e.jsx)(g.Content,{ref:d,className:(0,h.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...c,children:b})]}));o.displayName=g.Content.displayName;let p=({className:a,...b})=>(0,e.jsx)("div",{className:(0,h.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...b});p.displayName="DialogHeader";let q=({className:a,...b})=>(0,e.jsx)("div",{className:(0,h.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...b});q.displayName="DialogFooter";let r=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Title,{ref:c,className:(0,h.cn)("text-lg font-semibold leading-none tracking-tight",a),...b}));r.displayName=g.Title.displayName;let s=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Description,{ref:c,className:(0,h.cn)("text-sm text-muted-foreground",a),...b}));s.displayName=g.Description.displayName,d()}catch(a){d(a)}})},38827:a=>{a.exports=import("@radix-ui/react-separator")},39655:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{BT:()=>l,Wu:()=>m,ZB:()=>k,Zp:()=>i,aR:()=>j,wL:()=>n});var e=c(8732),f=c(82015),g=c(87092),h=a([g]);g=(h.then?(await h)():h)[0];let i=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("div",{ref:c,className:(0,g.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...b}));i.displayName="Card";let j=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("div",{ref:c,className:(0,g.cn)("flex flex-col space-y-1.5 p-6",a),...b}));j.displayName="CardHeader";let k=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("h3",{ref:c,className:(0,g.cn)("text-2xl font-semibold leading-none tracking-tight",a),...b}));k.displayName="CardTitle";let l=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("p",{ref:c,className:(0,g.cn)("text-sm text-muted-foreground",a),...b}));l.displayName="CardDescription";let m=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("div",{ref:c,className:(0,g.cn)("p-6 pt-0",a),...b}));m.displayName="CardContent";let n=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("div",{ref:c,className:(0,g.cn)("flex items-center p-6 pt-0",a),...b}));n.displayName="CardFooter",d()}catch(a){d(a)}})},40273:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{J:()=>l});var e=c(8732),f=c(82015),g=c(20598),h=c(8938),i=c(87092),j=a([g,h,i]);[g,h,i]=j.then?(await j)():j;let k=(0,h.cva)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),l=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Root,{ref:c,className:(0,i.cn)(k(),a),...b}));l.displayName=g.Root.displayName,d()}catch(a){d(a)}})},40361:a=>{a.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},40863:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{config:()=>r,default:()=>n,getServerSideProps:()=>q,getStaticPaths:()=>p,getStaticProps:()=>o,handler:()=>z,reportWebVitals:()=>s,routeModule:()=>y,unstable_getServerProps:()=>w,unstable_getServerSideProps:()=>x,unstable_getStaticParams:()=>v,unstable_getStaticPaths:()=>u,unstable_getStaticProps:()=>t});var e=c(63885),f=c(80237),g=c(81413),h=c(65611),i=c.n(h),j=c(74780),k=c(23835),l=c(12289),m=a([j,k]);[j,k]=m.then?(await m)():m;let n=(0,g.M)(k,"default"),o=(0,g.M)(k,"getStaticProps"),p=(0,g.M)(k,"getStaticPaths"),q=(0,g.M)(k,"getServerSideProps"),r=(0,g.M)(k,"config"),s=(0,g.M)(k,"reportWebVitals"),t=(0,g.M)(k,"unstable_getStaticProps"),u=(0,g.M)(k,"unstable_getStaticPaths"),v=(0,g.M)(k,"unstable_getStaticParams"),w=(0,g.M)(k,"unstable_getServerProps"),x=(0,g.M)(k,"unstable_getServerSideProps"),y=new e.PagesRouteModule({definition:{kind:f.RouteKind.PAGES,page:"/Maintenance",pathname:"/Maintenance",bundlePath:"",filename:""},distDir:".next-fleet",relativeProjectDir:"",components:{App:j.default,Document:i()},userland:k}),z=(0,l.U)({srcPage:"/Maintenance",config:r,userland:k,routeModule:y,getStaticPaths:p,getStaticProps:o,getServerSideProps:q});d()}catch(a){d(a)}})},41415:a=>{a.exports=import("sonner")},42971:a=>{a.exports=import("zod")},46060:a=>{a.exports=require("next/dist/shared/lib/no-fallback-error.external.js")},47860:a=>{a.exports=import("@radix-ui/react-select")},48303:a=>{a.exports=import("@radix-ui/react-tooltip")},48383:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{A0:()=>j,BF:()=>k,Gg:()=>l,Hj:()=>m,XI:()=>i,nA:()=>o,nd:()=>n,r6:()=>p});var e=c(8732),f=c(82015),g=c(87092),h=a([g]);g=(h.then?(await h)():h)[0];let i=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("div",{className:"relative w-full overflow-auto rounded-lg",children:(0,e.jsx)("table",{ref:c,className:(0,g.cn)("w-full caption-bottom text-sm bg-card text-card-foreground",a),...b})}));i.displayName="Table";let j=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("thead",{ref:c,className:(0,g.cn)("[&_tr]:border-b border-border bg-muted/50",a),...b}));j.displayName="TableHeader";let k=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("tbody",{ref:c,className:(0,g.cn)("[&_tr:last-child]:border-0",a),...b}));k.displayName="TableBody";let l=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("tfoot",{ref:c,className:(0,g.cn)("border-t border-border bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...b}));l.displayName="TableFooter";let m=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("tr",{ref:c,className:(0,g.cn)("border-b border-border transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...b}));m.displayName="TableRow";let n=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("th",{ref:c,className:(0,g.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...b}));n.displayName="TableHead";let o=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("td",{ref:c,className:(0,g.cn)("p-4 align-middle text-card-foreground [&:has([role=checkbox])]:pr-0",a),...b}));o.displayName="TableCell";let p=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("caption",{ref:c,className:(0,g.cn)("mt-4 text-sm text-muted-foreground",a),...b}));p.displayName="TableCaption",d()}catch(a){d(a)}})},49229:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{E:()=>l});var e=c(8732);c(82015);var f=c(38661),g=c(76569),h=c(67205),i=c(52347),j=c(58389),k=a([f,h,i,j]);function l({open:a,onOpenChange:b,maintenance:c,onMaintenanceDeleted:d}){let{toast:k}=(0,g.dj)(),l=c?.status==="completed",{form:m,isSubmitting:n,showDeleteDialog:o,setShowDeleteDialog:p,handleSubmit:q}=(0,h.N)(c),r=async a=>{l||(await q(a),b(!1))};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(f.lG,{open:a,onOpenChange:b,children:(0,e.jsxs)(f.Cf,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,e.jsxs)(f.c7,{children:[(0,e.jsx)(f.L3,{children:c?l?"View Maintenance Record":"Edit Maintenance Record":"Add Maintenance Record"}),(0,e.jsx)(f.rr,{children:l?"Maintenance record details (read-only). You can delete this record if needed.":"Enter the maintenance details below. Required fields are marked with an asterisk."})]}),(0,e.jsx)(i.D,{form:m,maintenance:c,isSubmitting:n,isReadOnly:l,onCancel:()=>b(!1),onDelete:()=>p(!0),onSubmit:r})]})}),(0,e.jsx)(j.L,{open:o,onOpenChange:p,maintenance:c,onDelete:()=>{p(!1),b(!1),d?.()}})]})}[f,h,i,j]=k.then?(await k)():k,d()}catch(a){d(a)}})},50802:a=>{a.exports=import("clsx")},52307:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{C5:()=>u,MJ:()=>s,Rr:()=>t,eI:()=>q,lR:()=>r,lV:()=>l,zB:()=>n});var e=c(8732),f=c(82015),g=c(9640),h=c(56884),i=c(87092),j=c(40273),k=a([g,h,i,j]);[g,h,i,j]=k.then?(await k)():k;let l=h.FormProvider,m=f.createContext({}),n=({...a})=>(0,e.jsx)(m.Provider,{value:{name:a.name},children:(0,e.jsx)(h.Controller,{...a})}),o=()=>{let a=f.useContext(m),b=f.useContext(p),{getFieldState:c,formState:d}=(0,h.useFormContext)(),e=c(a.name,d);if(!a)throw Error("useFormField should be used within <FormField>");let{id:g}=b;return{id:g,name:a.name,formItemId:`${g}-form-item`,formDescriptionId:`${g}-form-item-description`,formMessageId:`${g}-form-item-message`,...e}},p=f.createContext({}),q=f.forwardRef(({className:a,...b},c)=>{let d=f.useId();return(0,e.jsx)(p.Provider,{value:{id:d},children:(0,e.jsx)("div",{ref:c,className:(0,i.cn)("space-y-2",a),...b})})});q.displayName="FormItem";let r=f.forwardRef(({className:a,...b},c)=>{let{error:d,formItemId:f}=o();return(0,e.jsx)(j.J,{ref:c,className:(0,i.cn)(d&&"text-destructive",a),htmlFor:f,...b})});r.displayName="FormLabel";let s=f.forwardRef(({...a},b)=>{let{error:c,formItemId:d,formDescriptionId:f,formMessageId:h}=o();return(0,e.jsx)(g.Slot,{ref:b,id:d,"aria-describedby":c?`${f} ${h}`:`${f}`,"aria-invalid":!!c,...a})});s.displayName="FormControl";let t=f.forwardRef(({className:a,...b},c)=>{let{formDescriptionId:d}=o();return(0,e.jsx)("p",{ref:c,id:d,className:(0,i.cn)("text-sm text-muted-foreground",a),...b})});t.displayName="FormDescription";let u=f.forwardRef(({className:a,children:b,...c},d)=>{let{error:f,formMessageId:g}=o(),h=f?String(f?.message):b;return h?(0,e.jsx)("p",{ref:d,id:g,className:(0,i.cn)("text-sm font-medium text-destructive",a),...c,children:h}):null});u.displayName="FormMessage",d()}catch(a){d(a)}})},52347:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{D:()=>s});var e=c(8732),f=c(66345),g=c(52307),h=c(78059),i=c(87967),j=c(57049),k=c(28462),l=c(95965),m=c(39655),n=c(85072),o=c(82015),p=c(74952),q=c(95148),r=a([f,g,h,i,j,k,m,n,q]);function s({form:a,maintenance:b,isSubmitting:c,isReadOnly:d=!1,onCancel:r,onDelete:s,onSubmit:t}){let[u,v]=(0,o.useState)(b?.spare_parts||[]);b?.status;let{data:w}=(0,k.useQuery)({queryKey:["vehicles"],queryFn:async()=>{let{data:a,error:b}=await l.N.from("vehicles").select("*").order("make",{ascending:!0});if(b)throw b;return a||[]}}),{data:x}=(0,k.useQuery)({queryKey:["spare-parts"],queryFn:async()=>{let{data:a,error:b}=await l.N.from("spare_parts").select("*").gt("quantity",0).in("status",["in_stock","low_stock"]).order("name",{ascending:!0});if(b)throw b;return a||[]}});return(0,e.jsx)(g.lV,{...a,children:(0,e.jsxs)("form",{onSubmit:a.handleSubmit(a=>{let b={...a,spare_parts:u};t(b)}),className:"space-y-6",children:[(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2 text-lg font-semibold",children:[(0,e.jsx)(p.IFY,{className:"h-5 w-5"}),(0,e.jsx)("span",{children:"Vehicle & Basic Information"})]}),(0,e.jsx)(g.zB,{control:a.control,name:"vehicle_id",render:({field:a})=>(0,e.jsxs)(g.eI,{children:[(0,e.jsx)(g.lR,{className:"text-base",children:"Vehicle *"}),(0,e.jsx)(g.Rr,{children:"Select the vehicle that requires maintenance"}),(0,e.jsxs)(j.l6,{onValueChange:a.onChange,defaultValue:a.value,disabled:d,children:[(0,e.jsx)(g.MJ,{children:(0,e.jsx)(j.bq,{className:`h-11 ${d?"opacity-60":""}`,children:(0,e.jsx)(j.yv,{placeholder:"Choose a vehicle..."})})}),(0,e.jsx)(j.gC,{children:w?.map(a=>(0,e.jsxs)(j.eb,{value:a.id,children:[a.make," ",a.model," - ",a.registration]},a.id))})]}),(0,e.jsx)(g.C5,{})]})}),(0,e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,e.jsx)(g.zB,{control:a.control,name:"date",render:({field:a})=>(0,e.jsxs)(g.eI,{children:[(0,e.jsx)(g.lR,{className:"text-base",children:"Maintenance Date *"}),(0,e.jsx)(g.Rr,{children:"When was/is the maintenance performed"}),(0,e.jsx)(g.MJ,{children:(0,e.jsx)(h.p,{type:"date",className:"h-11",...a,readOnly:d})}),(0,e.jsx)(g.C5,{})]})}),(0,e.jsx)(g.zB,{control:a.control,name:"next_scheduled",render:({field:a})=>(0,e.jsxs)(g.eI,{children:[(0,e.jsx)(g.lR,{className:"text-base",children:"Next Scheduled"}),(0,e.jsx)(g.Rr,{children:"When is the next maintenance due"}),(0,e.jsx)(g.MJ,{children:(0,e.jsx)(h.p,{type:"date",className:"h-11",...a,readOnly:d})}),(0,e.jsx)(g.C5,{})]})})]})]}),(0,e.jsx)(q.w,{}),(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2 text-lg font-semibold",children:[(0,e.jsx)(p.iUU,{className:"h-5 w-5"}),(0,e.jsx)("span",{children:"Maintenance Details"})]}),(0,e.jsx)(g.zB,{control:a.control,name:"description",render:({field:a})=>(0,e.jsxs)(g.eI,{children:[(0,e.jsx)(g.lR,{className:"text-base",children:"Description *"}),(0,e.jsx)(g.Rr,{children:"Brief description of the maintenance work performed"}),(0,e.jsx)(g.MJ,{children:(0,e.jsx)(h.p,{placeholder:"e.g., Oil change, brake pad replacement, engine tune-up...",className:"h-11",readOnly:d,...a})}),(0,e.jsx)(g.C5,{})]})}),(0,e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,e.jsx)(g.zB,{control:a.control,name:"expense",render:({field:a})=>(0,e.jsxs)(g.eI,{children:[(0,e.jsx)(g.lR,{className:"text-base",children:"External Expense (USD) *"}),(0,e.jsx)(g.Rr,{children:"Cost of external services or parts"}),(0,e.jsx)(g.MJ,{children:(0,e.jsx)(h.p,{type:"number",step:"0.01",min:"0",placeholder:"0.00",className:"h-11",readOnly:d,...a,onChange:b=>a.onChange(parseFloat(b.target.value)||0)})}),(0,e.jsx)(g.C5,{})]})}),(0,e.jsx)(g.zB,{control:a.control,name:"status",render:({field:a})=>(0,e.jsxs)(g.eI,{children:[(0,e.jsx)(g.lR,{className:"text-base",children:"Status"}),(0,e.jsx)(g.Rr,{children:"Current status of the maintenance"}),(0,e.jsxs)(j.l6,{onValueChange:a.onChange,defaultValue:a.value,disabled:d,children:[(0,e.jsx)(g.MJ,{children:(0,e.jsx)(j.bq,{className:`h-11 ${d?"opacity-60":""}`,children:(0,e.jsx)(j.yv,{placeholder:"Select status"})})}),(0,e.jsxs)(j.gC,{children:[(0,e.jsx)(j.eb,{value:"scheduled",children:"Scheduled"}),(0,e.jsx)(j.eb,{value:"in_progress",children:"In Progress"}),(0,e.jsx)(j.eb,{value:"completed",children:"Completed"}),(0,e.jsx)(j.eb,{value:"cancelled",children:"Cancelled"})]})]}),(0,e.jsx)(g.C5,{})]})})]}),(0,e.jsx)(g.zB,{control:a.control,name:"service_provider",render:({field:a})=>(0,e.jsxs)(g.eI,{children:[(0,e.jsx)(g.lR,{className:"text-base",children:"Service Provider"}),(0,e.jsx)(g.Rr,{children:"Name of the service provider or mechanic"}),(0,e.jsx)(g.MJ,{children:(0,e.jsx)(h.p,{placeholder:"e.g., ABC Auto Service, John's Garage...",className:"h-11",readOnly:d,...a})}),(0,e.jsx)(g.C5,{})]})})]}),(0,e.jsx)(q.w,{}),(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2 text-lg font-semibold",children:[(0,e.jsx)(p.lPX,{className:"h-5 w-5"}),(0,e.jsx)("span",{children:"Spare Parts Used"})]}),(0,e.jsx)("div",{className:"text-sm text-muted-foreground",children:"Select spare parts from inventory that were used in this maintenance"}),(0,e.jsx)(m.Zp,{className:"border-dashed",children:(0,e.jsx)(m.Wu,{className:`p-4 ${d?"opacity-60 pointer-events-none":""}`,children:x?.length?(0,e.jsx)("div",{className:"grid grid-cols-1 gap-3 max-h-[300px] overflow-y-auto",children:x.map(a=>(0,e.jsx)(m.Zp,{className:`border transition-colors ${u.some(b=>b.id===a.id)?"border-primary bg-primary/5":"hover:border-muted-foreground/30"}`,children:(0,e.jsx)(m.Wu,{className:"p-4",children:(0,e.jsxs)("div",{className:"flex items-start justify-between",children:[(0,e.jsxs)("div",{className:"flex items-start gap-3 flex-1",children:[(0,e.jsx)(n.S,{id:`part-${a.id}`,checked:u.some(b=>b.id===a.id),onCheckedChange:()=>{var b;return b=a.id,void(u.some(a=>a.id===b)?v(u.filter(a=>a.id!==b)):v([...u,{id:b,quantity:1}]))},className:"mt-1"}),(0,e.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,e.jsx)("label",{htmlFor:`part-${a.id}`,className:"font-medium cursor-pointer block",children:a.name}),(0,e.jsxs)("div",{className:"text-sm text-muted-foreground mt-1",children:[(0,e.jsxs)("div",{children:["Part #: ",a.part_number]}),(0,e.jsxs)("div",{children:["Category: ",a.category]}),(0,e.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,e.jsx)("span",{children:"Available:"}),(0,e.jsxs)("span",{className:`font-medium ${a.quantity<=(a.min_stock_level||5)?"text-orange-600":"text-green-600"}`,children:[a.quantity," units"]})]})]})]})]}),u.some(b=>b.id===a.id)&&(0,e.jsxs)("div",{className:"flex items-center gap-2 ml-4",children:[(0,e.jsx)("span",{className:"text-sm font-medium",children:"Qty:"}),(0,e.jsx)(h.p,{type:"number",min:"1",max:a.quantity,className:"w-20 h-8 text-center",value:u.find(b=>b.id===a.id)?.quantity||1,onChange:b=>{var c,d;return c=a.id,d=parseInt(b.target.value)||1,void v(u.map(a=>a.id===c?{...a,quantity:d}:a))}})]})]})})},a.id))}):(0,e.jsxs)("div",{className:"text-center py-8",children:[(0,e.jsx)(p.lPX,{className:"h-12 w-12 text-muted-foreground mx-auto mb-3"}),(0,e.jsx)("p",{className:"text-muted-foreground",children:"No spare parts available in inventory"}),(0,e.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Add spare parts to inventory to use them in maintenance records"})]})})})]}),(0,e.jsx)(q.w,{}),(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2 text-lg font-semibold",children:[(0,e.jsx)(p.iUU,{className:"h-5 w-5"}),(0,e.jsx)("span",{children:"Additional Notes"})]}),(0,e.jsx)(g.zB,{control:a.control,name:"notes",render:({field:a})=>(0,e.jsxs)(g.eI,{children:[(0,e.jsx)(g.lR,{className:"text-base",children:"Notes"}),(0,e.jsx)(g.Rr,{children:"Any additional information about the maintenance"}),(0,e.jsx)(g.MJ,{children:(0,e.jsx)(i.T,{placeholder:"Enter any additional notes, observations, or special instructions...",className:"min-h-[120px] resize-none",readOnly:d,...a})}),(0,e.jsx)(g.C5,{})]})})]}),(0,e.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t",children:[(0,e.jsxs)("div",{className:"flex gap-2",children:[(0,e.jsx)(f.$,{type:"button",variant:"outline",onClick:r,disabled:c,children:d?"Close":"Cancel"}),b&&(0,e.jsx)(f.$,{type:"button",variant:"destructive",onClick:s,disabled:c,children:"Delete Record"})]}),!d&&(0,e.jsx)(f.$,{type:"submit",disabled:c,className:"min-w-[120px]",children:c?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):(0,e.jsx)(e.Fragment,{children:b?"Update Record":"Add Record"})})]})]})})}[f,g,h,i,j,k,m,n,q]=r.then?(await r)():r,d()}catch(a){d(a)}})},56884:a=>{a.exports=import("react-hook-form")},57049:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{bq:()=>m,eb:()=>q,gC:()=>p,l6:()=>k,yv:()=>l});var e=c(8732),f=c(82015),g=c(47860),h=c(74952),i=c(87092),j=a([g,i]);[g,i]=j.then?(await j)():j;let k=g.Root;g.Group;let l=g.Value,m=f.forwardRef(({className:a,children:b,...c},d)=>(0,e.jsxs)(g.Trigger,{ref:d,className:(0,i.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-0 focus-visible:ring-0 focus:ring-offset-0 focus-visible:ring-offset-0 focus:border-ring focus-visible:border-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1 transition-colors",a),...c,children:[b,(0,e.jsx)(g.Icon,{asChild:!0,children:(0,e.jsx)(h.yQN,{className:"h-4 w-4 opacity-50"})})]}));m.displayName=g.Trigger.displayName;let n=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.ScrollUpButton,{ref:c,className:(0,i.cn)("flex cursor-default items-center justify-center py-1",a),...b,children:(0,e.jsx)(h.rXn,{className:"h-4 w-4"})}));n.displayName=g.ScrollUpButton.displayName;let o=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.ScrollDownButton,{ref:c,className:(0,i.cn)("flex cursor-default items-center justify-center py-1",a),...b,children:(0,e.jsx)(h.yQN,{className:"h-4 w-4"})}));o.displayName=g.ScrollDownButton.displayName;let p=f.forwardRef(({className:a,children:b,position:c="popper",...d},f)=>(0,e.jsx)(g.Portal,{children:(0,e.jsxs)(g.Content,{ref:f,className:(0,i.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===c&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:c,...d,children:[(0,e.jsx)(n,{}),(0,e.jsx)(g.Viewport,{className:(0,i.cn)("p-1","popper"===c&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:b}),(0,e.jsx)(o,{})]})}));p.displayName=g.Content.displayName,f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Label,{ref:c,className:(0,i.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...b})).displayName=g.Label.displayName;let q=f.forwardRef(({className:a,children:b,...c},d)=>(0,e.jsxs)(g.Item,{ref:d,className:(0,i.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...c,children:[(0,e.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,e.jsx)(g.ItemIndicator,{children:(0,e.jsx)(h.Jlk,{className:"h-4 w-4"})})}),(0,e.jsx)(g.ItemText,{children:b})]}));q.displayName=g.Item.displayName,f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Separator,{ref:c,className:(0,i.cn)("-mx-1 my-1 h-px bg-muted",a),...b})).displayName=g.Separator.displayName,d()}catch(a){d(a)}})},57312:a=>{a.exports=import("next-themes")},57973:a=>{a.exports=import("@radix-ui/react-alert-dialog")},58389:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{L:()=>j});var e=c(8732),f=c(95020),g=c(76569),h=c(95965),i=a([f]);function j({open:a,onOpenChange:b,maintenance:c,onDelete:d}){let{toast:i}=(0,g.dj)(),j=async()=>{if(c)try{let{error:a}=await h.N.from("maintenance").delete().eq("id",c.id).single();if(a)throw a;i({title:"Maintenance record deleted",description:"The maintenance record has been deleted successfully."}),d()}catch(a){console.error("Error:",a),i({title:"Error",description:a instanceof Error?a.message:"Failed to delete maintenance record",variant:"destructive"})}};return(0,e.jsx)(f.Lt,{open:a,onOpenChange:b,children:(0,e.jsxs)(f.EO,{children:[(0,e.jsxs)(f.wd,{children:[(0,e.jsx)(f.r7,{children:"Are you sure?"}),(0,e.jsx)(f.$v,{children:"This will permanently delete this maintenance record. This action cannot be undone."})]}),(0,e.jsxs)(f.ck,{children:[(0,e.jsx)(f.Zr,{children:"Cancel"}),(0,e.jsx)(f.Rx,{onClick:j,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})}f=(i.then?(await i)():i)[0],d()}catch(a){d(a)}})},58894:(a,b,c)=>{function d(a){return a&&"object"==typeof a&&"error"in a&&!0===a.error}function e(a){return Array.isArray(a)?a.filter(a=>!d(a)):[]}function f(a){return d(a)?null:a}c.d(b,{to:()=>f,wH:()=>e})},60461:a=>{a.exports=import("@radix-ui/react-popover")},65409:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{z:()=>i});var e=c(8732),f=c(4720),g=c(74952),h=a([f]);f=(h.then?(await h)():h)[0];let j={completed:"bg-green-500/20 text-green-600 border-green-500/30",in_progress:"bg-blue-500/20 text-blue-600 border-blue-500/30",scheduled:"bg-yellow-500/20 text-yellow-600 border-yellow-500/30",cancelled:"bg-red-500/20 text-red-600 border-red-500/30"},k={completed:"Completed",in_progress:"In Progress",scheduled:"Scheduled",cancelled:"Cancelled"},l={completed:(0,e.jsx)(g.Jlk,{className:"w-3 h-3 mr-1"}),in_progress:(0,e.jsx)(g.zD7,{className:"w-3 h-3 mr-1"}),scheduled:(0,e.jsx)(g.VvS,{className:"w-3 h-3 mr-1"}),cancelled:(0,e.jsx)(g.hcu,{className:"w-3 h-3 mr-1"})};function i({status:a}){return(0,e.jsxs)(f.E,{className:`${j[a]} font-medium`,variant:"outline",children:[l[a],k[a]]})}d()}catch(a){d(a)}})},67205:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{N:()=>m});var e=c(82015),f=c(56884),g=c(98825),h=c(42971),i=c(95965),j=c(76569),k=c(28462),l=a([f,g,h,k]);[f,g,h,k]=l.then?(await l)():l;let n=h.z.object({vehicle_id:h.z.string().min(1,"Vehicle is required"),date:h.z.string().min(1,"Date is required"),description:h.z.string().min(1,"Description is required"),expense:h.z.number().min(0,"Expense must be a positive number"),next_scheduled:h.z.string().optional(),status:h.z.enum(["scheduled","in_progress","completed","cancelled"]),notes:h.z.string().optional(),service_provider:h.z.string().optional()});function m(a){let{toast:b}=(0,j.dj)(),c=(0,k.useQueryClient)(),[d,h]=(0,e.useState)(!1),[l,m]=(0,e.useState)(!1),o=(0,f.useForm)({resolver:(0,g.zodResolver)(n),defaultValues:a?{vehicle_id:a.vehicle_id,date:a.date,description:a.description,expense:a.cost,next_scheduled:a.next_scheduled||"",status:a.status,notes:a.notes||"",service_provider:a.service_provider||""}:{vehicle_id:"",date:"",description:"",expense:0,next_scheduled:"",status:"scheduled",notes:"",service_provider:""}}),p=async d=>{h(!0);try{let e={vehicle_id:d.vehicle_id,date:d.date,description:d.description,cost:Number(d.expense),status:d.status,next_scheduled:d.next_scheduled||null,notes:d.notes||null,service_provider:d.service_provider||null},f=a?.id;if(a){let{error:b}=await i.N.from("maintenance").update(e).eq("id",a.id).single();if(b)throw b}else{let{data:a,error:b}=await i.N.from("maintenance").insert(e).select().single();if(b)throw b;a&&"id"in a&&(f=a.id)}if(d.spare_parts&&d.spare_parts.length>0&&f&&"completed"===d.status){let a=new Date().toISOString().split("T")[0];for(let b of d.spare_parts){let{data:c}=await i.N.from("spare_parts").select("quantity, quantity_used, min_stock_level").eq("id",b.id).single();if(c&&"quantity"in c){let d=Math.max(0,c.quantity-b.quantity),e=(c.quantity_used||0)+b.quantity;await i.N.from("spare_parts").update({quantity:d,quantity_used:e,last_used_date:a,maintenance_id:f,status:0===d?"out_of_stock":d<=c.min_stock_level?"low_stock":"in_stock"}).eq("id",b.id)}}}if("completed"===d.status&&d.next_scheduled){let a={vehicle_id:d.vehicle_id,date:d.next_scheduled,description:`Follow-up: ${d.description}`,cost:0,status:"scheduled",next_scheduled:null,notes:`Auto-generated follow-up maintenance for previous service on ${d.date}`,service_provider:d.service_provider||null},{error:c}=await i.N.from("maintenance").insert(a);c?(console.error("Error creating next scheduled maintenance:",c),b({title:"Warning",description:"Maintenance completed but failed to create next scheduled maintenance",variant:"destructive"})):console.log("Next scheduled maintenance created successfully")}c.invalidateQueries({queryKey:["maintenance"]}),c.invalidateQueries({queryKey:["spare-parts"]});let g=a?"Maintenance record updated":"Maintenance record created",h=a?"The maintenance record has been updated successfully.":"A new maintenance record has been created successfully.",j="completed"===d.status&&d.next_scheduled?`${h} Next scheduled maintenance has been automatically created for ${d.next_scheduled}.`:h;b({title:g,description:j}),o.reset()}catch(a){console.error("Error:",a),b({title:"Error",description:a instanceof Error?a.message:"Failed to save maintenance record",variant:"destructive"})}finally{h(!1)}};return{form:o,isSubmitting:d,showDeleteDialog:l,setShowDeleteDialog:m,handleSubmit:p}}d()}catch(a){d(a)}})},75979:a=>{a.exports=import("tailwind-merge")},78059:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{p:()=>i});var e=c(8732),f=c(82015),g=c(87092),h=a([g]);g=(h.then?(await h)():h)[0];let i=f.forwardRef(({className:a,type:b,onAddItem:c,onRemoveItem:d,showAddButton:f,showRemoveButton:h,addButtonLabel:i,removeButtonLabel:j,...k},l)=>(0,e.jsxs)("div",{className:f||h?"flex items-center gap-2":"",children:[(0,e.jsx)("input",{type:b,className:(0,g.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus:outline-none focus:ring-0 focus-visible:ring-0 focus:ring-offset-0 focus-visible:ring-offset-0 focus:border-ring focus-visible:border-ring disabled:cursor-not-allowed disabled:opacity-50 transition-colors",a),ref:l,onKeyDown:c?a=>{"Enter"===a.key&&c&&(a.preventDefault(),c())}:void 0,...k}),f&&c&&(0,e.jsx)("button",{type:"button",className:"inline-flex h-10 items-center justify-center rounded-md bg-primary px-3 py-2 text-sm font-medium text-primary-foreground hover:bg-primary/90",onClick:c,children:i||"Add"}),h&&d&&(0,e.jsx)("button",{type:"button",className:"inline-flex h-10 items-center justify-center rounded-md bg-destructive px-3 py-2 text-sm font-medium text-destructive-foreground hover:bg-destructive/90",onClick:d,children:j||"Remove"})]}));i.displayName="Input",d()}catch(a){d(a)}})},82015:a=>{a.exports=require("react")},85072:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{S:()=>k});var e=c(8732),f=c(82015),g=c(25665),h=c(74952),i=c(87092),j=a([g,i]);[g,i]=j.then?(await j)():j;let k=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Root,{ref:c,className:(0,i.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus:outline-none focus:ring-0 focus-visible:ring-0 focus:ring-offset-0 focus-visible:ring-offset-0 focus:border-ring focus-visible:border-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground transition-colors",a),...b,children:(0,e.jsx)(g.Indicator,{className:(0,i.cn)("flex items-center justify-center text-current"),children:(0,e.jsx)(h.Jlk,{className:"h-4 w-4"})})}));k.displayName=g.Root.displayName,d()}catch(a){d(a)}})},86093:a=>{a.exports=require("react-day-picker")},87967:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{T:()=>i});var e=c(8732),f=c(82015),g=c(87092),h=a([g]);g=(h.then?(await h)():h)[0];let i=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("textarea",{className:(0,g.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-0 focus-visible:ring-0 focus:ring-offset-0 focus-visible:ring-offset-0 focus:border-ring focus-visible:border-ring disabled:cursor-not-allowed disabled:opacity-50 transition-colors",a),ref:c,...b}));i.displayName="Textarea",d()}catch(a){d(a)}})},93939:a=>{a.exports=require("@supabase/supabase-js")},95020:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{$v:()=>r,EO:()=>n,Lt:()=>k,Rx:()=>s,Zr:()=>t,ck:()=>p,r7:()=>q,wd:()=>o});var e=c(8732),f=c(82015),g=c(57973),h=c(87092),i=c(66345),j=a([g,h,i]);[g,h,i]=j.then?(await j)():j;let k=g.Root;g.Trigger;let l=g.Portal,m=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Overlay,{className:(0,h.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...b,ref:c}));m.displayName=g.Overlay.displayName;let n=f.forwardRef(({className:a,...b},c)=>(0,e.jsxs)(l,{children:[(0,e.jsx)(m,{}),(0,e.jsx)(g.Content,{ref:c,className:(0,h.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...b})]}));n.displayName=g.Content.displayName;let o=({className:a,...b})=>(0,e.jsx)("div",{className:(0,h.cn)("flex flex-col space-y-2 text-center sm:text-left",a),...b});o.displayName="AlertDialogHeader";let p=({className:a,...b})=>(0,e.jsx)("div",{className:(0,h.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...b});p.displayName="AlertDialogFooter";let q=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Title,{ref:c,className:(0,h.cn)("text-lg font-semibold",a),...b}));q.displayName=g.Title.displayName;let r=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Description,{ref:c,className:(0,h.cn)("text-sm text-muted-foreground",a),...b}));r.displayName=g.Description.displayName;let s=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Action,{ref:c,className:(0,h.cn)((0,i.r)(),a),...b}));s.displayName=g.Action.displayName;let t=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Cancel,{ref:c,className:(0,h.cn)((0,i.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...b}));t.displayName=g.Cancel.displayName,d()}catch(a){d(a)}})},95148:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{w:()=>j});var e=c(8732),f=c(82015),g=c(38827),h=c(87092),i=a([g,h]);[g,h]=i.then?(await i)():i;let j=f.forwardRef(({className:a,orientation:b="horizontal",decorative:c=!0,...d},f)=>(0,e.jsx)(g.Root,{ref:f,decorative:c,orientation:b,className:(0,h.cn)("shrink-0 bg-border","horizontal"===b?"h-[1px] w-full":"h-full w-[1px]",a),...d}));j.displayName=g.Root.displayName,d()}catch(a){d(a)}})},98825:a=>{a.exports=import("@hookform/resolvers/zod")}};var b=require("../webpack-runtime.js");b.C(a);var c=b.X(0,[4952,5611,5781,1913,4780],()=>b(b.s=40863));module.exports=c})();