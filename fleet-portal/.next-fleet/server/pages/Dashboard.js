(()=>{var a={};a.id=8028,a.ids=[636,3220,8028],a.modules={6516:a=>{"use strict";a.exports=require("react-smooth")},8732:a=>{"use strict";a.exports=require("react/jsx-runtime")},8921:a=>{"use strict";a.exports=require("lodash/maxBy")},8938:a=>{"use strict";a.exports=import("class-variance-authority")},9640:a=>{"use strict";a.exports=import("@radix-ui/react-slot")},9888:a=>{"use strict";a.exports=require("lodash/first")},9948:a=>{"use strict";a.exports=require("lodash/upperFirst")},11570:a=>{"use strict";a.exports=require("lodash/isBoolean")},13261:a=>{"use strict";a.exports=require("victory-vendor/d3-shape")},14014:a=>{"use strict";a.exports=require("lodash/isFunction")},16235:a=>{"use strict";a.exports=import("@radix-ui/react-toast")},16490:a=>{"use strict";a.exports=require("lodash/mapValues")},18725:a=>{"use strict";a.exports=require("lodash/every")},18989:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{config:()=>r,default:()=>n,getServerSideProps:()=>q,getStaticPaths:()=>p,getStaticProps:()=>o,handler:()=>z,reportWebVitals:()=>s,routeModule:()=>y,unstable_getServerProps:()=>w,unstable_getServerSideProps:()=>x,unstable_getStaticParams:()=>v,unstable_getStaticPaths:()=>u,unstable_getStaticProps:()=>t});var e=c(63885),f=c(80237),g=c(81413),h=c(65611),i=c.n(h),j=c(74780),k=c(76684),l=c(12289),m=a([j,k]);[j,k]=m.then?(await m)():m;let n=(0,g.M)(k,"default"),o=(0,g.M)(k,"getStaticProps"),p=(0,g.M)(k,"getStaticPaths"),q=(0,g.M)(k,"getServerSideProps"),r=(0,g.M)(k,"config"),s=(0,g.M)(k,"reportWebVitals"),t=(0,g.M)(k,"unstable_getStaticProps"),u=(0,g.M)(k,"unstable_getStaticPaths"),v=(0,g.M)(k,"unstable_getStaticParams"),w=(0,g.M)(k,"unstable_getServerProps"),x=(0,g.M)(k,"unstable_getServerSideProps"),y=new e.PagesRouteModule({definition:{kind:f.RouteKind.PAGES,page:"/Dashboard",pathname:"/Dashboard",bundlePath:"",filename:""},distDir:".next-fleet",relativeProjectDir:"",components:{App:j.default,Document:i()},userland:k}),z=(0,l.U)({srcPage:"/Dashboard",config:r,userland:k,routeModule:y,getStaticPaths:p,getStaticProps:o,getServerSideProps:q});d()}catch(a){d(a)}})},22729:(a,b,c)=>{"use strict";a.exports=c(63885).vendored.contexts.Loadable},26703:a=>{"use strict";a.exports=require("lodash/sortBy")},27207:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{E:()=>h});var e=c(82015);c(43411);var f=c(48443),g=a([f]);function h(){let[a,b]=(0,e.useState)("management"),[c,d]=(0,e.useState)(!1),{hasRole:g,roles:h,loading:i}=(0,f.I)(),j=(0,e.useMemo)(()=>!0,[a,g,h.length,i,c]);return console.log("useTenantScope Debug:",{domain:a,roles:h.length>0?h:"No roles",loading:i,mounted:c,isAllowed:j,isLoading:!1}),{domain:a,isAllowed:j,loading:!1}}f=(g.then?(await g)():g)[0],d()}catch(a){d(a)}})},27962:(a,b,c)=>{"use strict";c.d(b,{n:()=>f});var d=c(95965);class e{subscribeToTable(a,b){let c=`public:${a}`;if(this.subscribers.has(c))return this.subscribers.get(c).add(b),()=>this.unsubscribeFromTable(a,b);if(this.channels.has(c)){let d=this.channels.get(c);if(this.isChannelValid(d))return this.subscribers.get(c).add(b),()=>this.unsubscribeFromTable(a,b);this.channels.delete(c),this.subscribers.delete(c)}try{let e=d.N.channel(c).on("postgres_changes",{event:"*",schema:"public",table:a},a=>{let b=this.subscribers.get(c);b&&b.forEach(b=>b(a))}).subscribe();return this.channels.set(c,e),this.subscribers.set(c,new Set([b])),()=>this.unsubscribeFromTable(a,b)}catch(b){return console.warn(`Failed to subscribe to ${a}:`,b),()=>{}}}unsubscribeFromTable(a,b){let c=`public:${a}`,e=this.subscribers.get(c);if(e&&(e.delete(b),0===e.size)){let a=this.channels.get(c);a&&d.N.removeChannel(a),this.channels.delete(c),this.subscribers.delete(c)}}isChannelValid(a){return a&&"joined"===a.state}cleanup(){this.channels.forEach(a=>{d.N.removeChannel(a)}),this.channels.clear(),this.subscribers.clear()}constructor(){this.channels=new Map,this.subscribers=new Map}}let f=new e},28395:a=>{"use strict";a.exports=require("lodash/range")},28462:a=>{"use strict";a.exports=import("@tanstack/react-query")},28648:a=>{"use strict";a.exports=require("lodash/max")},33873:a=>{"use strict";a.exports=require("path")},35503:a=>{"use strict";a.exports=require("recharts-scale")},39315:a=>{"use strict";a.exports=require("lodash/isNaN")},40361:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},41415:a=>{"use strict";a.exports=import("sonner")},43411:(a,b,c)=>{"use strict";function d(a){let b="fleet";if(b)return b;if(!a||a.startsWith("127."))return"management";if(a.includes("fleet-koormatics.vercel.app"))return"fleet";if(a.includes("operations-koormatics.vercel.app"))return"operations";if(a.includes("finance-koormatics.vercel.app"))return"finance";if(a.includes("management-koormatics.vercel.app"))return"management";let c=a.split(".")[0]?.toLowerCase();return"fleet"===c||c.startsWith("fleet-")?"fleet":"operations"===c||c.startsWith("operations-")?"operations":"finance"===c||c.startsWith("finance-")?"finance":("management"===c||c.startsWith("management-"),"management")}c.d(b,{r:()=>d})},44184:a=>{"use strict";a.exports=require("lodash/sumBy")},44874:(a,b,c)=>{"use strict";c.d(b,{ah:()=>g,Mx:()=>f,Lg:()=>h});var d=c(95965);let e=a=>a?a.substring(0,8).toUpperCase():"",f=async({title:a,type:b,relatedId:c,tripDetails:d})=>{let f=Date.now().toString(),g=new Date,h=a;if("trip"===b&&c){let b=e(c);h=`Trip ${b} ${a.toLowerCase().includes("created")?"created":"updated"}`}let i={id:f,title:h,timestamp:g.toISOString(),type:b,icon:{trip:"calendar",maintenance:"clock",vehicle:"car",driver:"user",client:"building",fuel:"fuel",contract:"file-check"}[b]||"activity",related_id:c};try{return console.log("Activity logging disabled, returning local activity:",h),i}catch(a){console.error("Failed to log activity to database:",a)}return i},g=async a=>{try{return console.log("Activity logging disabled, returning empty activities list"),[]}catch(a){return console.error("Failed to fetch activities:",a),[]}},h=async(a,b,c)=>{try{let{data:c,error:g}=await d.N.from("trips").select(`
        *,
        clients:client_id(name),
        vehicles:vehicle_id(make, model, registration),
        drivers:driver_id(name)
      `).eq("id",b).single();if(g||!c)return void console.warn("Could not fetch trip details for activity logging");let h=c.clients?.name||"Unknown Client";c.vehicles&&(c.vehicles.make,c.vehicles.model),c.drivers?.name;let i=e(b),j="";switch(a){case"created":j=`New Trip ${i} created`;break;case"updated":j=`Trip ${i} updated`;break;case"assigned":j=`Vehicle assigned to trip ${i}`;break;case"driver_assigned":j=`Driver assigned to trip ${i}`;break;case"completed":j=`Trip ${i} completed`;break;default:j=`Trip ${i} ${a}`}await f({title:j,type:"trip",relatedId:b,tripDetails:{clientName:h,pickupLocation:c.pickup_location,dropoffLocation:c.dropoff_location}})}catch(a){console.error("Error logging trip activity:",a)}}},45315:(a,b,c)=>{"use strict";function d(a){if(!a)return null;try{let b=new Date(a);if(isNaN(b.getTime()))return console.warn("Invalid date string:",a),null;return b}catch(b){return console.warn("Error parsing date:",a,b),null}}function e(a,b){let c=d(a);return!!c&&c.toLocaleString("default",{month:"short"})===b}function f(a){let b=d(a);if(!b)return"Invalid Date";let c=Math.floor((new Date().getTime()-b.getTime())/1e3);if(c<60)return"Just now";if(c<3600)return`${Math.floor(c/60)} minutes ago`;if(c<86400)return`${Math.floor(c/3600)} hours ago`;if(c<2592e3)return`${Math.floor(c/86400)} days ago`;let e=d(a);if(!e)return"Invalid Date";let f={year:"numeric",month:"short",day:"numeric",...void 0};return e.toLocaleDateString("en-US",f)}c.d(b,{Yt:()=>e,gs:()=>f})},46060:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external.js")},48303:a=>{"use strict";a.exports=import("@radix-ui/react-tooltip")},48443:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{I:()=>h});var e=c(28462),f=c(95965),g=a([e]);e=(g.then?(await g)():g)[0];let h=()=>{let{data:a=[],isLoading:b}=(0,e.useQuery)({queryKey:["user_roles"],queryFn:async()=>{let{data:{session:a}}=await f.N.auth.getSession(),b=a?.user.id;if(!b)return[];let c=a?.user.user_metadata||{},d=Array.isArray(c?.koormatics_role)?c.koormatics_role:c?.role?[c.role]:[];if(d.length>0)return d;try{let{data:a,error:c}=await f.N.from("vw_user_roles").select("roles").eq("user_id",b).maybeSingle();if(c)return d;let e=a?.roles||[];return e.length>0?e:d}catch(a){return console.error("Error fetching roles from database:",a),d}},staleTime:6e5,gcTime:18e5,refetchOnWindowFocus:!1,refetchOnMount:!1,retry:1,meta:{timeout:5e3}});return{roles:a,loading:b,hasRole:b=>a.includes(b)}};d()}catch(a){d(a)}})},49673:a=>{"use strict";a.exports=require("lodash/flatMap")},50802:a=>{"use strict";a.exports=import("clsx")},51999:a=>{"use strict";a.exports=require("lodash/isString")},54423:(a,b,c)=>{"use strict";c.d(b,{e:()=>e});var d=c(82015);function e(a){(0,d.useRef)(Date.now());let b=(0,d.useRef)(Date.now());return{markRenderStart:()=>{b.current=Date.now()},markRenderEnd:()=>{Date.now(),b.current}}}},55893:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{O2:()=>i,u8:()=>j});var e=c(8732),f=c(87092),g=a([f]);function h({className:a,...b}){return(0,e.jsx)("div",{className:(0,f.cn)("animate-pulse rounded-md bg-muted",a),...b})}function i(){return(0,e.jsxs)("div",{className:"space-y-6",children:[(0,e.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:Array.from({length:4}).map((a,b)=>(0,e.jsx)("div",{className:"bg-card border border-border p-4 rounded-lg",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(h,{className:"h-4 w-20"}),(0,e.jsx)(h,{className:"h-8 w-16"})]}),(0,e.jsx)(h,{className:"h-8 w-8 rounded-full"})]})},b))}),(0,e.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:Array.from({length:2}).map((a,b)=>(0,e.jsx)("div",{className:"bg-card border border-border p-4 rounded-lg",children:(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsx)(h,{className:"h-6 w-32"}),(0,e.jsx)(h,{className:"h-64 w-full"})]})},b))}),(0,e.jsx)("div",{className:"bg-card border border-border p-4 rounded-lg",children:(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsx)(h,{className:"h-6 w-32"}),(0,e.jsx)("div",{className:"space-y-3",children:Array.from({length:3}).map((a,b)=>(0,e.jsxs)("div",{className:"flex items-center gap-3",children:[(0,e.jsx)(h,{className:"h-3 w-3 rounded-full"}),(0,e.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,e.jsx)(h,{className:"h-3 w-3/4"}),(0,e.jsx)(h,{className:"h-2 w-1/2"})]})]},b))})]})})]})}function j({height:a="h-64"}){return(0,e.jsx)("div",{className:`w-full ${a} flex items-center justify-center`,children:(0,e.jsxs)("div",{className:"animate-pulse space-y-4 w-full",children:[(0,e.jsx)("div",{className:"h-4 bg-muted rounded w-1/4"}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)("div",{className:"h-2 bg-muted rounded"}),(0,e.jsx)("div",{className:"h-2 bg-muted rounded w-5/6"}),(0,e.jsx)("div",{className:"h-2 bg-muted rounded w-4/6"})]})]})})}f=(g.then?(await g)():g)[0],d()}catch(a){d(a)}})},57312:a=>{"use strict";a.exports=import("next-themes")},59501:(a,b,c)=>{a.exports=c(85203)},60133:a=>{"use strict";a.exports=require("lodash/find")},60601:a=>{"use strict";a.exports=require("lodash/isObject")},62546:a=>{"use strict";a.exports=require("victory-vendor/d3-scale")},64030:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{F:()=>h});var e=c(28462),f=c(95965),g=a([e]);function h(){return(0,e.useQuery)({queryKey:["maintenance"],queryFn:async()=>{let{data:a,error:b}=await f.N.from("maintenance").select(`
          *,
          vehicle:vehicles (
            id,
            make,
            model,
            registration
          )
        `).order("date",{ascending:!1});if(b)throw b;return(a||[]).map(a=>({...a,status:a.status||"scheduled",cost:a.cost||0}))},staleTime:3e5,gcTime:6e5,refetchOnWindowFocus:!1})}e=(g.then?(await g)():g)[0],d()}catch(a){d(a)}})},64813:a=>{"use strict";a.exports=require("lodash/isPlainObject")},66770:a=>{"use strict";a.exports=require("lodash/throttle")},69826:a=>{"use strict";a.exports=require("lodash/memoize")},71247:a=>{"use strict";a.exports=require("lodash/isNumber")},74956:a=>{"use strict";a.exports=require("clsx")},75979:a=>{"use strict";a.exports=import("tailwind-merge")},76684:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{default:()=>t});var e=c(8732),f=c(82015),g=c(77067),h=c(28462),i=c(27207);c(27962),c(44874);var j=c(59501),k=c.n(j),l=c(78351),m=c(64030),n=c(95965),o=c(55893),p=c(54423),q=c(66345),r=c(74952),s=a([h,i,m,o,q]);[h,i,m,o,q]=s.then?(await s)():s;let u=k()(()=>Promise.all([c.e(2410),c.e(7838)]).then(c.bind(c,37838)).then(a=>a.FuelConsumptionChart),{loadableGenerated:{modules:["pages\\Dashboard.tsx -> @/components/dashboard/charts/FuelConsumptionChart"]},ssr:!1}),v=k()(()=>Promise.all([c.e(2410),c.e(9404)]).then(c.bind(c,79404)).then(a=>a.MaintenanceCostsChart),{loadableGenerated:{modules:["pages\\Dashboard.tsx -> @/components/dashboard/charts/MaintenanceCostsChart"]},ssr:!1}),w=k()(()=>c.e(9888).then(c.bind(c,87507)).then(a=>a.PerformanceMetricsChart),{loadableGenerated:{modules:["pages\\Dashboard.tsx -> @/components/dashboard/charts/PerformanceMetricsChart"]},ssr:!1,loading:()=>(0,e.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,e.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"})})});function t(){let[a,b]=(0,f.useState)(!1);(0,h.useQueryClient)();let{domain:c,isAllowed:d,loading:j}=(0,i.E)(),[k,s]=(0,f.useState)([]),{markRenderStart:t,markRenderEnd:x}=(0,p.e)("Dashboard"),{data:y=[],isLoading:z}=(0,m.F)(),{data:A=[],isLoading:B}=(0,h.useQuery)({queryKey:["vehicles"],queryFn:async()=>{let{data:a,error:b}=await n.N.from("vehicles").select("id, make, model, registration, status, created_at");if(b)throw b;return a||[]},staleTime:9e5,gcTime:18e5,refetchOnMount:!1,refetchOnWindowFocus:!1}),{data:C=[],isLoading:D}=(0,h.useQuery)({queryKey:["drivers"],queryFn:async()=>{let{data:a,error:b}=await n.N.from("drivers").select("id, name, status, created_at");if(b)throw b;return a||[]},staleTime:9e5,gcTime:18e5,refetchOnMount:!1,refetchOnWindowFocus:!1}),{data:E=[],isLoading:F}=(0,h.useQuery)({queryKey:["fuel_logs"],queryFn:async()=>{let{data:a,error:b}=await n.N.from("fuel_logs").select("id, date, volume, cost, fuel_type, vehicle_id, created_at");if(b)throw b;return a||[]},staleTime:9e5,gcTime:18e5,refetchOnMount:!1,refetchOnWindowFocus:!1}),G=(0,l.D)(A,C,y,E),H=A?.length||0,I=C?.filter(a=>"active"===a.status)?.length||0,J=C?.length||0,K=y?.filter(a=>"scheduled"===a.status)?.length||0,L=E?.length||0,M=H>0?Math.round(I/H*100):0;return!a||B||D||F||z?(0,e.jsx)(o.O2,{}):d?(0,e.jsx)("div",{className:"min-h-screen bg-background",children:(0,e.jsxs)("div",{className:"p-4 px-6 space-y-6",children:[(0,e.jsx)("div",{className:"border-b border-border pb-4 pt-4",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsx)("div",{children:(0,e.jsx)("h1",{className:"text-2xl font-semibold text-foreground",children:"Dashboard"})}),(0,e.jsx)("div",{className:"text-sm text-muted-foreground",children:new Date().toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})})]})}),(0,e.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,e.jsx)("div",{className:"bg-card border border-border p-4",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm text-muted-foreground",children:"Vehicles"}),(0,e.jsx)("p",{className:"text-2xl font-semibold text-foreground",children:H})]}),(0,e.jsx)(r.THT,{className:"h-5 w-5 text-muted-foreground"})]})}),(0,e.jsx)("div",{className:"bg-card border border-border p-4",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm text-muted-foreground",children:"Drivers"}),(0,e.jsxs)("p",{className:"text-2xl font-semibold text-foreground",children:[I,"/",J]})]}),(0,e.jsx)(r.zWC,{className:"h-5 w-5 text-muted-foreground"})]})}),(0,e.jsx)("div",{className:"bg-card border border-border p-4",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm text-muted-foreground",children:"Maintenance"}),(0,e.jsx)("p",{className:"text-2xl font-semibold text-foreground",children:K})]}),(0,e.jsx)(r.IFY,{className:"h-5 w-5 text-muted-foreground"})]})}),(0,e.jsx)("div",{className:"bg-card border border-border p-4",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm text-muted-foreground",children:"Fuel Logs"}),(0,e.jsx)("p",{className:"text-2xl font-semibold text-foreground",children:L})]}),(0,e.jsx)(r.XHo,{className:"h-5 w-5 text-muted-foreground"})]})})]}),(0,e.jsxs)("div",{className:"grid gap-6 lg:grid-cols-12",children:[(0,e.jsx)("section",{className:"lg:col-span-8 space-y-6",children:(0,e.jsxs)("div",{className:"space-y-6",children:[(0,e.jsxs)("div",{className:"bg-card border border-border p-4",children:[(0,e.jsx)("h3",{className:"text-sm font-medium text-foreground mb-4",children:"Fuel Consumption"}),(0,e.jsx)("div",{className:"h-[300px] w-full",children:(0,e.jsx)(g.aB,{fallback:(0,e.jsx)(o.u8,{height:"h-[300px]"}),children:(0,e.jsx)(u,{data:G?.fuelConsumptionData||[],compact:!0})})})]}),(0,e.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,e.jsxs)("div",{className:"bg-card border border-border p-4",children:[(0,e.jsx)("h3",{className:"text-sm font-medium text-foreground mb-4",children:"Maintenance Costs"}),(0,e.jsx)("div",{className:"h-[250px] w-full",children:(0,e.jsx)(g.aB,{fallback:(0,e.jsx)(o.u8,{height:"h-[250px]"}),children:(0,e.jsx)(v,{data:G?.maintenanceCostsData||[],compact:!0})})})]}),(0,e.jsxs)("div",{className:"bg-card border border-border p-4",children:[(0,e.jsx)("h3",{className:"text-sm font-medium text-foreground mb-4",children:"Fleet Utilization"}),(0,e.jsx)("div",{className:"h-[250px] w-full",children:(0,e.jsx)(w,{data:[{name:"Fleet Utilization",value:M,color:M>=80?"#10b981":M>=60?"#f59e0b":"#ef4444"}],compact:!0})})]})]})]})}),(0,e.jsxs)("aside",{className:"lg:col-span-4 space-y-6",children:[(0,e.jsxs)("div",{className:"bg-card border border-border p-4",children:[(0,e.jsx)("h3",{className:"text-sm font-medium text-foreground mb-4",children:"Recent Activity"}),(0,e.jsx)("div",{children:(0,e.jsx)(g.aB,{children:(0,e.jsx)(g.j3,{activities:k,isLoading:!1})})})]}),(0,e.jsxs)("div",{className:"bg-card border border-border p-4",children:[(0,e.jsx)("h3",{className:"text-sm font-medium text-foreground mb-4",children:"Quick Actions"}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(q.$,{variant:"outline",className:"w-full justify-start text-sm",size:"sm",children:"Add Vehicle"}),(0,e.jsx)(q.$,{variant:"outline",className:"w-full justify-start text-sm",size:"sm",children:"Add Driver"}),(0,e.jsx)(q.$,{variant:"outline",className:"w-full justify-start text-sm",size:"sm",children:"Schedule Maintenance"})]})]})]})]})]})}):(0,e.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,e.jsxs)("div",{className:"text-center",children:[(0,e.jsx)("h1",{className:"text-2xl font-bold text-destructive mb-4",children:"Access Denied"}),(0,e.jsx)("p",{className:"text-muted-foreground",children:"You don't have permission to access this tenant."})]})})}d()}catch(a){d(a)}})},77067:(a,b,c)=>{"use strict";c.d(b,{aB:()=>h,j3:()=>i});var d=c(8732),e=c(82015),f=c(74952);let g=()=>(0,d.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,d.jsx)(f.krw,{className:"h-6 w-6 animate-spin"})});function h({children:a,fallback:b=(0,d.jsx)(g,{})}){return(0,d.jsx)(e.Suspense,{fallback:b,children:a})}let i=(0,e.lazy)(()=>c.e(2953).then(c.bind(c,72953)).then(a=>({default:a.RecentActivity})))},78351:(a,b,c)=>{"use strict";c.d(b,{D:()=>f});var d=c(82015),e=c(45315);function f(a=[],b=[],c=[],g=[]){console.log("\uD83D\uDD0D useDashboardChartsData called with:",{vehicles:a.length,drivers:b.length,maintenanceData:c.length,fuelLogsData:g.length});let h=(0,d.useMemo)(()=>{console.log("\uD83D\uDD04 Processing chart data...");let d=a=>{let b=Number(a);return isNaN(b)?0:b};if(0===a.length&&0===b.length&&0===c.length&&0===g.length)return console.log("\uD83D\uDCCA No data available, returning empty data"),{monthlyData:[],fuelConsumptionData:[],fleetDistributionData:[],driverStatusData:[],maintenanceCostData:[],maintenanceCostsData:[],fuelCostData:[]};console.log("\uD83D\uDD04 Processing real data...");let f=Array.from({length:6},(a,b)=>{let c=new Date;return c.setMonth(c.getMonth()-b),c.toLocaleString("default",{month:"short"})}).reverse(),h=f.map(b=>({month:b,vehicles:a.length,maintenance:0,revenue:0,costs:0,profit:0})),i=g.length>0?f.map(a=>{let b=g.filter(b=>!!b.date&&(0,e.Yt)(b.date,a)),c=b.reduce((a,b)=>a+d(b.volume),0);return{date:a,consumption:Math.max(0,Math.round(c)),efficiency:b.length>0?Math.round(c/b.length):0}}):[],j=a.length>0?(()=>{let b=Array.from(new Set(a.map(a=>a.type||a.vehicle_type||"Unknown").filter(Boolean))),c=["#10B981","#3B82F6","#8B5CF6","#F97316","#EF4444","#EC4899"];return b.map((b,d)=>({name:b,value:a.filter(a=>(a.type||a.vehicle_type)===b).length,color:c[d%c.length]}))})():[],k=b.length>0?Array.from(new Set(b.map(a=>a.status||"unknown").filter(Boolean))).map(a=>({name:"active"===a?"Active":"on_leave"===a?"On Leave":"inactive"===a?"Inactive":a,value:b.filter(b=>(b.status||"unknown")===a).length,color:"active"===a?"#10B981":"on_leave"===a?"#F97316":"#EF4444"})):[],l=c.length>0?f.map(a=>{let b=c.filter(b=>{if(!b.date)return!1;try{return new Date(b.date).toLocaleString("default",{month:"short"})===a}catch(a){return console.warn("Invalid date in maintenance:",b.date),!1}}),e=b.filter(a=>(a.description||"").toLowerCase().includes("service")).reduce((a,b)=>a+d(b.cost),0),f=b.filter(a=>!(a.description||"").toLowerCase().includes("service")).reduce((a,b)=>a+d(b.cost),0);return{month:a,service:Math.max(0,Math.round(e)),repairs:Math.max(0,Math.round(f)),total:Math.max(0,Math.round(e+f))}}):[],m={monthlyData:h,fuelConsumptionData:i,fleetDistributionData:j,driverStatusData:k,maintenanceCostData:l,maintenanceCostsData:c.length>0?f.map(a=>{let b=c.filter(b=>!!b.date&&(0,e.Yt)(b.date,a)).reduce((a,b)=>a+d(b.cost),0);return{month:a,cost:Math.max(0,Math.round(b))}}):[],fuelCostData:g.length>0?f.map(a=>{let b=g.filter(b=>!!b.date&&(0,e.Yt)(b.date,a)),c=b.filter(a=>"diesel"===(a.fuel_type||"").toLowerCase()).reduce((a,b)=>a+d(b.cost),0),f=b.filter(a=>"petrol"===(a.fuel_type||"").toLowerCase()).reduce((a,b)=>a+d(b.cost),0);return{month:a,diesel:Math.max(0,Math.round(c)),petrol:Math.max(0,Math.round(f)),total:Math.max(0,Math.round(c+f))}}):[]};return console.log("\uD83D\uDCCA Chart data hook returning:",m),m},[a,b,c,g]);return console.log("\uD83C\uDFAF useDashboardChartsData final return:",h),h}},78894:a=>{"use strict";a.exports=require("lodash/isEqual")},82015:a=>{"use strict";a.exports=require("react")},84106:a=>{"use strict";a.exports=require("lodash/get")},85106:a=>{"use strict";a.exports=require("lodash/min")},85203:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{default:function(){return i},noSSR:function(){return h}});let d=c(35423),e=c(8732);c(82015);let f=d._(c(22729));function g(a){return{default:(null==a?void 0:a.default)||a}}function h(a,b){delete b.webpack,delete b.modules;let c=b.loading;return()=>(0,e.jsx)(c,{error:null,isLoading:!0,pastDelay:!1,timedOut:!1})}function i(a,b){let c=f.default,d={loading:a=>{let{error:b,isLoading:c,pastDelay:d}=a;return null}};a instanceof Promise?d.loader=()=>a:"function"==typeof a?d.loader=a:"object"==typeof a&&(d={...d,...a});let e=(d={...d,...b}).loader;return(d.loadableGenerated&&(d={...d,...d.loadableGenerated},delete d.loadableGenerated),"boolean"!=typeof d.ssr||d.ssr)?c({...d,loader:()=>null!=e?e().then(g):Promise.resolve(g(()=>null))}):(delete d.webpack,delete d.modules,h(c,d))}("function"==typeof b.default||"object"==typeof b.default&&null!==b.default)&&void 0===b.default.__esModule&&(Object.defineProperty(b.default,"__esModule",{value:!0}),Object.assign(b.default,b),a.exports=b.default)},89947:a=>{"use strict";a.exports=require("lodash/omit")},90030:a=>{"use strict";a.exports=require("lodash/some")},90599:a=>{"use strict";a.exports=require("lodash/minBy")},91651:a=>{"use strict";a.exports=require("tiny-invariant")},92654:a=>{"use strict";a.exports=require("lodash/last")},93939:a=>{"use strict";a.exports=require("@supabase/supabase-js")},95009:a=>{"use strict";a.exports=require("lodash/isNil")},96186:a=>{"use strict";a.exports=require("lodash/uniqBy")}};var b=require("../webpack-runtime.js");b.C(a);var c=b.X(0,[4952,5611,5781,4780],()=>b(b.s=18989));module.exports=c})();