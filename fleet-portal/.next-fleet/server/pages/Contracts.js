"use strict";(()=>{var a={};a.id=2905,a.ids=[636,2905,3220],a.modules={8732:a=>{a.exports=require("react/jsx-runtime")},8938:a=>{a.exports=import("class-variance-authority")},9640:a=>{a.exports=import("@radix-ui/react-slot")},10493:(a,b,c)=>{c.d(b,{p:()=>e});var d=c(21638);function e(a){let b=(0,d.a)(a),c=b.getMonth();return b.setFullYear(b.getFullYear(),c+1,0),b.setHours(23,59,59,999),b}},13020:a=>{a.exports=import("@radix-ui/react-dialog")},14505:a=>{a.exports=import("@radix-ui/react-scroll-area")},16235:a=>{a.exports=import("@radix-ui/react-toast")},16780:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{A:()=>p});var e=c(8732);c(82015);var f=c(38661),g=c(66345),h=c(78059),i=c(40273),j=c(74952),k=c(52670),l=c(71913),m=c(81575),n=c(57049),o=a([f,g,h,i,k,n]);[f,g,h,i,k,n]=o.then?(await o)():o;let p=({open:a,onOpenChange:b,formData:c,selectedContract:d,handleInputChange:o,handleFileChange:p,handleSubmit:q,isPending:r,isStorageAvailable:s=!0,onDownload:t})=>{let u=a=>b=>{let c=b?(0,l.GP)(b,"yyyy-MM-dd"):"";o({target:{name:a,value:c}})};return(0,e.jsx)(f.lG,{open:a,onOpenChange:b,children:(0,e.jsxs)(f.Cf,{className:"sm:max-w-[600px]",children:[(0,e.jsxs)(f.c7,{children:[(0,e.jsx)(f.L3,{className:"text-xl",children:"Edit Contract"}),(0,e.jsx)(f.rr,{children:"Update contract details and upload new document if needed."})]}),(0,e.jsxs)("form",{onSubmit:q,className:"space-y-6",children:[(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsxs)("div",{className:"grid gap-2",children:[(0,e.jsx)(i.J,{htmlFor:"edit-name",className:"text-base font-medium",children:"Contract Name"}),(0,e.jsx)(h.p,{id:"edit-name",name:"name",value:c.name,onChange:o,className:"h-11",required:!0,placeholder:"Enter contract name"})]}),(0,e.jsxs)("div",{className:"grid gap-2",children:[(0,e.jsx)(i.J,{htmlFor:"edit-client_name",className:"text-base font-medium",children:"Client"}),(0,e.jsx)(h.p,{id:"edit-client_name",name:"client_name",value:c.client_name,onChange:o,className:"h-11",required:!0,placeholder:"Enter client name"})]}),(0,e.jsxs)("div",{className:"grid gap-2",children:[(0,e.jsx)(i.J,{htmlFor:"edit-status",className:"text-base font-medium",children:"Status"}),(0,e.jsxs)(n.l6,{value:c.status,onValueChange:a=>{o({target:{name:"status",value:a}})},required:!0,children:[(0,e.jsx)(n.bq,{id:"edit-status",className:"h-11",children:(0,e.jsx)(n.yv,{placeholder:"Select a status"})}),(0,e.jsxs)(n.gC,{children:[(0,e.jsx)(n.eb,{value:"active",children:"Active"}),(0,e.jsx)(n.eb,{value:"pending",children:"Pending"}),(0,e.jsx)(n.eb,{value:"expired",children:"Expired"}),(0,e.jsx)(n.eb,{value:"terminated",children:"Terminated"})]})]})]}),(0,e.jsxs)("div",{className:"grid gap-2",children:[(0,e.jsx)(i.J,{htmlFor:"edit-start_date",className:"text-base font-medium",children:"Start Date"}),(0,e.jsx)(k.l,{date:c.start_date?(0,m.H)(c.start_date):void 0,onDateChange:u("start_date"),className:"h-11"})]}),(0,e.jsxs)("div",{className:"grid gap-2",children:[(0,e.jsx)(i.J,{htmlFor:"edit-end_date",className:"text-base font-medium",children:"End Date"}),(0,e.jsx)(k.l,{date:c.end_date?(0,m.H)(c.end_date):void 0,onDateChange:u("end_date"),className:"h-11"})]}),(0,e.jsxs)("div",{className:"grid gap-2",children:[(0,e.jsx)(i.J,{htmlFor:"edit-contract_file",className:"text-base font-medium",children:"Upload New File"}),s?(0,e.jsxs)("div",{className:"border border-input rounded-md p-2",children:[(0,e.jsx)(h.p,{id:"edit-contract_file",name:"contract_file",type:"file",onChange:p,className:"w-full h-11 border-0",accept:".pdf,.doc,.docx"}),(0,e.jsxs)("p",{className:"text-xs text-muted-foreground mt-1 ml-1",children:[(0,e.jsx)(j.iUU,{className:"inline h-3 w-3 mr-1"}),"Accepted formats: PDF, DOC, DOCX (Max 10MB)"]})]}):(0,e.jsxs)("div",{className:"flex items-center text-amber-500 text-sm p-3 bg-amber-50 rounded-md",children:[(0,e.jsx)(j.hcu,{className:"h-4 w-4 mr-2"}),"File upload is currently unavailable"]})]}),d?.contract_file&&(0,e.jsxs)("div",{className:"grid gap-2",children:[(0,e.jsx)(i.J,{className:"text-base font-medium",children:"Current File"}),(0,e.jsxs)("div",{className:"flex items-center p-3 bg-gray-50 rounded-md",children:[(0,e.jsx)(j.iUU,{className:"h-5 w-5 mr-2 text-blue-500"}),(0,e.jsx)("span",{className:"text-sm text-muted-foreground mr-3",children:"A file is already attached"}),t&&s&&(0,e.jsxs)(g.$,{type:"button",variant:"outline",size:"sm",onClick:()=>{d&&t&&t(d)},className:"ml-auto",title:"Download contract file",children:[(0,e.jsx)(j.f5X,{className:"h-4 w-4 mr-1"}),"Download"]})]})]})]}),(0,e.jsxs)(f.Es,{className:"pt-2 gap-2",children:[(0,e.jsx)(g.$,{variant:"outline",type:"button",onClick:()=>b(!1),className:"h-11",children:"Cancel"}),(0,e.jsx)(g.$,{type:"submit",disabled:r,className:"h-11",children:r?"Updating...":"Update Contract"})]})]})]})})};d()}catch(a){d(a)}})},17156:(a,b,c)=>{c.d(b,{Y:()=>e});var d=c(21638);function e(a,b){return+(0,d.a)(a)<+(0,d.a)(b)}},19640:a=>{a.exports=import("@radix-ui/react-tabs")},20598:a=>{a.exports=import("@radix-ui/react-label")},21839:(a,b,c)=>{c.d(b,{f:()=>f});var d=c(21638),e=c(68794);function f(a,b){let c=(0,d.a)(a);return isNaN(b)?(0,e.w)(a,NaN):(b&&c.setDate(c.getDate()+b),c)}},28462:a=>{a.exports=import("@tanstack/react-query")},31139:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{A:()=>p});var e=c(8732);c(82015);var f=c(38661),g=c(66345),h=c(78059),i=c(40273),j=c(74952),k=c(52670),l=c(71913),m=c(81575),n=c(57049),o=a([f,g,h,i,k,n]);[f,g,h,i,k,n]=o.then?(await o)():o;let p=({open:a,onOpenChange:b,formData:c,handleInputChange:d,handleFileChange:o,handleSubmit:p,isPending:q,isStorageAvailable:r=!0})=>{let s=a=>b=>{let c=b?(0,l.GP)(b,"yyyy-MM-dd"):"";d({target:{name:a,value:c}})};return(0,e.jsx)(f.lG,{open:a,onOpenChange:b,children:(0,e.jsxs)(f.Cf,{className:"sm:max-w-[600px]",children:[(0,e.jsxs)(f.c7,{children:[(0,e.jsx)(f.L3,{className:"text-xl",children:"Add New Contract"}),(0,e.jsx)(f.rr,{children:"Enter contract details and upload a document file."})]}),(0,e.jsxs)("form",{onSubmit:p,className:"space-y-6",children:[(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsxs)("div",{className:"grid gap-2",children:[(0,e.jsx)(i.J,{htmlFor:"name",className:"text-base font-medium",children:"Contract Name"}),(0,e.jsx)(h.p,{id:"name",name:"name",value:c.name,onChange:d,className:"h-11",required:!0,placeholder:"Enter contract name"})]}),(0,e.jsxs)("div",{className:"grid gap-2",children:[(0,e.jsx)(i.J,{htmlFor:"client_name",className:"text-base font-medium",children:"Client"}),(0,e.jsx)(h.p,{id:"client_name",name:"client_name",value:c.client_name,onChange:d,className:"h-11",required:!0,placeholder:"Enter client name"})]}),(0,e.jsxs)("div",{className:"grid gap-2",children:[(0,e.jsx)(i.J,{htmlFor:"status",className:"text-base font-medium",children:"Status"}),(0,e.jsxs)(n.l6,{value:c.status,onValueChange:a=>{d({target:{name:"status",value:a}})},required:!0,children:[(0,e.jsx)(n.bq,{id:"status",className:"h-11",children:(0,e.jsx)(n.yv,{placeholder:"Select a status"})}),(0,e.jsxs)(n.gC,{children:[(0,e.jsx)(n.eb,{value:"active",children:"Active"}),(0,e.jsx)(n.eb,{value:"pending",children:"Pending"}),(0,e.jsx)(n.eb,{value:"expired",children:"Expired"}),(0,e.jsx)(n.eb,{value:"terminated",children:"Terminated"})]})]})]}),(0,e.jsxs)("div",{className:"grid gap-2",children:[(0,e.jsx)(i.J,{htmlFor:"start_date",className:"text-base font-medium",children:"Start Date"}),(0,e.jsx)(k.l,{date:c.start_date?(0,m.H)(c.start_date):void 0,onDateChange:s("start_date"),className:"h-11"})]}),(0,e.jsxs)("div",{className:"grid gap-2",children:[(0,e.jsx)(i.J,{htmlFor:"end_date",className:"text-base font-medium",children:"End Date"}),(0,e.jsx)(k.l,{date:c.end_date?(0,m.H)(c.end_date):void 0,onDateChange:s("end_date"),className:"h-11"})]}),(0,e.jsxs)("div",{className:"grid gap-2",children:[(0,e.jsx)(i.J,{htmlFor:"contract_file",className:"text-base font-medium",children:"Upload File"}),r?(0,e.jsxs)("div",{className:"border border-input rounded-md p-2",children:[(0,e.jsx)(h.p,{id:"contract_file",name:"contract_file",type:"file",onChange:o,className:"w-full h-11 border-0",accept:".pdf,.doc,.docx"}),(0,e.jsxs)("p",{className:"text-xs text-muted-foreground mt-1 ml-1",children:[(0,e.jsx)(j.iUU,{className:"inline h-3 w-3 mr-1"}),"Accepted formats: PDF, DOC, DOCX (Max 10MB)"]})]}):(0,e.jsxs)("div",{className:"flex items-center text-amber-500 text-sm p-3 bg-amber-50 rounded-md",children:[(0,e.jsx)(j.hcu,{className:"h-4 w-4 mr-2"}),"File upload is currently unavailable"]})]})]}),(0,e.jsxs)(f.Es,{className:"pt-2 gap-2",children:[(0,e.jsx)(g.$,{variant:"outline",type:"button",onClick:()=>b(!1),className:"h-11",children:"Cancel"}),(0,e.jsx)(g.$,{type:"submit",disabled:q,className:"h-11",children:q?"Saving...":"Save Contract"})]})]})]})})};d()}catch(a){d(a)}})},33873:a=>{a.exports=require("path")},39655:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{BT:()=>l,Wu:()=>m,ZB:()=>k,Zp:()=>i,aR:()=>j,wL:()=>n});var e=c(8732),f=c(82015),g=c(87092),h=a([g]);g=(h.then?(await h)():h)[0];let i=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("div",{ref:c,className:(0,g.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...b}));i.displayName="Card";let j=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("div",{ref:c,className:(0,g.cn)("flex flex-col space-y-1.5 p-6",a),...b}));j.displayName="CardHeader";let k=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("h3",{ref:c,className:(0,g.cn)("text-2xl font-semibold leading-none tracking-tight",a),...b}));k.displayName="CardTitle";let l=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("p",{ref:c,className:(0,g.cn)("text-sm text-muted-foreground",a),...b}));l.displayName="CardDescription";let m=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("div",{ref:c,className:(0,g.cn)("p-6 pt-0",a),...b}));m.displayName="CardContent";let n=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("div",{ref:c,className:(0,g.cn)("flex items-center p-6 pt-0",a),...b}));n.displayName="CardFooter",d()}catch(a){d(a)}})},40361:a=>{a.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},41415:a=>{a.exports=import("sonner")},46060:a=>{a.exports=require("next/dist/shared/lib/no-fallback-error.external.js")},47860:a=>{a.exports=import("@radix-ui/react-select")},48303:a=>{a.exports=import("@radix-ui/react-tooltip")},50802:a=>{a.exports=import("clsx")},53139:(a,b,c)=>{c.d(b,{IH:()=>i,aT:()=>f,n1:()=>j,qB:()=>g,yp:()=>h});var d=c(95965);let e=async()=>{try{console.log("Creating contracts directory in documents bucket");let{error:a}=await d.N.storage.from("documents").upload("contracts/.folder",new Blob([""],{type:"text/plain"}),{contentType:"text/plain",upsert:!0});if(a&&!a.message.includes("already exists"))return console.warn("Could not create contracts folder:",a),!1;return console.log("Contracts directory created or verified successfully"),!0}catch(a){return console.error("Failed to create contracts directory:",a),!1}},f=async()=>{let{data:a,error:b}=await d.N.from("contracts").select("*").order("created_at",{ascending:!1});if(b)throw console.error("Error fetching contracts:",b),b;return a},g=async(a,b)=>{if(!a.name||!a.client_name||!a.status||!a.start_date||!a.end_date)throw Error("Missing required fields");let c=a.status,f={name:a.name,client_name:a.client_name,status:c,start_date:a.start_date,end_date:a.end_date,created_at:new Date().toISOString(),contract_number:(()=>{let a=new Date,b=a.getFullYear().toString().slice(-2),c=String(a.getMonth()+1).padStart(2,"0"),d=String(a.getDate()).padStart(2,"0"),e=Math.floor(1e3+9e3*Math.random());return`C${b}${c}${d}-${e}`})()};console.log("Inserting contract data:",f);let{data:g,error:h}=await d.N.from("contracts").insert(f).select().single();if(h)throw console.error("Error inserting contract:",h),h;if(b&&g&&"id"in g)try{if(b.size>0xa00000)throw Error("File size exceeds 10MB limit");await e()||console.warn("Could not create contracts directory, will attempt upload anyway");let a=b.name.split(".").pop()||"pdf",c=`${g.id}.${a}`,f=`contracts/${c}`;console.log("Uploading file:",f,"Type:",b.type,"Size:",b.size);let{error:h,data:i}=await d.N.storage.from("documents").upload(f,b,{upsert:!0,contentType:b.type||"application/octet-stream"});if(h)throw console.error("File upload error:",h),h;console.log("File uploaded successfully:",i);let{error:j}=await d.N.from("contracts").update({contract_file:f}).eq("id",g.id);if(j)throw console.error("Error updating contract with file path:",j),j}catch(a){console.error("Exception during file upload:",a)}return g},h=async(a,b,c)=>{if(!a)throw Error("No contract selected");console.log("Updating contract:",a,b),b.status&&(b.status=b.status);let{data:f,error:g}=await d.N.from("contracts").update(b).eq("id",a).select().single();if(g)throw console.error("Error updating contract data:",g),g;if(c)try{if(c.size>0xa00000)throw Error("File size exceeds 10MB limit");await e()||console.warn("Could not create contracts directory, will attempt upload anyway");let b=c.name.split(".").pop()||"pdf",g=`${a}.${b}`,h=`contracts/${g}`;console.log("Uploading new file for contract:",h,"File type:",c.type,"Size:",c.size);let{error:i,data:j}=await d.N.storage.from("documents").upload(h,c,{upsert:!0,contentType:c.type||"application/octet-stream"});if(i)throw console.error("File upload error during update:",i),i;if(console.log("File uploaded successfully during update:",j),f&&"contract_file"in f&&f.contract_file!==h){let{error:b}=await d.N.from("contracts").update({contract_file:h}).eq("id",a);if(b)throw console.error("Error updating contract with new file path:",b),b}}catch(a){throw console.error("Exception during file update:",a),a}return f},i=async a=>{let{data:b,error:c}=await d.N.from("contracts").select("contract_file").eq("id",a).single();if(c)throw console.error("Error fetching contract for deletion:",c),c;let{error:e}=await d.N.from("contracts").delete().eq("id",a);if(e)throw console.error("Error deleting contract:",e),e;if(b&&"contract_file"in b&&b.contract_file)try{let{error:a}=await d.N.storage.from("documents").remove([b.contract_file]);a&&console.error("Error deleting file:",a)}catch(a){console.error("Exception during file deletion:",a)}return a},j=async a=>{if(!a.contract_file)throw Error("No file available");console.log("Downloading file:",a.contract_file);let{data:b,error:c}=await d.N.storage.from("documents").download(a.contract_file);if(c)throw console.error("Error downloading file:",c),c;return b}},55599:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{default:()=>w});var e=c(8732),f=c(82015),g=c(74952),h=c(66345),i=c(78059),j=c(39655),k=c(68953),l=c(4720),m=c(57049),n=c(76569),o=c(28462),p=c(82020),q=c(85489),r=c(31139),s=c(16780),t=c(53139),u=c(54269);c(95965);var v=a([h,i,j,k,l,m,o,p,q,r,s,u]);function w(){let[a,b]=(0,f.useState)(""),[c,d]=(0,f.useState)("all"),[v,w]=(0,f.useState)("created_at"),[x,y]=(0,f.useState)("desc"),[z,A]=(0,f.useState)("table"),[B,C]=(0,f.useState)(!1),[D,E]=(0,f.useState)(!1),[F,G]=(0,f.useState)(null),[H,I]=(0,f.useState)({name:"",client_name:"",status:"pending",start_date:"",end_date:""}),[J,K]=(0,f.useState)(null),[L,M]=(0,f.useState)(!0),[N,O]=(0,f.useState)(null),{toast:P}=(0,n.dj)(),Q=(0,o.useQueryClient)(),{data:R=[],isLoading:S,isError:T}=(0,o.useQuery)({queryKey:["contracts"],queryFn:t.aT});R.length,R.filter(a=>"active"===a.status).length,R.filter(a=>"pending"===a.status).length,R.filter(a=>"expired"===a.status).length,R.filter(a=>"terminated"===a.status).length,R.filter(a=>{if("active"!==a.status)return!1;let b=new Date(a.end_date),c=new Date,d=b.getTime()-c.getTime(),e=Math.ceil(d/864e5);return e<=30&&e>0}).length;let U=(0,o.useMutation)({mutationFn:async a=>(0,t.qB)(a,J),onSuccess:()=>{Q.invalidateQueries({queryKey:["contracts"]}),P({title:"Contract added successfully",description:"The new contract has been added to the system."}),Z(),C(!1)},onError:a=>{console.error("Error adding contract:",a),P({title:"Failed to add contract",description:a instanceof Error?a.message:"An unknown error occurred",variant:"destructive"})}}),V=(0,o.useMutation)({mutationFn:async a=>{if(!F?.id)throw Error("No contract selected");return(0,t.yp)(F.id,a,J)},onSuccess:()=>{Q.invalidateQueries({queryKey:["contracts"]}),P({title:"Contract updated successfully",description:"The contract details have been updated."}),Z(),E(!1)},onError:a=>{console.error("Error updating contract:",a),P({title:"Failed to update contract",description:a instanceof Error?a.message:"An unknown error occurred",variant:"destructive"})}}),W=(0,o.useMutation)({mutationFn:t.IH,onSuccess:()=>{Q.invalidateQueries({queryKey:["contracts"]}),P({title:"Contract deleted",description:"The contract has been removed from the system."})},onError:a=>{console.error("Error deleting contract:",a),P({title:"Failed to delete contract",description:a instanceof Error?a.message:"An unknown error occurred",variant:"destructive"})}}),X=async a=>{try{let b=await (0,t.n1)(a),c=URL.createObjectURL(b),d=document.createElement("a");d.href=c,d.download=a.contract_file?.split("/").pop()||"contract",document.body.appendChild(d),d.click(),URL.revokeObjectURL(c),document.body.removeChild(d),P({title:"Download started",description:"The contract file is being downloaded."})}catch(a){console.error("Error downloading file:",a),P({title:"Download failed",description:"Failed to download the contract file.",variant:"destructive"})}},Y=async()=>{try{let a=["Name,Client,Status,Start Date,End Date,Created Date,Has File",...ac.map(a=>[`"${a.name}"`,`"${a.client_name}"`,a.status,a.start_date,a.end_date,a.created_at,a.contract_file?"Yes":"No"].join(","))].join("\n"),b=new Blob([a],{type:"text/csv"}),c=window.URL.createObjectURL(b),d=document.createElement("a");d.href=c,d.download=`contracts-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(c),P({title:"Export completed",description:`${ac.length} contracts exported successfully.`})}catch(a){console.error("Error exporting contracts:",a),P({title:"Export failed",description:"Failed to export contracts. Please try again.",variant:"destructive"})}},Z=()=>{I({name:"",client_name:"",status:"pending",start_date:"",end_date:""}),K(null),G(null)},$=a=>{let{name:b,value:c}=a.target;I(a=>({...a,[b]:c}))},_=a=>{a.target.files&&a.target.files[0]&&K(a.target.files[0])},aa=a=>{G(a),I({name:a.name,client_name:a.client_name,status:a.status,start_date:a.start_date,end_date:a.end_date}),E(!0)},ab=a=>{window.confirm(`Are you sure you want to delete the contract "${a.name}"?`)&&W.mutate(a.id)},ac=R.filter(b=>{let d=b.name.toLowerCase().includes(a.toLowerCase())||b.client_name.toLowerCase().includes(a.toLowerCase()),e="all"===c||b.status===c;return d&&e}).sort((a,b)=>{let c=0;switch(v){case"name":c=a.name.localeCompare(b.name);break;case"client_name":c=a.client_name.localeCompare(b.client_name);break;case"start_date":c=new Date(a.start_date).getTime()-new Date(b.start_date).getTime();break;case"end_date":c=new Date(a.end_date).getTime()-new Date(b.end_date).getTime();break;case"created_at":c=new Date(a.created_at).getTime()-new Date(b.created_at).getTime();break;default:c=0}return"desc"===x?-c:c}),ad=ac.filter(a=>"active"===a.status),ae=ac.filter(a=>"pending"===a.status),af=ac.filter(a=>"expired"===a.status),ag=ac.filter(a=>"terminated"===a.status);return S?(0,e.jsx)("div",{className:"min-h-screen bg-background",children:(0,e.jsxs)("div",{className:"p-4 px-6 space-y-6",children:[(0,e.jsx)("div",{className:"border-b border-border pb-4 pt-4",children:(0,e.jsx)("div",{children:(0,e.jsx)("h1",{className:"text-2xl font-semibold text-foreground",children:"Contracts"})})}),(0,e.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[void 0,void 0,void 0,void 0].map((a,b)=>(0,e.jsxs)(j.Zp,{className:"animate-pulse",children:[(0,e.jsxs)(j.aR,{className:"space-y-2",children:[(0,e.jsx)("div",{className:"h-4 bg-muted rounded w-3/4"}),(0,e.jsx)("div",{className:"h-3 bg-muted rounded w-1/2"})]}),(0,e.jsx)(j.Wu,{children:(0,e.jsx)("div",{className:"h-8 bg-muted rounded"})})]},b))})]})}):T?(0,e.jsx)("div",{className:"min-h-screen bg-background",children:(0,e.jsxs)("div",{className:"p-4 px-6 space-y-6",children:[(0,e.jsx)("div",{className:"border-b border-border pb-4 pt-4",children:(0,e.jsxs)("div",{children:[(0,e.jsx)("h1",{className:"text-2xl font-semibold text-foreground",children:"Error"}),(0,e.jsx)("p",{className:"text-destructive text-sm mt-1",children:"Failed to load contracts data. Please try refreshing the page."})]})}),(0,e.jsxs)(u.Fc,{variant:"destructive",children:[(0,e.jsx)(g.hcu,{className:"h-4 w-4"}),(0,e.jsx)(u.XL,{children:"Error"}),(0,e.jsx)(u.TN,{children:"Failed to load contracts data. Please try refreshing the page."})]})]})}):(0,e.jsx)("div",{className:"min-h-screen bg-background",children:(0,e.jsxs)("div",{className:"p-4 px-6 space-y-6",children:[(0,e.jsx)("div",{className:"border-b border-border pb-4 pt-4",children:(0,e.jsxs)("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between",children:[(0,e.jsx)("div",{children:(0,e.jsx)("h1",{className:"text-2xl font-semibold text-foreground",children:"Contracts"})}),(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[(0,e.jsxs)(h.$,{variant:"outline",size:"sm",onClick:Y,children:[(0,e.jsx)(g.nmj,{className:"mr-2 h-4 w-4"}),"Export"]}),(0,e.jsxs)(h.$,{onClick:()=>{Z(),C(!0)},children:[(0,e.jsx)(g.FWt,{className:"mr-2 h-4 w-4"})," Add Contract"]})]})]})}),!L&&(0,e.jsxs)(u.Fc,{variant:"destructive",children:[(0,e.jsx)(g.hcu,{className:"h-4 w-4"}),(0,e.jsx)(u.XL,{children:"Storage Service Issue"}),(0,e.jsxs)(u.TN,{children:["Document uploads and downloads are currently unavailable.",N&&(0,e.jsxs)("div",{className:"mt-2 text-sm",children:["Error: ",N]}),(0,e.jsx)("div",{className:"mt-2",children:"Contracts can still be managed, but without document attachments."})]})]}),(0,e.jsx)(q.A,{contracts:R}),(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4",children:[(0,e.jsxs)("div",{className:"flex-1 relative group",children:[(0,e.jsx)(g.vji,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground group-focus-within:text-primary transition-colors"}),(0,e.jsx)(i.p,{placeholder:"Search contracts by name or client...",value:a,onChange:a=>b(a.target.value),className:"pl-9 h-11 border-border/50 focus:border-primary/50 transition-all duration-200"}),a&&(0,e.jsx)(h.$,{variant:"ghost",size:"sm",className:"absolute right-1 top-1 h-7 w-7 p-0 hover:bg-muted/50",onClick:()=>b(""),"aria-label":"Clear search",children:(0,e.jsx)(g.Jpz,{className:"h-3 w-3"})})]}),(0,e.jsxs)("div",{className:"flex items-center gap-3",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[(0,e.jsxs)(m.l6,{value:c,onValueChange:d,children:[(0,e.jsxs)(m.bq,{className:"w-[160px] h-11 border-border/50 focus:border-primary/50",children:[(0,e.jsx)(g.dJT,{className:"mr-2 h-4 w-4"}),(0,e.jsx)(m.yv,{placeholder:"Status"})]}),(0,e.jsxs)(m.gC,{children:[(0,e.jsx)(m.eb,{value:"all",children:"All Status"}),(0,e.jsx)(m.eb,{value:"active",children:"Active"}),(0,e.jsx)(m.eb,{value:"pending",children:"Pending"}),(0,e.jsx)(m.eb,{value:"expired",children:"Expired"}),(0,e.jsx)(m.eb,{value:"terminated",children:"Terminated"})]})]}),(0,e.jsxs)(m.l6,{value:v,onValueChange:a=>w(a),children:[(0,e.jsx)(m.bq,{className:"w-[160px] h-11 border-border/50 focus:border-primary/50",children:(0,e.jsx)(m.yv,{placeholder:"Sort by"})}),(0,e.jsxs)(m.gC,{children:[(0,e.jsx)(m.eb,{value:"created_at",children:"Created Date"}),(0,e.jsx)(m.eb,{value:"name",children:"Name"}),(0,e.jsx)(m.eb,{value:"client_name",children:"Client"}),(0,e.jsx)(m.eb,{value:"start_date",children:"Start Date"}),(0,e.jsx)(m.eb,{value:"end_date",children:"End Date"})]})]}),(0,e.jsx)(h.$,{variant:"outline",size:"sm",onClick:()=>y("asc"===x?"desc":"asc"),className:"h-11 px-3","aria-label":"Toggle sort direction",children:"asc"===x?(0,e.jsx)(g.gE3,{className:"h-4 w-4"}):(0,e.jsx)(g.eqt,{className:"h-4 w-4"})})]}),(0,e.jsxs)("div",{className:"flex items-center gap-1 p-1 bg-muted/30 rounded-lg border border-border/50",children:[(0,e.jsxs)(h.$,{variant:"ghost",size:"sm",className:`h-8 px-3 rounded-md transition-all ${"table"===z?"bg-background text-foreground shadow-sm border border-border/50":"text-muted-foreground hover:text-foreground"}`,onClick:()=>A("table"),"aria-label":"Table view",children:[(0,e.jsx)(g.FH5,{className:"h-4 w-4 mr-2"}),"Table"]}),(0,e.jsxs)(h.$,{variant:"ghost",size:"sm",className:`h-8 px-3 rounded-md transition-all ${"cards"===z?"bg-background text-foreground shadow-sm border border-border/50":"text-muted-foreground hover:text-foreground"}`,onClick:()=>A("cards"),"aria-label":"Cards view",children:[(0,e.jsx)(g.D6i,{className:"h-4 w-4 mr-2"}),"Cards"]})]})]})]}),(a||"all"!==c||"created_at"!==v||"desc"!==x)&&(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{className:"flex flex-wrap gap-2",children:[a&&(0,e.jsxs)(l.E,{variant:"secondary",className:"gap-1",children:['Search: "',a,'"',(0,e.jsx)(h.$,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-transparent",onClick:()=>b(""),"aria-label":"Clear search chip",children:(0,e.jsx)(g.Jpz,{className:"h-3 w-3"})})]}),"all"!==c&&(0,e.jsxs)(l.E,{variant:"secondary",className:"gap-1",children:["Status: ",c,(0,e.jsx)(h.$,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-transparent",onClick:()=>d("all"),"aria-label":"Clear status chip",children:(0,e.jsx)(g.Jpz,{className:"h-3 w-3"})})]}),("created_at"!==v||"desc"!==x)&&(0,e.jsxs)(l.E,{variant:"secondary",className:"gap-1",children:["Sort: ",v.replace("_"," ")," (",x,")",(0,e.jsx)(h.$,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-transparent",onClick:()=>{w("created_at"),y("desc")},"aria-label":"Reset sort chip",children:(0,e.jsx)(g.Jpz,{className:"h-3 w-3"})})]})]}),(0,e.jsxs)(h.$,{variant:"outline",size:"sm",onClick:()=>{b(""),d("all"),w("created_at"),y("desc")},className:"shrink-0 text-muted-foreground hover:text-foreground",children:[(0,e.jsx)(g.Jpz,{className:"mr-2 h-4 w-4"}),"Clear All"]})]})]}),(0,e.jsx)(j.Zp,{children:(0,e.jsx)(j.Wu,{className:"pt-6",children:(0,e.jsxs)(k.tU,{defaultValue:"all",children:[(0,e.jsxs)(k.j7,{className:"mb-6 w-full justify-start",children:[(0,e.jsxs)(k.Xi,{value:"all",className:"flex items-center gap-2",children:["All",(0,e.jsx)(l.E,{variant:"secondary",children:ac.length})]}),(0,e.jsxs)(k.Xi,{value:"active",className:"flex items-center gap-2",children:[(0,e.jsx)(g.rAV,{className:"h-4 w-4"}),"Active",(0,e.jsx)(l.E,{variant:"secondary",children:ad.length})]}),(0,e.jsxs)(k.Xi,{value:"pending",className:"flex items-center gap-2",children:[(0,e.jsx)(g.zD7,{className:"h-4 w-4"}),"Pending",(0,e.jsx)(l.E,{variant:"secondary",children:ae.length})]}),(0,e.jsxs)(k.Xi,{value:"expired",className:"flex items-center gap-2",children:[(0,e.jsx)(g.Jpz,{className:"h-4 w-4"}),"Expired",(0,e.jsx)(l.E,{variant:"secondary",children:af.length})]}),(0,e.jsxs)(k.Xi,{value:"terminated",className:"flex items-center gap-2",children:[(0,e.jsx)(g.Jpz,{className:"h-4 w-4"}),"Terminated",(0,e.jsx)(l.E,{variant:"secondary",children:ag.length})]})]}),(0,e.jsx)(k.av,{value:"all",children:(0,e.jsx)(p.A,{contracts:ac,onEdit:aa,onDelete:ab,onDownload:X,viewMode:z})}),(0,e.jsx)(k.av,{value:"active",children:(0,e.jsx)(p.A,{contracts:ad,onEdit:aa,onDelete:ab,onDownload:X,viewMode:z})}),(0,e.jsx)(k.av,{value:"pending",children:(0,e.jsx)(p.A,{contracts:ae,onEdit:aa,onDelete:ab,onDownload:X,viewMode:z})}),(0,e.jsx)(k.av,{value:"expired",children:(0,e.jsx)(p.A,{contracts:af,onEdit:aa,onDelete:ab,onDownload:X,viewMode:z})}),(0,e.jsx)(k.av,{value:"terminated",children:(0,e.jsx)(p.A,{contracts:ag,onEdit:aa,onDelete:ab,onDownload:X,viewMode:z})})]})})}),(0,e.jsx)(r.A,{open:B,onOpenChange:C,formData:H,handleInputChange:$,handleFileChange:_,handleSubmit:a=>{a.preventDefault(),U.mutate({...H,created_at:new Date().toISOString()})},isPending:U.isPending,isStorageAvailable:L}),(0,e.jsx)(s.A,{open:D,onOpenChange:E,formData:H,selectedContract:F,handleInputChange:$,handleFileChange:_,handleSubmit:a=>{a.preventDefault(),V.mutate(H)},isPending:V.isPending,isStorageAvailable:L,onDownload:X})]})})}[h,i,j,k,l,m,o,p,q,r,s,u]=v.then?(await v)():v,d()}catch(a){d(a)}})},57312:a=>{a.exports=import("next-themes")},60461:a=>{a.exports=import("@radix-ui/react-popover")},68953:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{Xi:()=>l,av:()=>m,j7:()=>k,tU:()=>j});var e=c(8732),f=c(82015),g=c(19640),h=c(87092),i=a([g,h]);[g,h]=i.then?(await i)():i;let j=g.Root,k=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.List,{ref:c,className:(0,h.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...b}));k.displayName=g.List.displayName;let l=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Trigger,{ref:c,className:(0,h.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...b}));l.displayName=g.Trigger.displayName;let m=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Content,{ref:c,className:(0,h.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...b}));m.displayName=g.Content.displayName,d()}catch(a){d(a)}})},74671:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{config:()=>r,default:()=>n,getServerSideProps:()=>q,getStaticPaths:()=>p,getStaticProps:()=>o,handler:()=>z,reportWebVitals:()=>s,routeModule:()=>y,unstable_getServerProps:()=>w,unstable_getServerSideProps:()=>x,unstable_getStaticParams:()=>v,unstable_getStaticPaths:()=>u,unstable_getStaticProps:()=>t});var e=c(63885),f=c(80237),g=c(81413),h=c(65611),i=c.n(h),j=c(74780),k=c(55599),l=c(12289),m=a([j,k]);[j,k]=m.then?(await m)():m;let n=(0,g.M)(k,"default"),o=(0,g.M)(k,"getStaticProps"),p=(0,g.M)(k,"getStaticPaths"),q=(0,g.M)(k,"getServerSideProps"),r=(0,g.M)(k,"config"),s=(0,g.M)(k,"reportWebVitals"),t=(0,g.M)(k,"unstable_getStaticProps"),u=(0,g.M)(k,"unstable_getStaticPaths"),v=(0,g.M)(k,"unstable_getStaticParams"),w=(0,g.M)(k,"unstable_getServerProps"),x=(0,g.M)(k,"unstable_getServerSideProps"),y=new e.PagesRouteModule({definition:{kind:f.RouteKind.PAGES,page:"/Contracts",pathname:"/Contracts",bundlePath:"",filename:""},distDir:".next-fleet",relativeProjectDir:"",components:{App:j.default,Document:i()},userland:k}),z=(0,l.U)({srcPage:"/Contracts",config:r,userland:k,routeModule:y,getStaticPaths:p,getStaticProps:o,getServerSideProps:q});d()}catch(a){d(a)}})},75979:a=>{a.exports=import("tailwind-merge")},79837:(a,b,c)=>{c.d(b,{d:()=>e});var d=c(21638);function e(a,b){let c=(0,d.a)(a),e=(0,d.a)(b);return c.getTime()>e.getTime()}},80627:(a,b,c)=>{c.d(b,{m:()=>l});var d=c(68794),e=c(21638);function f(a,b){let c=(0,e.a)(a),d=(0,e.a)(b),f=c.getTime()-d.getTime();return f<0?-1:f>0?1:f}var g=c(73502),h=c(10493),i=c(40746),j=c(12723),k=c(41321);function l(a,b){return function(a,b,c){let d,l,m,n=(0,j.q)(),o=c?.locale??n.locale??i.c,p=f(a,b);if(isNaN(p))throw RangeError("Invalid time value");let q=Object.assign({},c,{addSuffix:c?.addSuffix,comparison:p});p>0?(d=(0,e.a)(b),l=(0,e.a)(a)):(d=(0,e.a)(a),l=(0,e.a)(b));let r=function(a,b,c){var d;return(d=void 0,a=>{let b=(d?Math[d]:Math.trunc)(a);return 0===b?0:b})(((0,e.a)(a)-(0,e.a)(b))/1e3)}(l,d),s=Math.round((r-((0,k.G)(l)-(0,k.G)(d))/1e3)/60);if(s<2)if(c?.includeSeconds)if(r<5)return o.formatDistance("lessThanXSeconds",5,q);else if(r<10)return o.formatDistance("lessThanXSeconds",10,q);else if(r<20)return o.formatDistance("lessThanXSeconds",20,q);else if(r<40)return o.formatDistance("halfAMinute",0,q);else if(r<60)return o.formatDistance("lessThanXMinutes",1,q);else return o.formatDistance("xMinutes",1,q);else if(0===s)return o.formatDistance("lessThanXMinutes",1,q);else return o.formatDistance("xMinutes",s,q);if(s<45)return o.formatDistance("xMinutes",s,q);if(s<90)return o.formatDistance("aboutXHours",1,q);if(s<g.F6){let a=Math.round(s/60);return o.formatDistance("aboutXHours",a,q)}if(s<2520)return o.formatDistance("xDays",1,q);else if(s<g.Nw){let a=Math.round(s/g.F6);return o.formatDistance("xDays",a,q)}else if(s<2*g.Nw)return m=Math.round(s/g.Nw),o.formatDistance("aboutXMonths",m,q);if((m=function(a,b){let c,d=(0,e.a)(a),g=(0,e.a)(b),i=f(d,g),j=Math.abs(function(a,b){let c=(0,e.a)(a),d=(0,e.a)(b);return 12*(c.getFullYear()-d.getFullYear())+(c.getMonth()-d.getMonth())}(d,g));if(j<1)c=0;else{1===d.getMonth()&&d.getDate()>27&&d.setDate(30),d.setMonth(d.getMonth()-i*j);let b=f(d,g)===-i;(function(a){let b=(0,e.a)(a);return+function(a){let b=(0,e.a)(a);return b.setHours(23,59,59,999),b}(b)==+(0,h.p)(b)})((0,e.a)(a))&&1===j&&1===f(a,g)&&(b=!1),c=i*(j-Number(b))}return 0===c?0:c}(l,d))<12){let a=Math.round(s/g.Nw);return o.formatDistance("xMonths",a,q)}{let a=m%12,b=Math.trunc(m/12);return a<3?o.formatDistance("aboutXYears",b,q):a<9?o.formatDistance("overXYears",b,q):o.formatDistance("almostXYears",b+1,q)}}(a,(0,d.w)(a,Date.now()),b)}},81575:(a,b,c)=>{c.d(b,{H:()=>e});var d=c(73502);function e(a,b){let c,e,n=b?.additionalDigits??2,o=function(a){let b,c={},d=a.split(f.dateTimeDelimiter);if(d.length>2)return c;if(/:/.test(d[0])?b=d[0]:(c.date=d[0],b=d[1],f.timeZoneDelimiter.test(c.date)&&(c.date=a.split(f.timeZoneDelimiter)[0],b=a.substr(c.date.length,a.length))),b){let a=f.timezone.exec(b);a?(c.time=b.replace(a[1],""),c.timezone=a[1]):c.time=b}return c}(a);if(o.date){let a=function(a,b){let c=RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+b)+"})|(\\d{2}|[+-]\\d{"+(2+b)+"})$)"),d=a.match(c);if(!d)return{year:NaN,restDateString:""};let e=d[1]?parseInt(d[1]):null,f=d[2]?parseInt(d[2]):null;return{year:null===f?e:100*f,restDateString:a.slice((d[1]||d[2]).length)}}(o.date,n);c=function(a,b){var c,d,e,f,h,i,k;if(null===b)return new Date(NaN);let n=a.match(g);if(!n)return new Date(NaN);let o=!!n[4],p=j(n[1]),q=j(n[2])-1,r=j(n[3]),s=j(n[4]),t=j(n[5])-1;if(o){return(c=s,d=t,c>=1&&c<=53&&d>=0&&d<=6)?function(a,b,c){let d=new Date(0);d.setUTCFullYear(a,0,4);let e=d.getUTCDay()||7;return d.setUTCDate(d.getUTCDate()+((b-1)*7+c+1-e)),d}(b,s,t):new Date(NaN)}{let a=new Date(0);return(e=b,f=q,h=r,f>=0&&f<=11&&h>=1&&h<=(l[f]||(m(e)?29:28))&&(i=b,(k=p)>=1&&k<=(m(i)?366:365)))?(a.setUTCFullYear(b,q,Math.max(p,r)),a):new Date(NaN)}}(a.restDateString,a.year)}if(!c||isNaN(c.getTime()))return new Date(NaN);let p=c.getTime(),q=0;if(o.time&&isNaN(q=function(a){var b,c,e;let f=a.match(h);if(!f)return NaN;let g=k(f[1]),i=k(f[2]),j=k(f[3]);return(b=g,c=i,e=j,24===b?0===c&&0===e:e>=0&&e<60&&c>=0&&c<60&&b>=0&&b<25)?g*d.s0+i*d.Cg+1e3*j:NaN}(o.time)))return new Date(NaN);if(o.timezone){if(isNaN(e=function(a){var b;if("Z"===a)return 0;let c=a.match(i);if(!c)return 0;let e="+"===c[1]?-1:1,f=parseInt(c[2]),g=c[3]&&parseInt(c[3])||0;return(b=g)>=0&&b<=59?e*(f*d.s0+g*d.Cg):NaN}(o.timezone)))return new Date(NaN)}else{let a=new Date(p+q),b=new Date(0);return b.setFullYear(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()),b.setHours(a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()),b}return new Date(p+q+e)}let f={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},g=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,h=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,i=/^([+-])(\d{2})(?::?(\d{2}))?$/;function j(a){return a?parseInt(a):1}function k(a){return a&&parseFloat(a.replace(",","."))||0}let l=[31,null,31,30,31,30,31,31,30,31,30,31];function m(a){return a%400==0||a%4==0&&a%100!=0}},82015:a=>{a.exports=require("react")},82020:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{A:()=>t});var e=c(8732),f=c(74952),g=c(66345),h=c(48383),i=c(39655),j=c(4720),k=c(94142),l=c(21839),m=c(79837),n=c(17156),o=c(80627),p=a([g,h,i,j,k]);[g,h,i,j,k]=p.then?(await p)():p;let q=a=>{switch(a){case"active":return(0,e.jsx)(f.rAV,{className:"h-4 w-4 text-green-600"});case"pending":return(0,e.jsx)(f.zD7,{className:"h-4 w-4 text-yellow-600"});case"expired":case"terminated":return(0,e.jsx)(f.Jpz,{className:"h-4 w-4 text-red-600"});default:return(0,e.jsx)(f.zD7,{className:"h-4 w-4 text-gray-600"})}},r=a=>{switch(a){case"active":return"default";case"pending":return"secondary";case"expired":case"terminated":return"destructive";default:return"outline"}},s=a=>{if("active"!==a.status)return!1;let b=new Date(a.end_date),c=(0,l.f)(new Date,30);return(0,m.d)(b,new Date)&&(0,n.Y)(b,c)},t=({contracts:a,onEdit:b,onDelete:c,onDownload:d,viewMode:l="table"})=>0===a.length?(0,e.jsxs)("div",{className:"text-center py-12",children:[(0,e.jsx)(f.iUU,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),(0,e.jsx)("h3",{className:"text-lg font-semibold text-muted-foreground mb-2",children:"No contracts found"}),(0,e.jsx)("p",{className:"text-sm text-muted-foreground",children:"table"===l?"The table will appear here when contracts are added.":"Contract cards will appear here when contracts are added."})]}):"cards"===l?(0,e.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:a.map(a=>{let h=s(a),k="active"===a.status?Math.ceil((new Date(a.end_date).getTime()-new Date().getTime())/864e5):null;return(0,e.jsxs)(i.Zp,{className:`group hover:shadow-lg transition-all duration-200 ${h?"ring-2 ring-amber-200 bg-amber-50/50 dark:ring-amber-800 dark:bg-amber-950/50":""}`,children:[(0,e.jsxs)(i.aR,{className:"pb-3",children:[(0,e.jsxs)("div",{className:"flex items-start justify-between",children:[(0,e.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,e.jsxs)(i.ZB,{className:"text-lg font-semibold truncate group-hover:text-primary transition-colors",children:[a.contract_number," â€” ",a.name]}),(0,e.jsxs)(i.BT,{className:"flex items-center gap-1 mt-1",children:[(0,e.jsx)(f.KJW,{className:"h-3 w-3"}),a.client_name]})]}),(0,e.jsx)("div",{className:"flex items-center gap-2 ml-2",children:(0,e.jsxs)(j.E,{variant:r(a.status),className:"flex items-center gap-1",children:[q(a.status),a.status.charAt(0).toUpperCase()+a.status.slice(1)]})})]}),h&&(0,e.jsxs)("div",{className:"flex items-center gap-2 text-amber-700 dark:text-amber-400 text-sm font-medium",children:[(0,e.jsx)(f.hcu,{className:"h-4 w-4"}),"Expires in ",k," days"]})]}),(0,e.jsxs)(i.Wu,{className:"pt-0",children:[(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,e.jsxs)("div",{className:"space-y-1",children:[(0,e.jsx)("div",{className:"text-muted-foreground text-xs font-medium",children:"Start Date"}),(0,e.jsxs)("div",{className:"flex items-center gap-1 text-sm",children:[(0,e.jsx)(f.VvS,{className:"h-3 w-3 text-muted-foreground"}),new Date(a.start_date).toLocaleDateString()]})]}),(0,e.jsxs)("div",{className:"space-y-1",children:[(0,e.jsx)("div",{className:"text-muted-foreground text-xs font-medium",children:"End Date"}),(0,e.jsxs)("div",{className:"flex items-center gap-1 text-sm",children:[(0,e.jsx)(f.VvS,{className:"h-3 w-3 text-muted-foreground"}),new Date(a.end_date).toLocaleDateString()]})]})]}),(0,e.jsxs)("div",{className:"space-y-1",children:[(0,e.jsx)("div",{className:"text-muted-foreground text-xs font-medium",children:"Created"}),(0,e.jsx)("div",{className:"text-sm",children:(0,o.m)(new Date(a.created_at),{addSuffix:!0})})]}),a.contract_file&&(0,e.jsxs)("div",{className:"flex items-center gap-1 text-sm text-blue-600 dark:text-blue-400",children:[(0,e.jsx)(f.iUU,{className:"h-3 w-3"}),"Document attached"]})]}),(0,e.jsxs)("div",{className:"flex items-center justify-between pt-4 mt-4 border-t",children:[(0,e.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,e.jsx)(g.$,{variant:"outline",size:"sm",onClick:()=>b(a),className:"h-8 px-2",title:"Edit contract",children:(0,e.jsx)(f.ffu,{className:"h-3 w-3"})}),(0,e.jsx)(g.$,{variant:"outline",size:"sm",onClick:()=>c(a),className:"h-8 px-2 hover:bg-destructive hover:text-destructive-foreground",title:"Delete contract",children:(0,e.jsx)(f.TBR,{className:"h-3 w-3"})})]}),a.contract_file&&(0,e.jsxs)(g.$,{variant:"outline",size:"sm",onClick:()=>d(a),className:"h-8 px-3",title:"Download contract",children:[(0,e.jsx)(f.f5X,{className:"h-3 w-3 mr-1"}),"Download"]})]})]})]},a.id)})}):(0,e.jsx)(k.F,{className:"h-[600px] w-full",children:(0,e.jsxs)(h.XI,{children:[(0,e.jsx)(h.A0,{className:"sticky top-0 bg-background z-10",children:(0,e.jsxs)(h.Hj,{children:[(0,e.jsx)(h.nd,{children:"No."}),(0,e.jsx)(h.nd,{children:"Contract Name"}),(0,e.jsx)(h.nd,{children:"Client"}),(0,e.jsx)(h.nd,{children:"Status"}),(0,e.jsx)(h.nd,{children:"Start Date"}),(0,e.jsx)(h.nd,{children:"End Date"}),(0,e.jsx)(h.nd,{children:"Created"}),(0,e.jsx)(h.nd,{className:"text-right",children:"Actions"})]})}),(0,e.jsx)(h.BF,{children:a.map(a=>{let i=s(a),k="active"===a.status?Math.ceil((new Date(a.end_date).getTime()-new Date().getTime())/864e5):null;return(0,e.jsxs)(h.Hj,{className:`hover:bg-muted/50 transition-colors ${i?"bg-amber-50/50 dark:bg-amber-950/20":""}`,children:[(0,e.jsx)(h.nA,{className:"font-medium text-muted-foreground",children:a.contract_number}),(0,e.jsx)(h.nA,{className:"font-medium",children:(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[a.contract_file&&(0,e.jsx)(f.iUU,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}),(0,e.jsx)("span",{className:"truncate max-w-48",children:a.name}),i&&(0,e.jsxs)(j.E,{variant:"outline",className:"text-xs text-amber-700 dark:text-amber-400 border-amber-300 dark:border-amber-700",children:[(0,e.jsx)(f.hcu,{className:"h-3 w-3 mr-1"}),k,"d"]})]})}),(0,e.jsx)(h.nA,{children:(0,e.jsxs)("div",{className:"flex items-center gap-1",children:[(0,e.jsx)(f.KJW,{className:"h-3 w-3 text-muted-foreground"}),(0,e.jsx)("span",{className:"truncate max-w-32",children:a.client_name})]})}),(0,e.jsx)(h.nA,{children:(0,e.jsxs)(j.E,{variant:r(a.status),className:"flex items-center gap-1 w-fit",children:[q(a.status),a.status.charAt(0).toUpperCase()+a.status.slice(1)]})}),(0,e.jsx)(h.nA,{className:"text-muted-foreground",children:new Date(a.start_date).toLocaleDateString()}),(0,e.jsx)(h.nA,{className:"text-muted-foreground",children:new Date(a.end_date).toLocaleDateString()}),(0,e.jsx)(h.nA,{className:"text-muted-foreground text-sm",children:(0,o.m)(new Date(a.created_at),{addSuffix:!0})}),(0,e.jsx)(h.nA,{children:(0,e.jsxs)("div",{className:"flex items-center justify-end space-x-1",children:[(0,e.jsx)(g.$,{variant:"outline",size:"sm",onClick:()=>b(a),className:"h-8 px-2",title:"Edit contract",children:(0,e.jsx)(f.ffu,{className:"h-3 w-3"})}),(0,e.jsx)(g.$,{variant:"outline",size:"sm",onClick:()=>c(a),className:"h-8 px-2 hover:bg-destructive hover:text-destructive-foreground",title:"Delete contract",children:(0,e.jsx)(f.TBR,{className:"h-3 w-3"})}),a.contract_file&&(0,e.jsx)(g.$,{variant:"outline",size:"sm",onClick:()=>d(a),className:"h-8 px-2",title:"Download contract",children:(0,e.jsx)(f.f5X,{className:"h-3 w-3"})})]})})]},a.id)})})]})});d()}catch(a){d(a)}})},85489:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{A:()=>m});var e=c(8732),f=c(39655),g=c(4720),h=c(74952),i=c(21839),j=c(79837),k=c(17156),l=a([f,g]);[f,g]=l.then?(await l)():l;let m=({contracts:a})=>{a.length,a.filter(a=>"active"===a.status).length,a.filter(a=>"pending"===a.status).length,a.filter(a=>"expired"===a.status).length,a.filter(a=>"terminated"===a.status).length;let b=a.filter(a=>{if("active"!==a.status)return!1;let b=new Date(a.end_date),c=(0,i.f)(new Date,30);return(0,j.d)(b,new Date)&&(0,k.Y)(b,c)});a.filter(a=>{let b=new Date(a.created_at),c=(0,i.f)(new Date,-30);return(0,j.d)(b,c)}).length,a.filter(a=>a.contract_file).length;let c=a.filter(a=>"expired"===a.status||"terminated"===a.status);c.length>0&&(c.reduce((a,b)=>{let c=new Date(b.start_date),d=new Date(b.end_date);return a+Math.ceil((d.getTime()-c.getTime())/864e5)},0),c.length);let d=a.reduce((a,b)=>(a[b.client_name]=(a[b.client_name]||0)+1,a),{});return Object.entries(d).sort(([,a],[,b])=>b-a).slice(0,5),(0,e.jsx)("div",{className:"space-y-6",children:b.length>0&&(0,e.jsxs)(f.Zp,{className:"border-amber-200 bg-amber-50/50 dark:border-amber-800 dark:bg-amber-950/50",children:[(0,e.jsxs)(f.aR,{children:[(0,e.jsxs)(f.ZB,{className:"text-lg flex items-center gap-2 text-amber-700 dark:text-amber-400",children:[(0,e.jsx)(h.hcu,{className:"h-5 w-5"}),"Contracts Expiring Soon"]}),(0,e.jsx)(f.BT,{children:"Review these contracts before they expire"})]}),(0,e.jsx)(f.Wu,{children:(0,e.jsxs)("div",{className:"space-y-3",children:[b.slice(0,5).map(a=>{let b=Math.ceil((new Date(a.end_date).getTime()-new Date().getTime())/864e5);return(0,e.jsxs)("div",{className:"flex justify-between items-center p-3 bg-white dark:bg-gray-800 rounded-md",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"font-medium",children:a.name}),(0,e.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Client: ",a.client_name]})]}),(0,e.jsxs)(g.E,{variant:"outline",className:`${b<=7?"border-red-300 text-red-700 dark:border-red-700 dark:text-red-400":"border-amber-300 text-amber-700 dark:border-amber-700 dark:text-amber-400"}`,children:[b," days left"]})]},a.id)}),b.length>5&&(0,e.jsxs)("div",{className:"text-center text-sm text-muted-foreground",children:["And ",b.length-5," more contracts..."]})]})})]})})};d()}catch(a){d(a)}})},86093:a=>{a.exports=require("react-day-picker")},93939:a=>{a.exports=require("@supabase/supabase-js")},94142:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{F:()=>j});var e=c(8732),f=c(82015),g=c(14505),h=c(87092),i=a([g,h]);[g,h]=i.then?(await i)():i;let j=f.forwardRef(({className:a,children:b,...c},d)=>(0,e.jsxs)(g.Root,{ref:d,className:(0,h.cn)("relative overflow-hidden",a),...c,children:[(0,e.jsx)(g.Viewport,{className:"h-full w-full rounded-[inherit]",children:b}),(0,e.jsx)(k,{}),(0,e.jsx)(g.Corner,{})]}));j.displayName=g.Root.displayName;let k=f.forwardRef(({className:a,orientation:b="vertical",...c},d)=>(0,e.jsx)(g.ScrollAreaScrollbar,{ref:d,orientation:b,className:(0,h.cn)("flex touch-none select-none transition-colors","vertical"===b&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===b&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...c,children:(0,e.jsx)(g.ScrollAreaThumb,{className:"relative flex-1 rounded-full bg-border"})}));k.displayName=g.ScrollAreaScrollbar.displayName,d()}catch(a){d(a)}})}};var b=require("../webpack-runtime.js");b.C(a);var c=b.X(0,[4952,5611,5781,1913,4780,5833],()=>b(b.s=74671));module.exports=c})();