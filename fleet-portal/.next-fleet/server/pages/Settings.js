"use strict";(()=>{var a={};a.id=1031,a.ids=[636,1031,3220],a.modules={4720:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{E:()=>i});var e=c(8732);c(82015);var f=c(8938),g=c(87092),h=a([f,g]);[f,g]=h.then?(await h)():h;let j=(0,f.cva)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i({className:a,variant:b,...c}){return(0,e.jsx)("div",{className:(0,g.cn)(j({variant:b}),a),...c})}d()}catch(a){d(a)}})},8732:a=>{a.exports=require("react/jsx-runtime")},8938:a=>{a.exports=import("class-variance-authority")},9640:a=>{a.exports=import("@radix-ui/react-slot")},12479:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{config:()=>r,default:()=>n,getServerSideProps:()=>q,getStaticPaths:()=>p,getStaticProps:()=>o,handler:()=>z,reportWebVitals:()=>s,routeModule:()=>y,unstable_getServerProps:()=>w,unstable_getServerSideProps:()=>x,unstable_getStaticParams:()=>v,unstable_getStaticPaths:()=>u,unstable_getStaticProps:()=>t});var e=c(63885),f=c(80237),g=c(81413),h=c(65611),i=c.n(h),j=c(74780),k=c(69641),l=c(12289),m=a([j,k]);[j,k]=m.then?(await m)():m;let n=(0,g.M)(k,"default"),o=(0,g.M)(k,"getStaticProps"),p=(0,g.M)(k,"getStaticPaths"),q=(0,g.M)(k,"getServerSideProps"),r=(0,g.M)(k,"config"),s=(0,g.M)(k,"reportWebVitals"),t=(0,g.M)(k,"unstable_getStaticProps"),u=(0,g.M)(k,"unstable_getStaticPaths"),v=(0,g.M)(k,"unstable_getStaticParams"),w=(0,g.M)(k,"unstable_getServerProps"),x=(0,g.M)(k,"unstable_getServerSideProps"),y=new e.PagesRouteModule({definition:{kind:f.RouteKind.PAGES,page:"/Settings",pathname:"/Settings",bundlePath:"",filename:""},distDir:".next-fleet",relativeProjectDir:"",components:{App:j.default,Document:i()},userland:k}),z=(0,l.U)({srcPage:"/Settings",config:r,userland:k,routeModule:y,getStaticPaths:p,getStaticProps:o,getServerSideProps:q});d()}catch(a){d(a)}})},13020:a=>{a.exports=import("@radix-ui/react-dialog")},16235:a=>{a.exports=import("@radix-ui/react-toast")},19640:a=>{a.exports=import("@radix-ui/react-tabs")},20598:a=>{a.exports=import("@radix-ui/react-label")},28462:a=>{a.exports=import("@tanstack/react-query")},33873:a=>{a.exports=require("path")},38661:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{Cf:()=>o,Es:()=>q,HM:()=>m,L3:()=>r,c7:()=>p,lG:()=>j,rr:()=>s,zM:()=>k});var e=c(8732),f=c(82015),g=c(13020),h=c(87092),i=a([g,h]);[g,h]=i.then?(await i)():i;let j=g.Root,k=g.Trigger,l=g.Portal,m=g.Close,n=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Overlay,{ref:c,className:(0,h.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...b}));n.displayName=g.Overlay.displayName;let o=f.forwardRef(({className:a,children:b,...c},d)=>(0,e.jsxs)(l,{children:[(0,e.jsx)(n,{}),(0,e.jsx)(g.Content,{ref:d,className:(0,h.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...c,children:b})]}));o.displayName=g.Content.displayName;let p=({className:a,...b})=>(0,e.jsx)("div",{className:(0,h.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...b});p.displayName="DialogHeader";let q=({className:a,...b})=>(0,e.jsx)("div",{className:(0,h.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...b});q.displayName="DialogFooter";let r=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Title,{ref:c,className:(0,h.cn)("text-lg font-semibold leading-none tracking-tight",a),...b}));r.displayName=g.Title.displayName;let s=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Description,{ref:c,className:(0,h.cn)("text-sm text-muted-foreground",a),...b}));s.displayName=g.Description.displayName,d()}catch(a){d(a)}})},39655:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{BT:()=>l,Wu:()=>m,ZB:()=>k,Zp:()=>i,aR:()=>j,wL:()=>n});var e=c(8732),f=c(82015),g=c(87092),h=a([g]);g=(h.then?(await h)():h)[0];let i=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("div",{ref:c,className:(0,g.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...b}));i.displayName="Card";let j=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("div",{ref:c,className:(0,g.cn)("flex flex-col space-y-1.5 p-6",a),...b}));j.displayName="CardHeader";let k=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("h3",{ref:c,className:(0,g.cn)("text-2xl font-semibold leading-none tracking-tight",a),...b}));k.displayName="CardTitle";let l=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("p",{ref:c,className:(0,g.cn)("text-sm text-muted-foreground",a),...b}));l.displayName="CardDescription";let m=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("div",{ref:c,className:(0,g.cn)("p-6 pt-0",a),...b}));m.displayName="CardContent";let n=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("div",{ref:c,className:(0,g.cn)("flex items-center p-6 pt-0",a),...b}));n.displayName="CardFooter",d()}catch(a){d(a)}})},40273:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{J:()=>l});var e=c(8732),f=c(82015),g=c(20598),h=c(8938),i=c(87092),j=a([g,h,i]);[g,h,i]=j.then?(await j)():j;let k=(0,h.cva)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),l=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Root,{ref:c,className:(0,i.cn)(k(),a),...b}));l.displayName=g.Root.displayName,d()}catch(a){d(a)}})},40361:a=>{a.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},41415:a=>{a.exports=import("sonner")},46060:a=>{a.exports=require("next/dist/shared/lib/no-fallback-error.external.js")},47860:a=>{a.exports=import("@radix-ui/react-select")},48303:a=>{a.exports=import("@radix-ui/react-tooltip")},48383:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{A0:()=>j,BF:()=>k,Gg:()=>l,Hj:()=>m,XI:()=>i,nA:()=>o,nd:()=>n,r6:()=>p});var e=c(8732),f=c(82015),g=c(87092),h=a([g]);g=(h.then?(await h)():h)[0];let i=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("div",{className:"relative w-full overflow-auto rounded-lg",children:(0,e.jsx)("table",{ref:c,className:(0,g.cn)("w-full caption-bottom text-sm bg-card text-card-foreground",a),...b})}));i.displayName="Table";let j=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("thead",{ref:c,className:(0,g.cn)("[&_tr]:border-b border-border bg-muted/50",a),...b}));j.displayName="TableHeader";let k=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("tbody",{ref:c,className:(0,g.cn)("[&_tr:last-child]:border-0",a),...b}));k.displayName="TableBody";let l=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("tfoot",{ref:c,className:(0,g.cn)("border-t border-border bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...b}));l.displayName="TableFooter";let m=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("tr",{ref:c,className:(0,g.cn)("border-b border-border transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...b}));m.displayName="TableRow";let n=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("th",{ref:c,className:(0,g.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...b}));n.displayName="TableHead";let o=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("td",{ref:c,className:(0,g.cn)("p-4 align-middle text-card-foreground [&:has([role=checkbox])]:pr-0",a),...b}));o.displayName="TableCell";let p=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("caption",{ref:c,className:(0,g.cn)("mt-4 text-sm text-muted-foreground",a),...b}));p.displayName="TableCaption",d()}catch(a){d(a)}})},50802:a=>{a.exports=import("clsx")},57049:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{bq:()=>m,eb:()=>q,gC:()=>p,l6:()=>k,yv:()=>l});var e=c(8732),f=c(82015),g=c(47860),h=c(74952),i=c(87092),j=a([g,i]);[g,i]=j.then?(await j)():j;let k=g.Root;g.Group;let l=g.Value,m=f.forwardRef(({className:a,children:b,...c},d)=>(0,e.jsxs)(g.Trigger,{ref:d,className:(0,i.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-0 focus-visible:ring-0 focus:ring-offset-0 focus-visible:ring-offset-0 focus:border-ring focus-visible:border-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1 transition-colors",a),...c,children:[b,(0,e.jsx)(g.Icon,{asChild:!0,children:(0,e.jsx)(h.yQN,{className:"h-4 w-4 opacity-50"})})]}));m.displayName=g.Trigger.displayName;let n=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.ScrollUpButton,{ref:c,className:(0,i.cn)("flex cursor-default items-center justify-center py-1",a),...b,children:(0,e.jsx)(h.rXn,{className:"h-4 w-4"})}));n.displayName=g.ScrollUpButton.displayName;let o=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.ScrollDownButton,{ref:c,className:(0,i.cn)("flex cursor-default items-center justify-center py-1",a),...b,children:(0,e.jsx)(h.yQN,{className:"h-4 w-4"})}));o.displayName=g.ScrollDownButton.displayName;let p=f.forwardRef(({className:a,children:b,position:c="popper",...d},f)=>(0,e.jsx)(g.Portal,{children:(0,e.jsxs)(g.Content,{ref:f,className:(0,i.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===c&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:c,...d,children:[(0,e.jsx)(n,{}),(0,e.jsx)(g.Viewport,{className:(0,i.cn)("p-1","popper"===c&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:b}),(0,e.jsx)(o,{})]})}));p.displayName=g.Content.displayName,f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Label,{ref:c,className:(0,i.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...b})).displayName=g.Label.displayName;let q=f.forwardRef(({className:a,children:b,...c},d)=>(0,e.jsxs)(g.Item,{ref:d,className:(0,i.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...c,children:[(0,e.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,e.jsx)(g.ItemIndicator,{children:(0,e.jsx)(h.Jlk,{className:"h-4 w-4"})})}),(0,e.jsx)(g.ItemText,{children:b})]}));q.displayName=g.Item.displayName,f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Separator,{ref:c,className:(0,i.cn)("-mx-1 my-1 h-px bg-muted",a),...b})).displayName=g.Separator.displayName,d()}catch(a){d(a)}})},57312:a=>{a.exports=import("next-themes")},68953:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{Xi:()=>l,av:()=>m,j7:()=>k,tU:()=>j});var e=c(8732),f=c(82015),g=c(19640),h=c(87092),i=a([g,h]);[g,h]=i.then?(await i)():i;let j=g.Root,k=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.List,{ref:c,className:(0,h.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...b}));k.displayName=g.List.displayName;let l=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Trigger,{ref:c,className:(0,h.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...b}));l.displayName=g.Trigger.displayName;let m=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Content,{ref:c,className:(0,h.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...b}));m.displayName=g.Content.displayName,d()}catch(a){d(a)}})},69641:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{default:()=>w});var e=c(8732),f=c(82015),g=c.n(f),h=c(94433),i=c(76569),j=c(95965),k=c(66345),l=c(78059),m=c(40273),n=c(39655),o=c(54269),p=c(4720),q=c(68953),r=c(48383),s=c(38661),t=c(57049),u=c(74952),v=a([k,l,m,n,o,p,q,r,s,t]);[k,l,m,n,o,p,q,r,s,t]=v.then?(await v)():v;let w=()=>{let{user:a}=(0,h.A)(),{toast:b}=(0,i.dj)(),[c,d]=(0,f.useState)({email:"",password:"",full_name:"",role:""}),[v,w]=(0,f.useState)(!1),[x,y]=(0,f.useState)([]),[z,A]=(0,f.useState)(!1),[B,C]=(0,f.useState)(""),[D,E]=(0,f.useState)(""),[F,G]=(0,f.useState)(""),[H,I]=(0,f.useState)(!1),[J,K]=(0,f.useState)(!1),[L,M]=(0,f.useState)(!1),[N,O]=(0,f.useState)(!1),[P,Q]=(0,f.useState)(!1),[R,S]=(0,f.useState)(!1),[T,U]=(0,f.useState)(!1),[V,W]=(0,f.useState)(null),[X,Y]=(0,f.useState)(null),[Z,$]=(0,f.useState)(null),[_,aa]=(0,f.useState)(!1),[ab,ac]=(0,f.useState)(!1),[ad,ae]=(0,f.useState)(null),[af,ag]=(0,f.useState)({open:!1,user:null,newPassword:""}),ah=[{value:"fleet_manager",label:"Fleet Manager",description:"Manage vehicles and drivers"},{value:"operations_manager",label:"Operations Manager",description:"Manage trips and operations"},{value:"finance_manager",label:"Finance Manager",description:"Manage finances and invoices"}],ai=async()=>{A(!0);try{console.log("Loading users from profiles table (view is broken)"),await aj()}catch(a){console.error("Error loading users:",a),b({title:"Error loading users",description:a.message||"Failed to load users.",variant:"destructive"})}finally{A(!1)}},aj=async()=>{try{let{data:a,error:b}=await j.N.from("profiles").select(`
          id,
          email,
          full_name,
          phone,
          created_at
        `).order("created_at",{ascending:!1});if(b)throw b;let c=await Promise.all((a||[]).map(async a=>{if(!a||"object"!=typeof a||!a.id)return console.warn("Invalid user object:",a),null;let{data:b}=await j.N.from("user_roles").select(`
              role_slug,
              roles(name)
            `).eq("user_id",a.id),c={...a,roles:b?.map(a=>a.role_slug)||[],user_roles:b?.map(a=>({role_slug:a.role_slug,name:a.roles?.name}))||[]};return console.log("User data from profiles:",c),c}));console.log("All users with roles from profiles:",c),y(c.filter(a=>null!==a))}catch(a){throw console.error("Error loading users from profiles:",a),a}};g().useEffect(()=>{ai()},[]);let ak=()=>{S(!0);let a="ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz23456789!@#$%^&*",b="";for(let c=0;c<12;c++)b+=a[Math.floor(Math.random()*a.length)];d(a=>({...a,password:b})),S(!1)},al=async a=>{ae(a.id);try{let{data:c,error:d}=await j.N.functions.invoke("reset-user-password",{body:{user_id:a.id}});if(d)return void b({title:"Error resetting password",description:d.message,variant:"destructive"});c?.success&&(ag({open:!0,user:a,newPassword:c.new_password}),b({title:"Password reset successfully",description:"New password has been generated"}))}catch(a){console.error("Error resetting password:",a),b({title:"Error resetting password",description:"An unexpected error occurred",variant:"destructive"})}finally{ae(null)}},am=async a=>{try{await navigator.clipboard.writeText(a),b({title:"Password copied",description:"Password has been copied to clipboard"})}catch(a){console.error("Failed to copy password:",a),b({title:"Copy failed",description:"Failed to copy password to clipboard",variant:"destructive"})}},an=async a=>{if(a){W(a);try{let{error:c}=await j.N.functions.invoke("delete-user",{body:{user_id:a}});if(c)throw c;b({title:"User deleted successfully",description:"The user has been removed from the system."}),ai()}catch(a){console.error("Error deleting user:",a),b({title:"Error deleting user",description:a.message||"Failed to delete user. Please try again.",variant:"destructive"})}finally{W(null)}}},ao=async(a,c)=>{if(a&&c){Y(a);try{let{error:d}=await j.N.functions.invoke("update-user-role",{body:{user_id:a,role_slug:c}});if(d)throw d;b({title:"Role updated successfully",description:`User role has been updated to ${ah.find(a=>a.value===c)?.label}.`}),ai()}catch(a){console.error("Error updating user role:",a),b({title:"Error updating role",description:a.message||"Failed to update user role. Please try again.",variant:"destructive"})}finally{Y(null)}}},ap=async a=>{if(a.preventDefault(),Z){ac(!0);try{let{error:a}=await j.N.from("profiles").update({full_name:Z.full_name,phone:Z.phone}).eq("id",Z.id);if(a)throw a;b({title:"Profile updated successfully",description:"User profile has been updated."}),aa(!1),$(null),ai()}catch(a){console.error("Error updating profile:",a),b({title:"Error updating profile",description:a.message||"Failed to update profile. Please try again.",variant:"destructive"})}finally{ac(!1)}}},aq=async a=>{if(a.preventDefault(),!c.email||!c.password||!c.full_name||!c.role)return void b({title:"Missing information",description:"Please fill in all required fields.",variant:"destructive"});if(c.password.length<8)return void b({title:"Password too short",description:"Password must be at least 8 characters long.",variant:"destructive"});w(!0);try{console.log("Creating user with data:",{email:c.email,full_name:c.full_name,role_slug:c.role});let{data:a,error:e}=await j.N.functions.invoke("create-user",{body:{email:c.email,password:c.password,role_slug:c.role,full_name:c.full_name}});if(console.log("Function response:",{data:a,error:e}),e)throw e;b({title:"User created successfully",description:`User ${c.email} has been created with ${ah.find(a=>a.value===c.role)?.label} role.`}),d({email:"",password:"",full_name:"",role:""}),Q(!1),ai()}catch(a){b({title:"Error creating user",description:a.message||"Failed to create user. Please try again.",variant:"destructive"})}finally{w(!1)}},ar=async a=>{if(a.preventDefault(),D!==F)return void b({title:"Password mismatch",description:"New password and confirmation don't match.",variant:"destructive"});if(D.length<8)return void b({title:"Password too short",description:"Password must be at least 8 characters long.",variant:"destructive"});K(!0);try{let{error:a}=await j.N.auth.updateUser({password:D});if(a)throw a;b({title:"Password updated",description:"Your password has been changed successfully."}),C(""),E(""),G(""),M(!1)}catch(a){b({title:"Error changing password",description:a.message||"Failed to change password. Please try again.",variant:"destructive"})}finally{K(!1)}};return(0,e.jsxs)("div",{className:"container mx-auto p-6 space-y-6",children:[(0,e.jsxs)(q.tU,{defaultValue:"account",className:"space-y-6",children:[(0,e.jsxs)(q.j7,{className:"grid w-full grid-cols-2",children:[(0,e.jsx)(q.Xi,{value:"account",children:"Account Settings"}),(0,e.jsx)(q.Xi,{value:"security",children:"Security"})]}),(0,e.jsx)(q.av,{value:"account",className:"space-y-6",children:(0,e.jsx)("div",{className:"grid gap-6",children:(0,e.jsxs)(n.Zp,{children:[(0,e.jsxs)(n.aR,{children:[(0,e.jsxs)(n.ZB,{className:"flex items-center gap-2",children:[(0,e.jsx)(u.KJW,{className:"h-5 w-5"}),"Account Settings"]}),(0,e.jsx)(n.BT,{children:"Manage your account preferences and security settings"})]}),(0,e.jsxs)(n.Wu,{className:"space-y-6",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,e.jsxs)("div",{className:"flex items-center gap-3",children:[(0,e.jsx)(u.Uzy,{className:"h-5 w-5 text-muted-foreground"}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h4",{className:"font-medium",children:"Change Password"}),(0,e.jsx)("p",{className:"text-sm text-muted-foreground",children:"Update your account password"})]})]}),(0,e.jsxs)(s.lG,{open:L,onOpenChange:M,children:[(0,e.jsx)(s.zM,{asChild:!0,children:(0,e.jsx)(k.$,{variant:"outline",children:"Change Password"})}),(0,e.jsxs)(s.Cf,{children:[(0,e.jsxs)(s.c7,{children:[(0,e.jsx)(s.L3,{children:"Change Password"}),(0,e.jsx)(s.rr,{children:"Update your account password for security"})]}),(0,e.jsxs)("form",{onSubmit:ar,className:"space-y-4",children:[(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(m.J,{htmlFor:"new_password",children:"New Password"}),(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)(l.p,{id:"new_password",type:H?"text":"password",value:D,onChange:a=>E(a.target.value),placeholder:"Enter new password",className:"pr-10",required:!0}),(0,e.jsx)(k.$,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>I(!H),children:H?(0,e.jsx)(u.X_F,{className:"h-4 w-4"}):(0,e.jsx)(u.kU3,{className:"h-4 w-4"})})]})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(m.J,{htmlFor:"confirm_password",children:"Confirm New Password"}),(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)(l.p,{id:"confirm_password",type:H?"text":"password",value:F,onChange:a=>G(a.target.value),placeholder:"Confirm new password",className:"pr-10",required:!0}),(0,e.jsx)(k.$,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>I(!H),children:H?(0,e.jsx)(u.X_F,{className:"h-4 w-4"}):(0,e.jsx)(u.kU3,{className:"h-4 w-4"})})]})]}),(0,e.jsxs)(o.Fc,{children:[(0,e.jsx)(u.RIJ,{className:"h-4 w-4"}),(0,e.jsx)(o.TN,{children:"Password must be at least 8 characters long and contain a mix of letters, numbers, and symbols."})]}),(0,e.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,e.jsx)(k.$,{type:"button",variant:"outline",onClick:()=>M(!1),children:"Cancel"}),(0,e.jsxs)(k.$,{type:"submit",disabled:J,children:[J?(0,e.jsx)("div",{className:"h-4 w-4 mr-2 animate-spin rounded-full border-2 border-current border-t-transparent"}):(0,e.jsx)(u.eMP,{className:"h-4 w-4 mr-2"}),"Change Password"]})]})]})]})]})]}),(0,e.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,e.jsxs)("div",{className:"flex items-center gap-3",children:[(0,e.jsx)(u.ekZ,{className:"h-5 w-5 text-muted-foreground"}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h4",{className:"font-medium",children:"Two-Factor Authentication"}),(0,e.jsx)("p",{className:"text-sm text-muted-foreground",children:"Add an extra layer of security to your account"})]})]}),(0,e.jsx)(k.$,{variant:"outline",children:"Enable 2FA"})]}),(0,e.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,e.jsxs)("div",{className:"flex items-center gap-3",children:[(0,e.jsx)(u.KJW,{className:"h-5 w-5 text-muted-foreground"}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h4",{className:"font-medium",children:"Notification Preferences"}),(0,e.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage your email and push notification preferences"})]})]}),(0,e.jsx)(k.$,{variant:"outline",children:"Configure"})]})]})]})})}),(0,e.jsx)(q.av,{value:"security",className:"space-y-6",children:(0,e.jsxs)("div",{className:"grid gap-6",children:[(0,e.jsx)(n.Zp,{children:(0,e.jsxs)(n.Wu,{className:"pt-6",children:[(0,e.jsxs)(s.lG,{open:P,onOpenChange:a=>{Q(a),a&&ak()},children:[(0,e.jsx)(s.zM,{asChild:!0,children:(0,e.jsxs)(k.$,{size:"sm",children:[(0,e.jsx)(u.ypN,{className:"h-4 w-4 mr-2"}),"Create User Account"]})}),(0,e.jsxs)(s.Cf,{className:"sm:max-w-[800px]",children:[(0,e.jsxs)(s.c7,{children:[(0,e.jsx)(s.L3,{children:"Create User Account"}),(0,e.jsx)(s.rr,{children:"Create new user accounts with specific roles and permissions"})]}),(0,e.jsxs)("form",{onSubmit:aq,className:"space-y-4",children:[(0,e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(m.J,{htmlFor:"user_email",children:"Email Address *"}),(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)(u.gE4,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,e.jsx)(l.p,{id:"user_email",type:"email",value:c.email,onChange:a=>d(b=>({...b,email:a.target.value})),placeholder:"user@example.com",className:"pl-10",required:!0})]})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(m.J,{htmlFor:"user_password",children:"Password *"}),(0,e.jsxs)("div",{className:"flex gap-2",children:[(0,e.jsxs)("div",{className:"relative flex-1",children:[(0,e.jsx)(u.Uzy,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,e.jsx)(l.p,{id:"user_password",type:T?"text":"password",value:c.password,onChange:a=>d(b=>({...b,password:a.target.value})),placeholder:"Enter password",className:"pl-10 pr-10",required:!0}),(0,e.jsx)(k.$,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>U(!T),children:T?(0,e.jsx)(u.X_F,{className:"h-4 w-4 text-muted-foreground"}):(0,e.jsx)(u.kU3,{className:"h-4 w-4 text-muted-foreground"})})]}),(0,e.jsx)(k.$,{type:"button",variant:"outline",size:"sm",onClick:ak,disabled:R,children:R?"...":"Generate"})]})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(m.J,{htmlFor:"user_name",children:"Full Name *"}),(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)(u.zWC,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,e.jsx)(l.p,{id:"user_name",value:c.full_name,onChange:a=>d(b=>({...b,full_name:a.target.value})),placeholder:"Enter full name",className:"pl-10",required:!0})]})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(m.J,{htmlFor:"user_role",children:"Role *"}),(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)(u.ekZ,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,e.jsxs)(t.l6,{value:c.role,onValueChange:a=>d(b=>({...b,role:a})),children:[(0,e.jsx)(t.bq,{className:"pl-10",children:(0,e.jsx)(t.yv,{placeholder:"Select a role"})}),(0,e.jsx)(t.gC,{children:ah.map(a=>(0,e.jsx)(t.eb,{value:a.value,children:(0,e.jsxs)("div",{className:"flex flex-col",children:[(0,e.jsx)("span",{className:"font-medium",children:a.label}),(0,e.jsx)("span",{className:"text-xs text-muted-foreground",children:a.description})]})},a.value))})]})]})]})]}),(0,e.jsxs)(o.Fc,{children:[(0,e.jsx)(u.RIJ,{className:"h-4 w-4"}),(0,e.jsx)(o.TN,{children:"The new user will receive an email with login instructions. Password must be at least 8 characters long."})]})]}),(0,e.jsxs)(s.Es,{children:[(0,e.jsx)(k.$,{type:"button",variant:"outline",onClick:()=>Q(!1),disabled:v,children:"Cancel"}),(0,e.jsxs)(k.$,{type:"submit",onClick:aq,disabled:v,children:[v?(0,e.jsx)("div",{className:"h-4 w-4 mr-2 animate-spin rounded-full border-2 border-current border-t-transparent"}):(0,e.jsx)(u.ypN,{className:"h-4 w-4 mr-2"}),"Create User Account"]})]})]})]}),(0,e.jsx)(s.lG,{open:_,onOpenChange:aa,children:(0,e.jsxs)(s.Cf,{className:"sm:max-w-[500px]",children:[(0,e.jsxs)(s.c7,{children:[(0,e.jsx)(s.L3,{children:"Edit User Profile"}),(0,e.jsx)(s.rr,{children:"Update user profile information"})]}),Z&&(0,e.jsxs)("form",{onSubmit:ap,className:"space-y-4",children:[(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(m.J,{htmlFor:"edit_full_name",children:"Full Name"}),(0,e.jsx)(l.p,{id:"edit_full_name",value:Z.full_name||"",onChange:a=>$(b=>({...b,full_name:a.target.value})),placeholder:"Enter full name",required:!0})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(m.J,{htmlFor:"edit_email",children:"Email"}),(0,e.jsx)(l.p,{id:"edit_email",value:Z.email||"",disabled:!0,className:"bg-muted"}),(0,e.jsx)("p",{className:"text-xs text-muted-foreground",children:"Email cannot be changed"})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(m.J,{htmlFor:"edit_phone",children:"Phone"}),(0,e.jsx)(l.p,{id:"edit_phone",value:Z.phone||"",onChange:a=>$(b=>({...b,phone:a.target.value})),placeholder:"Enter phone number"})]})]}),(0,e.jsxs)(s.Es,{children:[(0,e.jsx)(k.$,{type:"button",variant:"outline",onClick:()=>aa(!1),disabled:ab,children:"Cancel"}),(0,e.jsxs)(k.$,{type:"submit",onClick:ap,disabled:ab,children:[ab?(0,e.jsx)("div",{className:"h-4 w-4 mr-2 animate-spin rounded-full border-2 border-current border-t-transparent"}):(0,e.jsx)(u.eMP,{className:"h-4 w-4 mr-2"}),"Update Profile"]})]})]})})]})}),(0,e.jsxs)(n.Zp,{children:[(0,e.jsxs)(n.aR,{children:[(0,e.jsxs)(n.ZB,{className:"flex items-center gap-2",children:[(0,e.jsx)(u.zWC,{className:"h-5 w-5"}),"Existing Users"]}),(0,e.jsx)(n.BT,{children:"Manage existing users and their roles"})]}),(0,e.jsx)(n.Wu,{children:z?(0,e.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,e.jsx)("div",{className:"h-6 w-6 animate-spin rounded-full border-2 border-current border-t-transparent"}),(0,e.jsx)("span",{className:"ml-2",children:"Loading users..."})]}):(0,e.jsx)("div",{className:"rounded-md border",children:(0,e.jsxs)(r.XI,{children:[(0,e.jsx)(r.A0,{children:(0,e.jsxs)(r.Hj,{children:[(0,e.jsx)(r.nd,{children:"Name"}),(0,e.jsx)(r.nd,{children:"Email"}),(0,e.jsx)(r.nd,{children:"Role"}),(0,e.jsx)(r.nd,{children:"Phone"}),(0,e.jsx)(r.nd,{children:"Created"}),(0,e.jsx)(r.nd,{children:"Status"}),(0,e.jsx)(r.nd,{children:"Actions"})]})}),(0,e.jsx)(r.BF,{children:0===x.length?(0,e.jsx)(r.Hj,{children:(0,e.jsx)(r.nA,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No users found"})}):x.map((a,b)=>(0,e.jsxs)(r.Hj,{children:[(0,e.jsx)(r.nA,{className:"font-medium",children:a.full_name||"N/A"}),(0,e.jsx)(r.nA,{children:a.email}),(0,e.jsx)(r.nA,{children:(0,e.jsx)(p.E,{variant:"secondary",children:a.user_roles?.[0]?.roles?.name||(a=>{let b=ah.find(b=>b.value===a);return b?.label||a})(a.roles?.[0]||a.user_roles?.[0]?.role_slug||"")||"No Role"})}),(0,e.jsx)(r.nA,{children:a.phone||"N/A"}),(0,e.jsx)(r.nA,{children:a.created_at?new Date(a.created_at).toLocaleDateString():"N/A"}),(0,e.jsx)(r.nA,{children:(0,e.jsx)(p.E,{variant:"default",children:"Active"})}),(0,e.jsx)(r.nA,{children:(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[(0,e.jsxs)(t.l6,{value:a.user_roles?.[0]?.role_slug||a.roles?.[0]||"",onValueChange:b=>ao(a.id,b),disabled:X===a.id,children:[(0,e.jsx)(t.bq,{className:"w-32",children:(0,e.jsx)(t.yv,{placeholder:"Role"})}),(0,e.jsx)(t.gC,{children:ah.map(a=>(0,e.jsx)(t.eb,{value:a.value,children:a.label},a.value))})]}),(0,e.jsx)(k.$,{variant:"ghost",size:"sm",onClick:()=>{$({...a}),aa(!0)},className:"text-blue-600 hover:text-blue-700",children:(0,e.jsx)(u.ffu,{className:"h-4 w-4"})}),(0,e.jsx)(k.$,{variant:"ghost",size:"sm",onClick:()=>al(a),disabled:ad===a.id,className:"text-orange-600 hover:text-orange-700",title:"Reset Password",children:ad===a.id?(0,e.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}):(0,e.jsx)(u.Uzy,{className:"h-4 w-4"})}),(0,e.jsx)(k.$,{variant:"ghost",size:"sm",onClick:()=>an(a.id),disabled:V===a.id,className:"text-destructive hover:text-destructive",children:V===a.id?(0,e.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}):(0,e.jsx)(u.TBR,{className:"h-4 w-4"})})]})})]},a.id||`user-${b}`))})]})})})]})]})})]}),(0,e.jsx)(s.lG,{open:af.open,onOpenChange:a=>ag(b=>({...b,open:a})),children:(0,e.jsxs)(s.Cf,{className:"sm:max-w-[500px]",children:[(0,e.jsxs)(s.c7,{children:[(0,e.jsx)(s.L3,{children:"Password Reset Successful"}),(0,e.jsxs)(s.rr,{children:["A new password has been generated for"," ",af.user?.full_name||af.user?.email]})]}),(0,e.jsx)("div",{className:"space-y-4",children:(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(m.J,{htmlFor:"new_password",children:"New Password"}),(0,e.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,e.jsx)(l.p,{id:"new_password",value:af.newPassword,readOnly:!0,className:"font-mono"}),(0,e.jsx)(k.$,{type:"button",variant:"outline",size:"sm",onClick:()=>am(af.newPassword),children:(0,e.jsx)(u.QRo,{className:"h-4 w-4"})})]}),(0,e.jsx)("p",{className:"text-xs text-muted-foreground",children:"Please share this password securely with the user. They should change it on their first login."})]})}),(0,e.jsx)(s.Es,{children:(0,e.jsx)(k.$,{type:"button",onClick:()=>ag({open:!1,user:null,newPassword:""}),children:"Close"})})]})})]})};d()}catch(a){d(a)}})},75979:a=>{a.exports=import("tailwind-merge")},78059:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{p:()=>i});var e=c(8732),f=c(82015),g=c(87092),h=a([g]);g=(h.then?(await h)():h)[0];let i=f.forwardRef(({className:a,type:b,onAddItem:c,onRemoveItem:d,showAddButton:f,showRemoveButton:h,addButtonLabel:i,removeButtonLabel:j,...k},l)=>(0,e.jsxs)("div",{className:f||h?"flex items-center gap-2":"",children:[(0,e.jsx)("input",{type:b,className:(0,g.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus:outline-none focus:ring-0 focus-visible:ring-0 focus:ring-offset-0 focus-visible:ring-offset-0 focus:border-ring focus-visible:border-ring disabled:cursor-not-allowed disabled:opacity-50 transition-colors",a),ref:l,onKeyDown:c?a=>{"Enter"===a.key&&c&&(a.preventDefault(),c())}:void 0,...k}),f&&c&&(0,e.jsx)("button",{type:"button",className:"inline-flex h-10 items-center justify-center rounded-md bg-primary px-3 py-2 text-sm font-medium text-primary-foreground hover:bg-primary/90",onClick:c,children:i||"Add"}),h&&d&&(0,e.jsx)("button",{type:"button",className:"inline-flex h-10 items-center justify-center rounded-md bg-destructive px-3 py-2 text-sm font-medium text-destructive-foreground hover:bg-destructive/90",onClick:d,children:j||"Remove"})]}));i.displayName="Input",d()}catch(a){d(a)}})},82015:a=>{a.exports=require("react")},93939:a=>{a.exports=require("@supabase/supabase-js")},94433:(a,b,c)=>{c.d(b,{A:()=>g});var d=c(82015),e=c(95965),f=c(88266);function g(){let[a,b]=(0,d.useState)(null),[c,g]=(0,d.useState)(!0);return{user:a,loading:c,signOut:async()=>{try{f.T.setLoggingOut(!0),await e.N.auth.signOut({scope:"local"}),f.T.clearCache();try{localStorage.removeItem("supabase.auth.token")}catch{}try{sessionStorage.removeItem("supabase.auth.token")}catch{}}catch(a){console.error("Error signing out:",a)}finally{f.T.setLoggingOut(!1)}},isAuthenticated:!!a}}c(51577)}};var b=require("../webpack-runtime.js");b.C(a);var c=b.X(0,[4952,5611,5781,4780],()=>b(b.s=12479));module.exports=c})();