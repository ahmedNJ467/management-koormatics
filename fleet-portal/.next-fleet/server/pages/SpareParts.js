"use strict";(()=>{var a={};a.id=2549,a.ids=[636,2549,3220],a.modules={4720:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{E:()=>i});var e=c(8732);c(82015);var f=c(8938),g=c(87092),h=a([f,g]);[f,g]=h.then?(await h)():h;let j=(0,f.cva)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i({className:a,variant:b,...c}){return(0,e.jsx)("div",{className:(0,g.cn)(j({variant:b}),a),...c})}d()}catch(a){d(a)}})},8732:a=>{a.exports=require("react/jsx-runtime")},8938:a=>{a.exports=import("class-variance-authority")},9640:a=>{a.exports=import("@radix-ui/react-slot")},11564:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{P:()=>i});var e=c(8732),f=c(52307),g=c(78059),h=a([f,g]);[f,g]=h.then?(await h)():h;let i=({form:a})=>(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsx)("h3",{className:"text-lg font-semibold border-b pb-2",children:"Inventory Details"}),(0,e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,e.jsx)(f.zB,{control:a.control,name:"manufacturer",render:({field:a})=>(0,e.jsxs)(f.eI,{children:[(0,e.jsx)(f.lR,{children:"Manufacturer *"}),(0,e.jsx)(f.MJ,{children:(0,e.jsx)(g.p,{placeholder:"Enter manufacturer",...a})}),(0,e.jsx)(f.C5,{})]})}),(0,e.jsx)(f.zB,{control:a.control,name:"location",render:({field:a})=>(0,e.jsxs)(f.eI,{children:[(0,e.jsx)(f.lR,{children:"Storage Location *"}),(0,e.jsx)(f.MJ,{children:(0,e.jsx)(g.p,{placeholder:"Enter storage location",...a})}),(0,e.jsx)(f.C5,{})]})})]}),(0,e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,e.jsx)(f.zB,{control:a.control,name:"quantity",render:({field:a})=>(0,e.jsxs)(f.eI,{children:[(0,e.jsx)(f.lR,{children:"Quantity *"}),(0,e.jsx)(f.MJ,{children:(0,e.jsx)(g.p,{type:"number",min:"0",placeholder:"Enter quantity",...a,onChange:b=>a.onChange(Number(b.target.value))})}),(0,e.jsx)(f.C5,{})]})}),(0,e.jsx)(f.zB,{control:a.control,name:"min_stock_level",render:({field:a})=>(0,e.jsxs)(f.eI,{children:[(0,e.jsx)(f.lR,{children:"Min Stock Level *"}),(0,e.jsx)(f.MJ,{children:(0,e.jsx)(g.p,{type:"number",min:"0",placeholder:"Enter minimum stock level",...a,onChange:b=>a.onChange(Number(b.target.value))})}),(0,e.jsx)(f.C5,{})]})}),(0,e.jsx)(f.zB,{control:a.control,name:"unit_price",render:({field:a})=>(0,e.jsxs)(f.eI,{children:[(0,e.jsx)(f.lR,{children:"Unit Price ($) *"}),(0,e.jsx)(f.MJ,{children:(0,e.jsx)(g.p,{type:"number",min:"0",step:"0.01",placeholder:"Enter unit price",...a,onChange:b=>a.onChange(Number(b.target.value))})}),(0,e.jsx)(f.C5,{})]})})]}),(0,e.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(0,e.jsx)(f.zB,{control:a.control,name:"purchase_date",render:({field:a})=>(0,e.jsxs)(f.eI,{children:[(0,e.jsx)(f.lR,{children:"Purchase Date"}),(0,e.jsx)(f.MJ,{children:(0,e.jsx)(g.p,{type:"date",placeholder:"Select purchase date",...a})}),(0,e.jsx)(f.C5,{})]})})})]});d()}catch(a){d(a)}})},13020:a=>{a.exports=import("@radix-ui/react-dialog")},14505:a=>{a.exports=import("@radix-ui/react-scroll-area")},14724:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{v:()=>l});var e=c(28462),f=c(95965),g=c(76569),h=c(90894),i=c(38500),j=c(19483),k=a([e]);e=(k.then?(await k)():k)[0];let l=()=>{let{toast:a}=(0,g.dj)(),b=(0,e.useQueryClient)();return(0,e.useMutation)({mutationFn:async({updatedPart:b,partId:c})=>{if(!c)throw Error("No part selected");console.log("Updating part:",b,"for ID:",c);let d={name:b.name,part_number:b.part_number,category:b.category,manufacturer:b.manufacturer,quantity:b.quantity,unit_price:b.unit_price,location:b.location,status:(0,j.y)(b.quantity,b.min_stock_level),min_stock_level:b.min_stock_level,purchase_date:b.purchase_date||null,compatibility:b.compatibility||[]};console.log("Updating part data:",d);let{data:e,error:g}=await f.N.from("spare_parts").update(d).eq("id",c).select().single();if(g)throw console.error("Error updating part:",g),g;if(void 0!==b.notes&&await (0,i.I)(c,b.notes),console.log("Part updated successfully:",e),b.part_image instanceof File){if(!await (0,h.x8)())return console.log("part_image column does not exist in the database"),a({title:"Image upload skipped",description:"The part was updated but the database doesn't support image uploads",variant:"default"}),e;let d=await (0,h.CL)(b.part_image,c,b=>{a({title:"Image upload failed",description:b,variant:"destructive"})});d&&await (0,h.VY)(c,d,b=>{a({title:"Image path update failed",description:b,variant:"destructive"})})}return e},onSuccess:()=>{b.invalidateQueries({queryKey:["spare_parts"]}),a({title:"Part updated successfully",description:"The part details have been updated."})},onError:b=>{console.error("Error updating part:",b),a({title:"Failed to update part",description:b instanceof Error?b.message:"An unknown error occurred",variant:"destructive"})}})};d()}catch(a){d(a)}})},16235:a=>{a.exports=import("@radix-ui/react-toast")},19483:(a,b,c)=>{c.d(b,{y:()=>d});let d=(a,b)=>a<=0?"out_of_stock":a<=b?"low_stock":"in_stock"},20598:a=>{a.exports=import("@radix-ui/react-label")},20714:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{b:()=>i});var e=c(8732),f=c(52307),g=c(78059),h=a([f,g]);[f,g]=h.then?(await h)():h;let i=({form:a})=>(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsx)("h3",{className:"text-lg font-semibold border-b pb-2",children:"Basic Information"}),(0,e.jsx)(f.zB,{control:a.control,name:"name",render:({field:a})=>(0,e.jsxs)(f.eI,{children:[(0,e.jsx)(f.lR,{children:"Part Name *"}),(0,e.jsx)(f.MJ,{children:(0,e.jsx)(g.p,{placeholder:"Enter part name",...a})}),(0,e.jsx)(f.C5,{})]})}),(0,e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,e.jsx)(f.zB,{control:a.control,name:"part_number",render:({field:a})=>(0,e.jsxs)(f.eI,{children:[(0,e.jsx)(f.lR,{children:"Part Number *"}),(0,e.jsx)(f.MJ,{children:(0,e.jsx)(g.p,{placeholder:"Enter part number",...a})}),(0,e.jsx)(f.C5,{})]})}),(0,e.jsx)(f.zB,{control:a.control,name:"category",render:({field:a})=>(0,e.jsxs)(f.eI,{children:[(0,e.jsx)(f.lR,{children:"Category *"}),(0,e.jsx)(f.MJ,{children:(0,e.jsx)(g.p,{placeholder:"Enter category",...a})}),(0,e.jsx)(f.C5,{})]})})]})]});d()}catch(a){d(a)}})},20791:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{O:()=>m});var e=c(42472),f=c(14724),g=c(74038),h=c(19483),i=c(82015),j=c(95965),k=c(90894),l=a([e,f,g]);[e,f,g]=l.then?(await l)():l;let m=()=>{let[a,b]=(0,i.useState)(null);(0,i.useEffect)(()=>{(async()=>{try{let{data:a,error:c}=await j.N.storage.from("images").list();if(c){console.error("Storage availability check failed:",c),b(!1);return}try{if(!await (0,k.IT)()){console.error("Failed to create or verify parts directory"),b(!1);return}b(!0)}catch(a){console.error("Error creating parts directory:",a),b(!1)}}catch(a){console.error("Error checking storage:",a),b(!1)}})()},[]);let c=(0,e.d)(),d=(0,f.v)(),l=(0,g.J)();return{addPartMutation:c,updatePartMutation:d,deletePartMutation:l,getStatusFromQuantity:h.y,isStorageAvailable:a}};d()}catch(a){d(a)}})},21670:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{P:()=>k});var e=c(8732),f=c(48383),g=c(4720),h=c(66345),i=c(74952),j=a([f,g,h]);[f,g,h]=j.then?(await j)():j;let k=({parts:a,onEdit:b,onDelete:c,isLoading:d,onSort:j,sortConfig:k})=>{if(d)return(0,e.jsx)("div",{className:"flex justify-center items-center h-48",children:(0,e.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-primary"})});if(0===a.length)return(0,e.jsxs)("div",{className:"text-center py-8 bg-gray-50 dark:bg-gray-800/50 rounded border",children:[(0,e.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:"No parts found"}),(0,e.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"No spare parts match your current search or filter criteria."})]});let l=({column:a})=>k.column!==a?(0,e.jsx)(i.hDL,{className:"h-3 w-3 ml-1 opacity-50"}):"asc"===k.direction?(0,e.jsx)(i.hDL,{className:"h-3 w-3 ml-1 text-primary"}):(0,e.jsx)(i.hDL,{className:"h-3 w-3 ml-1 text-primary rotate-180"});return(0,e.jsx)("div",{className:"border rounded overflow-x-auto",children:(0,e.jsxs)(f.XI,{children:[(0,e.jsx)(f.A0,{children:(0,e.jsxs)(f.Hj,{children:[(0,e.jsx)(f.nd,{className:"cursor-pointer min-w-[200px]",onClick:()=>j("name"),children:(0,e.jsxs)("div",{className:"flex items-center",children:["Part Name ",(0,e.jsx)(l,{column:"name"})]})}),(0,e.jsx)(f.nd,{className:"cursor-pointer min-w-[140px]",onClick:()=>j("part_number"),children:(0,e.jsxs)("div",{className:"flex items-center",children:["Part Number ",(0,e.jsx)(l,{column:"part_number"})]})}),(0,e.jsx)(f.nd,{className:"cursor-pointer min-w-[120px]",onClick:()=>j("category"),children:(0,e.jsxs)("div",{className:"flex items-center",children:["Category ",(0,e.jsx)(l,{column:"category"})]})}),(0,e.jsx)(f.nd,{className:"cursor-pointer min-w-[140px]",onClick:()=>j("manufacturer"),children:(0,e.jsxs)("div",{className:"flex items-center",children:["Manufacturer ",(0,e.jsx)(l,{column:"manufacturer"})]})}),(0,e.jsx)(f.nd,{className:"text-right cursor-pointer min-w-[100px]",onClick:()=>j("quantity"),children:(0,e.jsxs)("div",{className:"flex items-center justify-end",children:["Stock ",(0,e.jsx)(l,{column:"quantity"})]})}),(0,e.jsx)(f.nd,{className:"text-right cursor-pointer min-w-[100px]",onClick:()=>j("unit_price"),children:(0,e.jsxs)("div",{className:"flex items-center justify-end",children:["Price ",(0,e.jsx)(l,{column:"unit_price"})]})}),(0,e.jsx)(f.nd,{className:"min-w-[120px]",children:"Stock Status"}),(0,e.jsx)(f.nd,{className:"min-w-[100px]",children:"Actions"})]})}),(0,e.jsx)(f.BF,{children:a.map(a=>{let d=(a=>a.quantity<=0?{label:"Out of Stock",variant:"destructive",color:"text-red-600 dark:text-red-400"}:a.quantity<=a.min_stock_level?{label:"Low Stock",variant:"secondary",color:"text-yellow-600 dark:text-yellow-400"}:{label:"In Stock",variant:"default",color:"text-green-600 dark:text-green-400"})(a);return(0,e.jsxs)(f.Hj,{className:"hover:bg-gray-50 dark:hover:bg-gray-800/50",children:[(0,e.jsx)(f.nA,{className:"font-medium py-3",children:a.name}),(0,e.jsx)(f.nA,{className:"font-mono text-sm py-3",children:a.part_number}),(0,e.jsx)(f.nA,{className:"py-3",children:(0,e.jsx)(g.E,{variant:"outline",className:"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-200 border-gray-200 dark:border-gray-600",children:a.category})}),(0,e.jsx)(f.nA,{className:"py-3",children:a.manufacturer}),(0,e.jsx)(f.nA,{className:"text-right font-semibold py-3",children:a.quantity}),(0,e.jsxs)(f.nA,{className:"text-right py-3",children:["$",a.unit_price.toFixed(2)]}),(0,e.jsx)(f.nA,{className:"py-3",children:(0,e.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,e.jsx)(g.E,{variant:d.variant,className:d.color,children:d.label}),(0,e.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Min: ",a.min_stock_level]})]})}),(0,e.jsx)(f.nA,{className:"py-3",children:(0,e.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,e.jsx)(h.$,{variant:"ghost",size:"sm",onClick:()=>b(a),title:"Edit part",className:"h-8 w-8 p-0 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20",children:(0,e.jsx)(i.ffu,{className:"h-4 w-4"})}),(0,e.jsx)(h.$,{variant:"ghost",size:"sm",onClick:()=>c(a),title:"Delete part",className:"h-8 w-8 p-0 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20",children:(0,e.jsx)(i.TBR,{className:"h-4 w-4"})})]})})]},a.id)})})]})})};d()}catch(a){d(a)}})},24515:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{t:()=>g});var e=c(42971),f=a([e]);let g=(e=(f.then?(await f)():f)[0]).z.object({name:e.z.string().min(1,"Part name is required"),part_number:e.z.string().min(1,"Part number is required"),category:e.z.string().min(1,"Category is required"),manufacturer:e.z.string().min(1,"Manufacturer is required"),quantity:e.z.number().min(0,"Quantity cannot be negative"),unit_price:e.z.number().min(0,"Price cannot be negative"),location:e.z.string().min(1,"Storage location is required"),min_stock_level:e.z.number().min(0,"Minimum stock level cannot be negative"),purchase_date:e.z.string().optional(),compatibility:e.z.array(e.z.string()).optional().default([]),part_image:e.z.any().optional(),notes:e.z.string().optional().default("")});d()}catch(a){d(a)}})},27503:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{K:()=>t});var e=c(8732),f=c(56884),g=c(98825),h=c(52307),i=c(94142),j=c(24515),k=c(20714),l=c(11564),m=c(87320),n=c(59921),o=c(55752),p=c(50899),q=c(57657),r=c(82015),s=a([f,g,h,i,j,k,l,m,n,o,p]);[f,g,h,i,j,k,l,m,n,o,p]=s.then?(await s)():s;let t=({onSubmit:a,onCancel:b,isSubmitting:c,defaultValues:d,existingImage:s})=>{let{previewUrl:t,setPreviewUrl:u,handleImageChange:v}=(0,q.X)(s),w=(0,f.useForm)({resolver:(0,g.zodResolver)(j.t),defaultValues:{name:d?.name||"",part_number:d?.part_number||"",category:d?.category||"",manufacturer:d?.manufacturer||"",quantity:d?.quantity||0,unit_price:d?.unit_price||0,location:d?.location||"",min_stock_level:d?.min_stock_level||5,purchase_date:d?.purchase_date||"",compatibility:d?.compatibility||[],notes:d?.notes||""}});return(0,r.useEffect)(()=>{s&&w.setValue("part_image",void 0)},[s,w]),(0,e.jsx)(h.lV,{...w,children:(0,e.jsxs)("form",{onSubmit:w.handleSubmit(b=>{a(b)}),className:"flex flex-col h-full min-h-0",children:[(0,e.jsx)(i.F,{className:"flex-1 h-full pr-3",children:(0,e.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 pb-4",children:[(0,e.jsxs)("div",{className:"space-y-6",children:[(0,e.jsx)(k.b,{form:w}),(0,e.jsx)(l.P,{form:w}),(0,e.jsx)(n.K,{form:w}),(0,e.jsx)(o.$,{form:w})]}),(0,e.jsx)("div",{className:"space-y-6",children:(0,e.jsx)(m.B,{imageInputRef:w.register("part_image"),existingImage:s,previewUrl:t,setPreviewUrl:u,handleImageChange:v,form:w})})]})}),(0,e.jsx)(p.I,{onCancel:b,isSubmitting:c,defaultValues:d})]})})};d()}catch(a){d(a)}})},28462:a=>{a.exports=import("@tanstack/react-query")},29419:(a,b,c)=>{c.d(b,{G:()=>d});let d=(a,b)=>{if(!a||0===a.length)return void console.warn("No data available for CSV export");let c=[...a];"trips-report"===b&&(c=a.map(a=>({...a,client_name:a.clients?.name||"Unknown",client_type:a.clients?.type||"individual",passenger_count:a.passengers?.length||0,passenger_names:a.passengers?.join("; ")||"",vehicle_info:a.vehicles?`${a.vehicles.make||""} ${a.vehicles.model||""}`.trim():"Unassigned",driver_name:a.drivers?.name||"Not assigned",service_display:a.display_type||a.service_type||"Standard"})));let d=(a=>a&&0!==a.length?a.map(a=>{if(null==a)return{};let b={};return Object.entries(a).forEach(([a,c])=>{null===c||"object"!=typeof c||Array.isArray(c)?b[a]=c:Object.entries(c).forEach(([c,d])=>{b[`${a}_${c}`]=d})}),b}):[])(c);if(0===d.length)return void console.warn("No data to export after processing");let e=((a,b)=>{let c={"trips-report":["date","client_name","client_type","service_display","pickup_location","dropoff_location","vehicle_info","driver_name","status","passenger_count","passenger_names","amount"],"vehicles-report":["make","model","year","registration","type","status","color","vin","insurance_expiry","notes"],"drivers-report":["name","contact","email","phone","license_number","license_type","license_expiry","status"],"fuel-report":["date","vehicle_info","fuel_type","volume","cost","mileage","previous_mileage","current_mileage","notes"],"maintenance-report":["date","vehicle_info","description","status","cost","service_provider","next_scheduled","notes"]}[b]||[];return[...c.filter(b=>a.includes(b)),...a.filter(a=>!c.includes(a)).sort()]})(Array.from(new Set(d.flatMap(a=>Object.keys(a)))),b),f=e.map(a=>a.split("_").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" ")),g=new Blob([[[`"${b.replace("-"," ").toUpperCase()} - Generated on ${new Date().toLocaleDateString()}"`],[],f.map(a=>`"${a}"`),...d.map(a=>e.map(b=>{let c=a[b];if(null==c)return'""';if(b.includes("date")||b.includes("expiry"))try{let a=new Date(c);if(!isNaN(a.getTime()))return`"${a.toLocaleDateString()}"`}catch{}if(b.includes("cost")||b.includes("amount")){let a=Number(c);if(!isNaN(a))return`"$${a.toFixed(2)}"`}let d=String(c);return d.includes(",")||d.includes('"')||d.includes("\n")?`"${d.replace(/"/g,'""')}"`:`"${d}"`}))].map(a=>a.join(",")).join("\n")],{type:"text/csv;charset=utf-8;"}),h=URL.createObjectURL(g),i=document.createElement("a");i.setAttribute("href",h),i.setAttribute("download",`${b}_${new Date().toISOString().split("T")[0]}.csv`),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(h)}},32227:(a,b,c)=>{c.d(b,{O:()=>e});var d=c(82015);let e=a=>{let[b,c]=(0,d.useState)(""),e=(0,d.useMemo)(()=>a.filter(a=>a.name.toLowerCase().includes(b.toLowerCase())||a.part_number.toLowerCase().includes(b.toLowerCase())||a.category.toLowerCase().includes(b.toLowerCase())||a.manufacturer.toLowerCase().includes(b.toLowerCase())||a.location.toLowerCase().includes(b.toLowerCase())),[a,b]);return{searchQuery:b,setSearchQuery:c,filteredParts:e}}},33873:a=>{a.exports=require("path")},38500:(a,b,c)=>{c.d(b,{I:()=>e});var d=c(95965);let e=async(a,b)=>{if(void 0===b)return!0;try{let{error:c}=await d.N.rpc("update_part_notes",{part_id:a,notes_value:b});if(c)return console.log("Could not update notes:",c),!1;return!0}catch(a){return console.log("Failed to update notes, field may not exist:",a),!1}}},38661:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{Cf:()=>o,Es:()=>q,HM:()=>m,L3:()=>r,c7:()=>p,lG:()=>j,rr:()=>s,zM:()=>k});var e=c(8732),f=c(82015),g=c(13020),h=c(87092),i=a([g,h]);[g,h]=i.then?(await i)():i;let j=g.Root,k=g.Trigger,l=g.Portal,m=g.Close,n=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Overlay,{ref:c,className:(0,h.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...b}));n.displayName=g.Overlay.displayName;let o=f.forwardRef(({className:a,children:b,...c},d)=>(0,e.jsxs)(l,{children:[(0,e.jsx)(n,{}),(0,e.jsx)(g.Content,{ref:d,className:(0,h.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...c,children:b})]}));o.displayName=g.Content.displayName;let p=({className:a,...b})=>(0,e.jsx)("div",{className:(0,h.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...b});p.displayName="DialogHeader";let q=({className:a,...b})=>(0,e.jsx)("div",{className:(0,h.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...b});q.displayName="DialogFooter";let r=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Title,{ref:c,className:(0,h.cn)("text-lg font-semibold leading-none tracking-tight",a),...b}));r.displayName=g.Title.displayName;let s=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Description,{ref:c,className:(0,h.cn)("text-sm text-muted-foreground",a),...b}));s.displayName=g.Description.displayName,d()}catch(a){d(a)}})},40273:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{J:()=>l});var e=c(8732),f=c(82015),g=c(20598),h=c(8938),i=c(87092),j=a([g,h,i]);[g,h,i]=j.then?(await j)():j;let k=(0,h.cva)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),l=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Root,{ref:c,className:(0,i.cn)(k(),a),...b}));l.displayName=g.Root.displayName,d()}catch(a){d(a)}})},40361:a=>{a.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},40391:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{default:()=>x});var e=c(8732),f=c(82015),g=c(32227),h=c(20791),i=c(71667),j=c(94857),k=c(21670),l=c(92602),m=c(77264),n=c(45503),o=c(29419),p=c(76569),q=c(54269),r=c(74952),s=c(78059),t=c(57049),u=c(66345),v=c(4720),w=a([h,j,k,l,m,n,q,s,t,u,v]);[h,j,k,l,m,n,q,s,t,u,v]=w.then?(await w)():w;let x=()=>{let[a,b]=(0,f.useState)(!1),[c,d]=(0,f.useState)(!1),[w,x]=(0,f.useState)(!1),[y,z]=(0,f.useState)(null),[A,B]=(0,f.useState)("all"),[C,D]=(0,f.useState)("all"),{toast:E}=(0,p.dj)(),{sortConfig:F,handleSort:G}=(0,i.U)(),{data:H=[],isLoading:I,isError:J}=(0,j.T)(F),{addPartMutation:K,updatePartMutation:L,deletePartMutation:M,isStorageAvailable:N}=(0,h.O)(),{searchQuery:O,setSearchQuery:P,filteredParts:Q}=(0,g.O)(H),R=(0,f.useMemo)(()=>{let a=new Set(H.map(a=>a.category));return Array.from(a).sort()},[H]),S=(0,f.useMemo)(()=>{let a=new Set(H.map(a=>a.manufacturer));return Array.from(a).sort()},[H]),T=(0,f.useMemo)(()=>Q.filter(a=>("all"===A||a.category===A)&&("all"===C||a.manufacturer===C)),[Q,A,C]),[U,V]=(0,f.useState)(1),W=Math.ceil((T?.length||0)/25),X=(U-1)*25,Y=X+25,Z=T?.slice(X,Y)||[];(0,f.useEffect)(()=>{V(1)},[A,C]);let $="all"!==A||"all"!==C;return J?(0,e.jsx)("div",{className:"min-h-screen bg-background",children:(0,e.jsxs)("div",{className:"p-4 px-6 space-y-6",children:[(0,e.jsx)("div",{className:"border-b border-border pb-4 pt-4",children:(0,e.jsxs)("div",{children:[(0,e.jsx)("h1",{className:"text-2xl font-semibold text-foreground",children:"Error"}),(0,e.jsx)("p",{className:"text-destructive text-sm mt-1",children:"Failed to load spare parts data. Please try refreshing the page."})]})}),(0,e.jsxs)(q.Fc,{variant:"destructive",children:[(0,e.jsx)(r.hcu,{className:"h-4 w-4"}),(0,e.jsx)(q.XL,{children:"Error"}),(0,e.jsx)(q.TN,{children:"Failed to load spare parts data. Please try refreshing the page."})]})]})}):(0,e.jsx)("div",{className:"min-h-screen bg-background",children:(0,e.jsxs)("div",{className:"p-4 px-6 space-y-6",children:[(0,e.jsx)("div",{className:"border-b border-border pb-4 pt-4",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsx)("div",{children:(0,e.jsx)("h1",{className:"text-2xl font-semibold text-foreground",children:"Spare Parts"})}),(0,e.jsxs)("div",{className:"flex gap-2",children:[(0,e.jsx)(u.$,{variant:"outline",size:"sm",onClick:()=>{try{(0,o.G)(T,"spare-parts-inventory"),E({title:"Export successful",description:`Exported ${T.length} spare parts to CSV`})}catch(a){console.error("Export error:",a),E({title:"Export failed",description:"There was an error exporting the data",variant:"destructive"})}},children:"Export"}),(0,e.jsx)(u.$,{onClick:()=>b(!0),size:"sm",children:"Add Part"})]})]})}),(0,e.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-center",children:[(0,e.jsx)("div",{className:"flex-1",children:(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)(r.vji,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),(0,e.jsx)(s.p,{placeholder:"Search by part name, category, or manufacturer...",value:O,onChange:a=>P(a.target.value),className:"pl-8"})]})}),(0,e.jsxs)(t.l6,{value:A,onValueChange:B,children:[(0,e.jsx)(t.bq,{className:"w-[160px]",children:(0,e.jsx)(t.yv,{placeholder:"All Categories"})}),(0,e.jsxs)(t.gC,{children:[(0,e.jsx)(t.eb,{value:"all",children:"All Categories"}),R.map(a=>(0,e.jsx)(t.eb,{value:a,children:a},a))]})]}),(0,e.jsxs)(t.l6,{value:C,onValueChange:D,children:[(0,e.jsx)(t.bq,{className:"w-[160px]",children:(0,e.jsx)(t.yv,{placeholder:"All Manufacturers"})}),(0,e.jsxs)(t.gC,{children:[(0,e.jsx)(t.eb,{value:"all",children:"All Manufacturers"}),S.map(a=>(0,e.jsx)(t.eb,{value:a,children:a},a))]})]}),$&&(0,e.jsx)(u.$,{variant:"outline",size:"sm",onClick:()=>{B("all"),D("all")},children:"Clear"})]}),$&&(0,e.jsxs)("div",{className:"flex flex-wrap gap-2",children:["all"!==A&&(0,e.jsxs)(v.E,{variant:"secondary",className:"gap-1",children:["Category: ",A,(0,e.jsx)("button",{onClick:()=>B("all"),className:"ml-1 hover:text-destructive",children:"\xd7"})]}),"all"!==C&&(0,e.jsxs)(v.E,{variant:"secondary",className:"gap-1",children:["Manufacturer: ",C,(0,e.jsx)("button",{onClick:()=>D("all"),className:"ml-1 hover:text-destructive",children:"\xd7"})]})]}),!1===N&&(0,e.jsxs)(q.Fc,{variant:"warning",children:[(0,e.jsx)(r.hcu,{className:"h-4 w-4"}),(0,e.jsx)(q.XL,{children:"Storage Service Issue"}),(0,e.jsx)(q.TN,{children:"Image uploads are disabled because the storage service is not properly configured. Parts can still be added and edited, but without images."})]}),(0,e.jsx)(k.P,{parts:Z,onEdit:a=>{z(a),d(!0)},onDelete:a=>{z(a),x(!0)},isLoading:I,onSort:G,sortConfig:F}),(0,e.jsxs)("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[(0,e.jsxs)("span",{children:["Showing ",X+1,"-",Math.min(Y,T?.length||0)," of"," ",T?.length||0," spare parts"]}),(0,e.jsxs)("span",{children:["Page ",U," of ",W]})]}),W>1&&(0,e.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,e.jsx)(u.$,{variant:"outline",size:"sm",onClick:()=>V(Math.max(1,U-1)),disabled:1===U,children:"Previous"}),(0,e.jsx)("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,W)},(a,b)=>{let c=b+1;return W<=5||1===c||c===W||c>=U-1&&c<=U+1?(0,e.jsx)(u.$,{variant:U===c?"default":"outline",size:"sm",onClick:()=>V(c),className:"h-8 w-8 p-0",children:c},c):c===U-2||c===U+2?(0,e.jsx)("span",{className:"px-2 text-muted-foreground",children:"..."},c):null})}),(0,e.jsx)(u.$,{variant:"outline",size:"sm",onClick:()=>V(Math.min(W,U+1)),disabled:U===W,children:"Next"})]}),(0,e.jsx)(l.J,{isOpen:a,onOpenChange:b,onSubmit:a=>{K.mutate(a),b(!1)},isSubmitting:K.isPending}),(0,e.jsx)(m.e,{isOpen:c,onOpenChange:d,onSubmit:a=>{y&&(L.mutate({updatedPart:a,partId:y.id}),d(!1))},isSubmitting:L.isPending,selectedPart:y}),(0,e.jsx)(n.j,{isOpen:w,onOpenChange:x,onConfirm:()=>{y&&(M.mutate(y.id),x(!1))},isDeleting:M.isPending,selectedPart:y})]})})};d()}catch(a){d(a)}})},41415:a=>{a.exports=import("sonner")},42472:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{d:()=>l});var e=c(28462),f=c(95965),g=c(76569),h=c(90894),i=c(38500),j=c(19483),k=a([e]);e=(k.then?(await k)():k)[0];let l=()=>{let{toast:a}=(0,g.dj)(),b=(0,e.useQueryClient)();return(0,e.useMutation)({mutationFn:async b=>{console.log("Adding new part:",b);let c={name:b.name,part_number:b.part_number,category:b.category,manufacturer:b.manufacturer,quantity:b.quantity,unit_price:b.unit_price,location:b.location,status:(0,j.y)(b.quantity,b.min_stock_level),min_stock_level:b.min_stock_level,purchase_date:b.purchase_date||null,compatibility:b.compatibility||[]};console.log("Inserting part data:",c);let{data:d,error:e}=await f.N.from("spare_parts").insert([c]);if(e)throw console.error("Error inserting part:",e),e;if(b.notes&&d&&d[0]&&"id"in d[0]&&await (0,i.I)(d[0].id,b.notes),b.part_image instanceof File){if(!await (0,h.x8)())return console.log("part_image column does not exist in the database"),a({title:"Image upload skipped",description:"The part was saved but the database doesn't support image uploads",variant:"default"}),d?.[0];let c=await (0,h.CL)(b.part_image,d&&d[0]&&"id"in d[0]?d[0].id:"",b=>{a({title:"Image upload failed",description:b,variant:"destructive"})});c&&d&&d[0]&&"id"in d[0]&&await (0,h.VY)(d[0].id,c,b=>{a({title:"Image path update failed",description:b,variant:"destructive"})})}return d?.[0]},onSuccess:()=>{b.invalidateQueries({queryKey:["spare_parts"]}),a({title:"Part added successfully",description:"The new part has been added to inventory."})},onError:b=>{console.error("Error adding part:",b),a({title:"Failed to add part",description:b instanceof Error?b.message:"An unknown error occurred",variant:"destructive"})}})};d()}catch(a){d(a)}})},42971:a=>{a.exports=import("zod")},45503:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{j:()=>h});var e=c(8732),f=c(95020),g=a([f]);f=(g.then?(await g)():g)[0];let h=({isOpen:a,onOpenChange:b,onConfirm:c,isDeleting:d,selectedPart:g})=>(0,e.jsx)(f.Lt,{open:a,onOpenChange:b,children:(0,e.jsxs)(f.EO,{children:[(0,e.jsxs)(f.wd,{children:[(0,e.jsx)(f.r7,{children:"Are you absolutely sure?"}),(0,e.jsxs)(f.$v,{children:["This action cannot be undone. This will permanently delete the part"," ",(0,e.jsx)("span",{className:"font-medium",children:g?.name})," from the inventory."]})]}),(0,e.jsxs)(f.ck,{children:[(0,e.jsx)(f.Zr,{children:"Cancel"}),(0,e.jsx)(f.Rx,{className:"bg-red-600 hover:bg-red-700",onClick:c,disabled:d,children:d?"Deleting...":"Delete"})]})]})});d()}catch(a){d(a)}})},46060:a=>{a.exports=require("next/dist/shared/lib/no-fallback-error.external.js")},47860:a=>{a.exports=import("@radix-ui/react-select")},48303:a=>{a.exports=import("@radix-ui/react-tooltip")},48383:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{A0:()=>j,BF:()=>k,Gg:()=>l,Hj:()=>m,XI:()=>i,nA:()=>o,nd:()=>n,r6:()=>p});var e=c(8732),f=c(82015),g=c(87092),h=a([g]);g=(h.then?(await h)():h)[0];let i=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("div",{className:"relative w-full overflow-auto rounded-lg",children:(0,e.jsx)("table",{ref:c,className:(0,g.cn)("w-full caption-bottom text-sm bg-card text-card-foreground",a),...b})}));i.displayName="Table";let j=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("thead",{ref:c,className:(0,g.cn)("[&_tr]:border-b border-border bg-muted/50",a),...b}));j.displayName="TableHeader";let k=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("tbody",{ref:c,className:(0,g.cn)("[&_tr:last-child]:border-0",a),...b}));k.displayName="TableBody";let l=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("tfoot",{ref:c,className:(0,g.cn)("border-t border-border bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...b}));l.displayName="TableFooter";let m=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("tr",{ref:c,className:(0,g.cn)("border-b border-border transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...b}));m.displayName="TableRow";let n=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("th",{ref:c,className:(0,g.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...b}));n.displayName="TableHead";let o=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("td",{ref:c,className:(0,g.cn)("p-4 align-middle text-card-foreground [&:has([role=checkbox])]:pr-0",a),...b}));o.displayName="TableCell";let p=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("caption",{ref:c,className:(0,g.cn)("mt-4 text-sm text-muted-foreground",a),...b}));p.displayName="TableCaption",d()}catch(a){d(a)}})},50802:a=>{a.exports=import("clsx")},50899:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{I:()=>i});var e=c(8732),f=c(38661),g=c(66345),h=a([f,g]);[f,g]=h.then?(await h)():h;let i=({onCancel:a,isSubmitting:b,defaultValues:c})=>(0,e.jsxs)(f.Es,{className:"flex justify-between sm:justify-end gap-3 pt-4 mt-4 border-t bg-background",children:[(0,e.jsx)(g.$,{variant:"outline",type:"button",onClick:a,children:"Cancel"}),(0,e.jsx)(g.$,{type:"submit",disabled:b,className:"bg-purple-600 hover:bg-purple-700",children:b?"Saving...":c?"Update Part":"Save Part"})]});d()}catch(a){d(a)}})},52307:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{C5:()=>u,MJ:()=>s,Rr:()=>t,eI:()=>q,lR:()=>r,lV:()=>l,zB:()=>n});var e=c(8732),f=c(82015),g=c(9640),h=c(56884),i=c(87092),j=c(40273),k=a([g,h,i,j]);[g,h,i,j]=k.then?(await k)():k;let l=h.FormProvider,m=f.createContext({}),n=({...a})=>(0,e.jsx)(m.Provider,{value:{name:a.name},children:(0,e.jsx)(h.Controller,{...a})}),o=()=>{let a=f.useContext(m),b=f.useContext(p),{getFieldState:c,formState:d}=(0,h.useFormContext)(),e=c(a.name,d);if(!a)throw Error("useFormField should be used within <FormField>");let{id:g}=b;return{id:g,name:a.name,formItemId:`${g}-form-item`,formDescriptionId:`${g}-form-item-description`,formMessageId:`${g}-form-item-message`,...e}},p=f.createContext({}),q=f.forwardRef(({className:a,...b},c)=>{let d=f.useId();return(0,e.jsx)(p.Provider,{value:{id:d},children:(0,e.jsx)("div",{ref:c,className:(0,i.cn)("space-y-2",a),...b})})});q.displayName="FormItem";let r=f.forwardRef(({className:a,...b},c)=>{let{error:d,formItemId:f}=o();return(0,e.jsx)(j.J,{ref:c,className:(0,i.cn)(d&&"text-destructive",a),htmlFor:f,...b})});r.displayName="FormLabel";let s=f.forwardRef(({...a},b)=>{let{error:c,formItemId:d,formDescriptionId:f,formMessageId:h}=o();return(0,e.jsx)(g.Slot,{ref:b,id:d,"aria-describedby":c?`${f} ${h}`:`${f}`,"aria-invalid":!!c,...a})});s.displayName="FormControl";let t=f.forwardRef(({className:a,...b},c)=>{let{formDescriptionId:d}=o();return(0,e.jsx)("p",{ref:c,id:d,className:(0,i.cn)("text-sm text-muted-foreground",a),...b})});t.displayName="FormDescription";let u=f.forwardRef(({className:a,children:b,...c},d)=>{let{error:f,formMessageId:g}=o(),h=f?String(f?.message):b;return h?(0,e.jsx)("p",{ref:d,id:g,className:(0,i.cn)("text-sm font-medium text-destructive",a),...c,children:h}):null});u.displayName="FormMessage",d()}catch(a){d(a)}})},55752:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{$:()=>i});var e=c(8732),f=c(52307),g=c(87967),h=a([f,g]);[f,g]=h.then?(await h)():h;let i=({form:a})=>(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsx)("h3",{className:"text-lg font-semibold border-b pb-2",children:"Additional Notes"}),(0,e.jsx)(f.zB,{control:a.control,name:"notes",render:({field:a})=>(0,e.jsxs)(f.eI,{children:[(0,e.jsx)(f.lR,{children:"Notes"}),(0,e.jsx)(f.MJ,{children:(0,e.jsx)(g.T,{placeholder:"Enter any additional information about this part (optional)",...a,className:"min-h-[80px] resize-none"})}),(0,e.jsx)(f.C5,{})]})})]});d()}catch(a){d(a)}})},56884:a=>{a.exports=import("react-hook-form")},57049:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{bq:()=>m,eb:()=>q,gC:()=>p,l6:()=>k,yv:()=>l});var e=c(8732),f=c(82015),g=c(47860),h=c(74952),i=c(87092),j=a([g,i]);[g,i]=j.then?(await j)():j;let k=g.Root;g.Group;let l=g.Value,m=f.forwardRef(({className:a,children:b,...c},d)=>(0,e.jsxs)(g.Trigger,{ref:d,className:(0,i.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-0 focus-visible:ring-0 focus:ring-offset-0 focus-visible:ring-offset-0 focus:border-ring focus-visible:border-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1 transition-colors",a),...c,children:[b,(0,e.jsx)(g.Icon,{asChild:!0,children:(0,e.jsx)(h.yQN,{className:"h-4 w-4 opacity-50"})})]}));m.displayName=g.Trigger.displayName;let n=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.ScrollUpButton,{ref:c,className:(0,i.cn)("flex cursor-default items-center justify-center py-1",a),...b,children:(0,e.jsx)(h.rXn,{className:"h-4 w-4"})}));n.displayName=g.ScrollUpButton.displayName;let o=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.ScrollDownButton,{ref:c,className:(0,i.cn)("flex cursor-default items-center justify-center py-1",a),...b,children:(0,e.jsx)(h.yQN,{className:"h-4 w-4"})}));o.displayName=g.ScrollDownButton.displayName;let p=f.forwardRef(({className:a,children:b,position:c="popper",...d},f)=>(0,e.jsx)(g.Portal,{children:(0,e.jsxs)(g.Content,{ref:f,className:(0,i.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===c&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:c,...d,children:[(0,e.jsx)(n,{}),(0,e.jsx)(g.Viewport,{className:(0,i.cn)("p-1","popper"===c&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:b}),(0,e.jsx)(o,{})]})}));p.displayName=g.Content.displayName,f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Label,{ref:c,className:(0,i.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...b})).displayName=g.Label.displayName;let q=f.forwardRef(({className:a,children:b,...c},d)=>(0,e.jsxs)(g.Item,{ref:d,className:(0,i.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...c,children:[(0,e.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,e.jsx)(g.ItemIndicator,{children:(0,e.jsx)(h.Jlk,{className:"h-4 w-4"})})}),(0,e.jsx)(g.ItemText,{children:b})]}));q.displayName=g.Item.displayName,f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Separator,{ref:c,className:(0,i.cn)("-mx-1 my-1 h-px bg-muted",a),...b})).displayName=g.Separator.displayName,d()}catch(a){d(a)}})},57312:a=>{a.exports=import("next-themes")},57657:(a,b,c)=>{c.d(b,{X:()=>e});var d=c(82015);let e=a=>{let[b,c]=(0,d.useState)(null);return(0,d.useEffect)(()=>()=>{b&&!b.includes("supabase")&&URL.revokeObjectURL(b)},[b]),{previewUrl:b,setPreviewUrl:c,handleImageChange:a=>{let b=a.target.files?.[0];b&&(console.log("File selected:",b.name),c(URL.createObjectURL(b)))}}}},57973:a=>{a.exports=import("@radix-ui/react-alert-dialog")},58894:(a,b,c)=>{function d(a){return a&&"object"==typeof a&&"error"in a&&!0===a.error}function e(a){return Array.isArray(a)?a.filter(a=>!d(a)):[]}function f(a){return d(a)?null:a}c.d(b,{to:()=>f,wH:()=>e})},59921:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{K:()=>k});var e=c(8732),f=c(82015),g=c(78059),h=c(66345),i=c(74952),j=a([g,h]);[g,h]=j.then?(await j)():j;let k=({form:a})=>{let[b,c]=(0,f.useState)(""),d=a.watch("compatibility")||[],j=()=>{if(!b.trim())return;let d=a.getValues("compatibility")||[];d.includes(b.trim())||a.setValue("compatibility",[...d,b.trim()]),c("")};return(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsx)("h3",{className:"text-lg font-semibold border-b pb-2",children:"Compatibility"}),(0,e.jsxs)("div",{className:"flex gap-2",children:[(0,e.jsx)(g.p,{placeholder:"Add compatibility (e.g., vehicle model, year)",value:b,onChange:a=>c(a.target.value),onKeyDown:a=>{"Enter"===a.key&&(a.preventDefault(),j())}}),(0,e.jsx)(h.$,{type:"button",onClick:j,variant:"outline",className:"flex-shrink-0",children:(0,e.jsx)(i.FWt,{className:"h-4 w-4"})})]}),(0,e.jsxs)("div",{className:"flex flex-wrap gap-2",children:[d.map((b,c)=>(0,e.jsxs)("div",{className:"bg-purple-50 text-purple-800 dark:bg-purple-900/20 dark:text-purple-300 px-3 py-1.5 rounded-full text-sm flex items-center gap-2 border border-purple-200 dark:border-purple-800/30",children:[b,(0,e.jsx)(h.$,{type:"button",variant:"ghost",size:"sm",className:"h-5 w-5 rounded-full p-0 hover:bg-purple-200 dark:hover:bg-purple-800/40",onClick:()=>(b=>{let c=a.getValues("compatibility")||[];a.setValue("compatibility",c.filter(a=>a!==b))})(b),children:(0,e.jsx)(i.X,{className:"h-3 w-3"})})]},c)),0===d.length&&(0,e.jsx)("span",{className:"text-sm text-muted-foreground italic",children:"No compatibility information added"})]})]})};d()}catch(a){d(a)}})},61399:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{config:()=>r,default:()=>n,getServerSideProps:()=>q,getStaticPaths:()=>p,getStaticProps:()=>o,handler:()=>z,reportWebVitals:()=>s,routeModule:()=>y,unstable_getServerProps:()=>w,unstable_getServerSideProps:()=>x,unstable_getStaticParams:()=>v,unstable_getStaticPaths:()=>u,unstable_getStaticProps:()=>t});var e=c(63885),f=c(80237),g=c(81413),h=c(65611),i=c.n(h),j=c(74780),k=c(40391),l=c(12289),m=a([j,k]);[j,k]=m.then?(await m)():m;let n=(0,g.M)(k,"default"),o=(0,g.M)(k,"getStaticProps"),p=(0,g.M)(k,"getStaticPaths"),q=(0,g.M)(k,"getServerSideProps"),r=(0,g.M)(k,"config"),s=(0,g.M)(k,"reportWebVitals"),t=(0,g.M)(k,"unstable_getStaticProps"),u=(0,g.M)(k,"unstable_getStaticPaths"),v=(0,g.M)(k,"unstable_getStaticParams"),w=(0,g.M)(k,"unstable_getServerProps"),x=(0,g.M)(k,"unstable_getServerSideProps"),y=new e.PagesRouteModule({definition:{kind:f.RouteKind.PAGES,page:"/SpareParts",pathname:"/SpareParts",bundlePath:"",filename:""},distDir:".next-fleet",relativeProjectDir:"",components:{App:j.default,Document:i()},userland:k}),z=(0,l.U)({srcPage:"/SpareParts",config:r,userland:k,routeModule:y,getStaticPaths:p,getStaticProps:o,getServerSideProps:q});d()}catch(a){d(a)}})},71667:(a,b,c)=>{c.d(b,{U:()=>e});var d=c(82015);let e=()=>{let[a,b]=(0,d.useState)({column:"updated_at",direction:"desc"});return{sortConfig:a,handleSort:a=>{b(b=>({column:a,direction:b.column===a&&"asc"===b.direction?"desc":"asc"}))}}}},74038:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{J:()=>j});var e=c(28462),f=c(95965),g=c(76569),h=c(90894),i=a([e]);e=(i.then?(await i)():i)[0];let j=()=>{let{toast:a}=(0,g.dj)(),b=(0,e.useQueryClient)();return(0,e.useMutation)({mutationFn:async a=>{console.log("Deleting part with ID:",a);let{data:b}=await f.N.from("spare_parts").select("part_image").eq("id",a).single(),{error:c}=await f.N.from("spare_parts").delete().eq("id",a);if(c)throw c;return b&&"part_image"in b&&b.part_image&&await (0,h.sv)(b.part_image),console.log("Part deleted successfully"),a},onSuccess:c=>{b.invalidateQueries({queryKey:["spare_parts"]}),a({title:"Part deleted",description:"The part has been removed from inventory."})},onError:b=>{console.error("Error deleting part:",b),a({title:"Failed to delete part",description:b instanceof Error?b.message:"An unknown error occurred",variant:"destructive"})}})};d()}catch(a){d(a)}})},75979:a=>{a.exports=import("tailwind-merge")},77264:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{e:()=>i});var e=c(8732),f=c(38661),g=c(27503),h=a([f,g]);[f,g]=h.then?(await h)():h;let i=({isOpen:a,onOpenChange:b,onSubmit:c,isSubmitting:d,selectedPart:h})=>h?(0,e.jsx)(f.lG,{open:a,onOpenChange:b,children:(0,e.jsxs)(f.Cf,{className:"sm:max-w-[1000px] h-[85vh] overflow-hidden flex flex-col",children:[(0,e.jsxs)(f.c7,{children:[(0,e.jsx)(f.L3,{children:"Edit Part"}),(0,e.jsx)(f.rr,{children:"Update the details for this spare part."})]}),(0,e.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,e.jsx)(g.K,{onSubmit:c,onCancel:()=>b(!1),isSubmitting:d,defaultValues:h,existingImage:h.part_image})})]})}):null;d()}catch(a){d(a)}})},78059:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{p:()=>i});var e=c(8732),f=c(82015),g=c(87092),h=a([g]);g=(h.then?(await h)():h)[0];let i=f.forwardRef(({className:a,type:b,onAddItem:c,onRemoveItem:d,showAddButton:f,showRemoveButton:h,addButtonLabel:i,removeButtonLabel:j,...k},l)=>(0,e.jsxs)("div",{className:f||h?"flex items-center gap-2":"",children:[(0,e.jsx)("input",{type:b,className:(0,g.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus:outline-none focus:ring-0 focus-visible:ring-0 focus:ring-offset-0 focus-visible:ring-offset-0 focus:border-ring focus-visible:border-ring disabled:cursor-not-allowed disabled:opacity-50 transition-colors",a),ref:l,onKeyDown:c?a=>{"Enter"===a.key&&c&&(a.preventDefault(),c())}:void 0,...k}),f&&c&&(0,e.jsx)("button",{type:"button",className:"inline-flex h-10 items-center justify-center rounded-md bg-primary px-3 py-2 text-sm font-medium text-primary-foreground hover:bg-primary/90",onClick:c,children:i||"Add"}),h&&d&&(0,e.jsx)("button",{type:"button",className:"inline-flex h-10 items-center justify-center rounded-md bg-destructive px-3 py-2 text-sm font-medium text-destructive-foreground hover:bg-destructive/90",onClick:d,children:j||"Remove"})]}));i.displayName="Input",d()}catch(a){d(a)}})},82015:a=>{a.exports=require("react")},87320:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{B:()=>o});var e=c(8732),f=c(82015),g=c(52307),h=c(78059),i=c(66345),j=c(74952),k=c(95965),l=c(76569),m=c(90894),n=a([g,h,i]);[g,h,i]=n.then?(await n)():n;let o=({imageInputRef:a,existingImage:b,previewUrl:c,setPreviewUrl:d,handleImageChange:n,form:o})=>{let{toast:p}=(0,l.dj)(),[q,r]=(0,f.useState)(!1),[s,t]=(0,f.useState)(null),[u,v]=(0,f.useState)(null),[w,x]=(0,f.useState)(!0);return((0,f.useEffect)(()=>{(async()=>{x(!0);try{let{data:a,error:b}=await k.N.storage.from("images").list();if(b){console.error("Storage availability check failed:",b),v(!1),t(`Storage service not available: ${b.message}`),x(!1);return}if(!await (0,m.IT)()){console.error("Failed to create or verify parts directory"),v(!1),t("Could not access the upload directory"),x(!1);return}v(!0),t(null)}catch(a){console.error("Error checking storage:",a),v(!1),t("Storage service not available")}finally{x(!1)}})()},[]),(0,f.useEffect)(()=>{let a=async()=>{if(b&&u)try{r(!0),t(null),console.log("Fetching existing image:",b);let a=await (0,m.wp)(b);if(a)console.log("Setting preview URL to:",a),d(a);else throw Error("Could not get public URL")}catch(a){console.error("Error fetching image:",a),t("Could not load the existing image"),p({title:"Image loading error",description:"Could not load the existing image.",variant:"destructive"})}finally{r(!1)}else b&&!u&&(t("Storage is not available"),r(!1))};w||a()},[b,d,p,u,w]),w)?(0,e.jsxs)("div",{children:[(0,e.jsx)(g.lR,{htmlFor:"part_image",children:"Part Image"}),(0,e.jsxs)("div",{className:"mt-1.5 p-4 bg-slate-50 border border-slate-200 rounded flex items-center gap-3",children:[(0,e.jsx)("div",{className:"animate-spin h-5 w-5 border-2 border-slate-300 border-t-slate-600 rounded-full"}),(0,e.jsx)("p",{className:"text-sm text-slate-600",children:"Checking storage availability..."})]})]}):!1===u?(0,e.jsxs)("div",{children:[(0,e.jsx)(g.lR,{htmlFor:"part_image",children:"Part Image"}),(0,e.jsxs)("div",{className:"mt-1.5 p-4 bg-amber-50 border border-amber-200 rounded flex items-center gap-3",children:[(0,e.jsx)(j.hcu,{className:"h-5 w-5 text-amber-500"}),(0,e.jsx)("p",{className:"text-sm text-amber-700",children:s||"Image uploads are currently unavailable. The storage service is not properly configured."})]})]}):(0,e.jsxs)("div",{children:[(0,e.jsx)(g.lR,{htmlFor:"part_image",children:"Part Image"}),(0,e.jsxs)("div",{className:"mt-1.5 space-y-4",children:[(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)(h.p,{id:"part_image",type:"file",onChange:a=>{n(a);let b=a.target.files?.[0];if(b){if(b.size>5242880){p({title:"File too large",description:"Image must be less than 5MB",variant:"destructive"}),a.target.value="";return}if(!b.type.startsWith("image/")){p({title:"Invalid file type",description:"Please select an image file",variant:"destructive"}),a.target.value="";return}o.setValue("part_image",b)}},ref:a.ref,onBlur:a.onBlur,accept:"image/*",className:"w-full"}),!c&&(0,e.jsx)("div",{className:"absolute inset-0 opacity-0 pointer-events-none",children:(0,e.jsx)(j._OO,{className:"h-5 w-5"})})]}),(0,e.jsxs)("div",{className:"flex justify-center",children:[q&&(0,e.jsx)("div",{className:"h-48 w-48 flex items-center justify-center bg-slate-100 rounded border",children:(0,e.jsx)("div",{className:"animate-spin h-8 w-8 border-2 border-slate-300 border-t-slate-600 rounded-full"})}),s&&!q&&!c&&(0,e.jsx)("div",{className:"h-48 w-48 flex items-center justify-center bg-red-50 rounded border",children:(0,e.jsx)("p",{className:"text-sm text-red-500",children:"Failed to load"})}),c&&!s&&!q&&(0,e.jsxs)("div",{className:"relative h-48 w-48 rounded border overflow-hidden",children:[(0,e.jsx)("img",{src:c,alt:"Preview",className:"h-full w-full object-cover",onError:()=>{t("Image failed to load"),d(null)}}),(0,e.jsx)(i.$,{type:"button",variant:"destructive",size:"sm",className:"absolute top-2 right-2 h-6 w-6 rounded-full",onClick:()=>{d(null),o.setValue("part_image",null)},children:(0,e.jsx)(j.X,{className:"h-4 w-4"})})]})]}),(0,e.jsxs)("div",{className:"text-xs text-muted-foreground text-center",children:[(0,e.jsx)("p",{children:"Upload a clear image of the part"}),(0,e.jsx)("p",{children:"Maximum file size: 5MB"}),(0,e.jsx)("p",{children:"Supported formats: JPG, PNG, GIF"})]})]}),s&&c&&(0,e.jsx)("p",{className:"text-xs text-red-500 mt-1",children:s})]})};d()}catch(a){d(a)}})},87967:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{T:()=>i});var e=c(8732),f=c(82015),g=c(87092),h=a([g]);g=(h.then?(await h)():h)[0];let i=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("textarea",{className:(0,g.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-0 focus-visible:ring-0 focus:ring-offset-0 focus-visible:ring-offset-0 focus:border-ring focus-visible:border-ring disabled:cursor-not-allowed disabled:opacity-50 transition-colors",a),ref:c,...b}));i.displayName="Textarea",d()}catch(a){d(a)}})},90894:(a,b,c)=>{c.d(b,{CL:()=>f,IT:()=>e,VY:()=>j,sv:()=>h,wp:()=>g,x8:()=>i});var d=c(95965);let e=async()=>{try{console.log("Checking parts directory access in images bucket");let{data:a,error:b}=await d.N.storage.from("images").list("parts",{limit:1});if(!b)return console.log("Parts directory is accessible"),!0;console.log("Directory listing failed, testing upload capability...");let c=`parts/test-${Date.now()}.txt`,{error:e}=await d.N.storage.from("images").upload(c,new Blob(["test"],{type:"text/plain"}),{contentType:"text/plain",upsert:!0});if(!e)return console.log("Upload test successful, parts directory is accessible"),await d.N.storage.from("images").remove([c]),!0;if(e.message.includes("row-level security")||e.message.includes("RLS")||e.message.includes("permission denied"))return console.warn("Storage RLS policies prevent directory creation, but upload may still work"),!0;return console.error("Failed to access parts directory:",e),!1}catch(a){return console.error("Failed to check parts directory:",a),!0}},f=async(a,b,c)=>{try{if(console.log("Starting image upload process for part:",b),a.size>5242880)return c("Image size exceeds 5MB limit."),null;if(!a.type.startsWith("image/"))return c("Selected file is not a valid image format."),null;let e=a.name.split(".").pop()||"jpeg",f=`${b}.${e}`,g=`parts/${f}`;console.log("Uploading image to path:",g);let{error:h,data:i}=await d.N.storage.from("images").upload(g,a,{upsert:!0,contentType:a.type});if(h)return console.error("Error uploading image:",h),c(h.message.includes("row-level security")||h.message.includes("RLS")||h.message.includes("permission denied")?"Storage access denied. Please check your Supabase storage policies.":h.message.includes("bucket")?"Storage bucket not found. Please ensure the 'images' bucket exists.":`Upload failed: ${h.message}`),null;return console.log("Image uploaded successfully:",i),g}catch(a){return console.error("Image upload process error:",a),c("We couldn't upload the image due to an unexpected error"),null}},g=async a=>{try{if(!a)return null;let{data:b}=await d.N.storage.from("images").getPublicUrl(a);if(b?.publicUrl)return console.log("Public URL retrieved:",b.publicUrl),b.publicUrl;return null}catch(a){return console.error("Error getting public URL:",a),null}},h=async a=>{try{if(!a)return!0;let{error:b}=await d.N.storage.from("images").remove([a]);if(b)return console.error("Error deleting image:",b),!1;return!0}catch(a){return console.error("Failed to delete image:",a),!1}},i=async()=>{try{let{data:a}=await d.N.from("spare_parts").select("part_image").limit(1);return a&&a.length>0&&"part_image"in a[0]||!1}catch(a){return console.error("Error checking part_image column:",a),!1}},j=async(a,b,c)=>{try{let{error:e}=await d.N.from("spare_parts").update({part_image:b}).eq("id",a);if(e)return console.error("Error updating part with image path:",e),c("The part and image were saved but the link wasn't updated"),!1;return!0}catch(a){return console.error("Error updating part with image path:",a),c("The part and image were saved but the link wasn't updated"),!1}}},92602:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{J:()=>i});var e=c(8732),f=c(38661),g=c(27503),h=a([f,g]);[f,g]=h.then?(await h)():h;let i=({isOpen:a,onOpenChange:b,onSubmit:c,isSubmitting:d})=>(0,e.jsx)(f.lG,{open:a,onOpenChange:b,children:(0,e.jsxs)(f.Cf,{className:"sm:max-w-[1000px] h-[85vh] overflow-hidden flex flex-col",children:[(0,e.jsxs)(f.c7,{children:[(0,e.jsx)(f.L3,{children:"Add New Part"}),(0,e.jsx)(f.rr,{children:"Fill in the details to add a new part to your inventory."})]}),(0,e.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,e.jsx)(g.K,{onSubmit:c,onCancel:()=>b(!1),isSubmitting:d})})]})});d()}catch(a){d(a)}})},93939:a=>{a.exports=require("@supabase/supabase-js")},94142:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{F:()=>j});var e=c(8732),f=c(82015),g=c(14505),h=c(87092),i=a([g,h]);[g,h]=i.then?(await i)():i;let j=f.forwardRef(({className:a,children:b,...c},d)=>(0,e.jsxs)(g.Root,{ref:d,className:(0,h.cn)("relative overflow-hidden",a),...c,children:[(0,e.jsx)(g.Viewport,{className:"h-full w-full rounded-[inherit]",children:b}),(0,e.jsx)(k,{}),(0,e.jsx)(g.Corner,{})]}));j.displayName=g.Root.displayName;let k=f.forwardRef(({className:a,orientation:b="vertical",...c},d)=>(0,e.jsx)(g.ScrollAreaScrollbar,{ref:d,orientation:b,className:(0,h.cn)("flex touch-none select-none transition-colors","vertical"===b&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===b&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...c,children:(0,e.jsx)(g.ScrollAreaThumb,{className:"relative flex-1 rounded-full bg-border"})}));k.displayName=g.ScrollAreaScrollbar.displayName,d()}catch(a){d(a)}})},94857:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{T:()=>i});var e=c(28462),f=c(95965),g=c(58894),h=a([e]);e=(h.then?(await h)():h)[0];let i=a=>(0,e.useQuery)({queryKey:["spare_parts",a],queryFn:async()=>{try{let{data:b,error:c}=await f.N.from("spare_parts").select("*").order(a.column,{ascending:"asc"===a.direction});if(c)throw console.error("Error fetching spare parts:",c),Error(c.message);return(0,g.wH)(b)}catch(a){throw console.error("Error in spare parts query:",a),a}}});d()}catch(a){d(a)}})},95020:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{$v:()=>r,EO:()=>n,Lt:()=>k,Rx:()=>s,Zr:()=>t,ck:()=>p,r7:()=>q,wd:()=>o});var e=c(8732),f=c(82015),g=c(57973),h=c(87092),i=c(66345),j=a([g,h,i]);[g,h,i]=j.then?(await j)():j;let k=g.Root;g.Trigger;let l=g.Portal,m=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Overlay,{className:(0,h.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...b,ref:c}));m.displayName=g.Overlay.displayName;let n=f.forwardRef(({className:a,...b},c)=>(0,e.jsxs)(l,{children:[(0,e.jsx)(m,{}),(0,e.jsx)(g.Content,{ref:c,className:(0,h.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...b})]}));n.displayName=g.Content.displayName;let o=({className:a,...b})=>(0,e.jsx)("div",{className:(0,h.cn)("flex flex-col space-y-2 text-center sm:text-left",a),...b});o.displayName="AlertDialogHeader";let p=({className:a,...b})=>(0,e.jsx)("div",{className:(0,h.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...b});p.displayName="AlertDialogFooter";let q=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Title,{ref:c,className:(0,h.cn)("text-lg font-semibold",a),...b}));q.displayName=g.Title.displayName;let r=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Description,{ref:c,className:(0,h.cn)("text-sm text-muted-foreground",a),...b}));r.displayName=g.Description.displayName;let s=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Action,{ref:c,className:(0,h.cn)((0,i.r)(),a),...b}));s.displayName=g.Action.displayName;let t=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Cancel,{ref:c,className:(0,h.cn)((0,i.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...b}));t.displayName=g.Cancel.displayName,d()}catch(a){d(a)}})},98825:a=>{a.exports=import("@hookform/resolvers/zod")}};var b=require("../webpack-runtime.js");b.C(a);var c=b.X(0,[4952,5611,5781,4780],()=>b(b.s=61399));module.exports=c})();