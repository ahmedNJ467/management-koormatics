"use strict";(()=>{var a={};a.id=3181,a.ids=[636,3181,3220],a.modules={1971:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{Z:()=>n});var e=c(82015),f=c(56884),g=c(98825),h=c(28462),i=c(76569),j=c(92175),k=c(59638),l=c(36421),m=a([f,g,h,j]);function n(a){let{toast:b}=(0,i.dj)(),c=(0,h.useQueryClient)(),[d,m]=(0,e.useState)(!1),[n,o]=(0,e.useState)(!1),[p,q]=(0,e.useState)(!1),{data:r}=(0,h.useQuery)({queryKey:["vehicles"],queryFn:async()=>(await (0,k.kw)()).map(a=>({...a,fuel_type:a.fuel_type||"diesel"}))}),s=(0,f.useForm)({resolver:(0,g.zodResolver)(j.q),defaultValues:a?{vehicle_id:a.vehicle_id,date:a.date,fuel_type:a.fuel_type,volume:a.volume,price_per_liter:a.volume>0?a.cost/a.volume:0,cost:a.cost,previous_mileage:a.previous_mileage||0,current_mileage:a.current_mileage||0,mileage:a.mileage||0,notes:a.notes||"",filled_by:a.filled_by||"",fuel_management_id:a.fuel_management_id||""}:{vehicle_id:"",date:new Date().toISOString().split("T")[0],fuel_type:"diesel",volume:0,price_per_liter:0,cost:0,previous_mileage:0,current_mileage:0,mileage:0,notes:"",filled_by:"",fuel_management_id:""}});(0,l.q)(s),s.watch("vehicle_id");let t=async d=>{m(!0);try{console.log("Form submission started with values:",d);let e=j.q.safeParse(d);if(!e.success)throw console.error("Form validation failed:",e.error),Error("Form validation failed: "+e.error.message);console.log("Form validation passed, saving fuel log...");let f=await (0,k.wE)(d,a?.id);c.invalidateQueries({queryKey:["fuel-logs"]}),c.invalidateQueries({queryKey:["fuel-tanks"]}),c.invalidateQueries({queryKey:["tank-stats"]}),c.invalidateQueries({queryKey:["tank-dispensed"]}),(0,k.Hf)(),b({title:f.isNewRecord?"Fuel log created":"Fuel log updated",description:f.isNewRecord?"A new fuel log has been created successfully. Tank levels updated.":"The fuel log has been updated successfully. Tank levels updated."}),s.reset(),o(!0)}catch(c){console.error("Form submission error:",c);let a="Failed to save fuel log";c instanceof Error?a=c.message:"object"==typeof c&&null!==c&&"message"in c&&(a=c.message),b({title:"Error",description:a,variant:"destructive"})}finally{m(!1)}};return{form:s,vehicles:r,isSubmitting:d,handleSubmit:t,shouldCloseDialog:n,resetCloseDialog:()=>o(!1),hasPreviousMileage:p}}[f,g,h,j]=m.then?(await m)():m,d()}catch(a){d(a)}})},8612:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{j:()=>s});var e=c(8732),f=c(82015),g=c(38661),h=c(94142),i=c(1971),j=c(75644),k=c(88324),l=c(30101),m=c(71429),n=c(99141),o=c(80655),p=c(90627),q=c(52307),r=a([g,h,i,j,k,l,m,n,o,p,q]);function s({open:a,onOpenChange:b,fuelLog:c}){let{form:d,vehicles:r,isSubmitting:s,handleSubmit:t,shouldCloseDialog:u,resetCloseDialog:v,hasPreviousMileage:w}=(0,i.Z)(c),[x,y]=(0,f.useState)(!1);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(g.lG,{open:a,onOpenChange:b,children:(0,e.jsxs)(g.Cf,{className:"max-w-xl",children:[(0,e.jsxs)(g.c7,{children:[(0,e.jsx)(g.L3,{children:"Edit Fuel Log"}),(0,e.jsx)(g.rr,{children:"Update the fuel log details below. Required fields are marked with an asterisk."})]}),(0,e.jsx)(h.F,{className:"max-h-[calc(80vh-4rem)] pr-4",type:"always",children:(0,e.jsx)(q.lV,{...d,children:(0,e.jsxs)("form",{onSubmit:d.handleSubmit(t),className:"space-y-6 px-1",children:[(0,e.jsx)(j.B,{form:d,vehicles:r}),(0,e.jsx)(k.x,{form:d,vehicles:r}),(0,e.jsx)(l.y,{form:d}),(0,e.jsx)(m.C,{form:d,hasPreviousMileage:w}),(0,e.jsx)(n.a,{form:d}),(0,e.jsx)(o.I,{onCancel:()=>b(!1),isSubmitting:s,isEdit:!0,onDelete:()=>{y(!0)}})]})})})]})}),(0,e.jsx)(p.i,{open:x,onOpenChange:y,fuelLog:c,onDelete:()=>{y(!1),b(!1)}})]})}[g,h,i,j,k,l,m,n,o,p,q]=r.then?(await r)():r,d()}catch(a){d(a)}})},8732:a=>{a.exports=require("react/jsx-runtime")},8938:a=>{a.exports=import("class-variance-authority")},9640:a=>{a.exports=import("@radix-ui/react-slot")},11178:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{U:()=>n});var e=c(8732),f=c(71913),g=c(74952);c(82015);var h=c(87092),i=c(66345),j=c(19771),k=c(34750),l=c(20256),m=a([h,i,j,k]);function n({value:a,date:b,onChange:c,onDateChange:d,className:m}){let n=a||b,o=(0,l.a)();return(0,e.jsx)("div",{className:(0,h.cn)("grid gap-2",m),children:(0,e.jsxs)(k.AM,{children:[(0,e.jsx)(k.Wv,{asChild:!0,children:(0,e.jsxs)(i.$,{id:"date",variant:"outline",className:(0,h.cn)("w-full justify-start text-left font-normal",!n&&"text-muted-foreground"),children:[(0,e.jsx)(g.VvS,{className:"mr-2 h-4 w-4"}),n?.from?n.to?(0,e.jsxs)(e.Fragment,{children:[(0,f.GP)(n.from,"LLL dd, y")," -"," ",(0,f.GP)(n.to,"LLL dd, y")]}):(0,f.GP)(n.from,"LLL dd, y"):(0,e.jsx)("span",{children:"Pick a date range"})]})}),(0,e.jsx)(k.hl,{className:"w-auto p-0 max-w-[calc(100vw-2rem)]",align:"start",side:"bottom",children:(0,e.jsx)(j.V,{initialFocus:!0,mode:"range",defaultMonth:n?.from,selected:n,onSelect:c||d,numberOfMonths:o?1:2})})]})})}[h,i,j,k]=m.then?(await m)():m,d()}catch(a){d(a)}})},13020:a=>{a.exports=import("@radix-ui/react-dialog")},14505:a=>{a.exports=import("@radix-ui/react-scroll-area")},16235:a=>{a.exports=import("@radix-ui/react-toast")},19640:a=>{a.exports=import("@radix-ui/react-tabs")},20256:(a,b,c)=>{c.d(b,{a:()=>e});var d=c(82015);function e(){let[a,b]=d.useState(void 0);return d.useEffect(()=>{let a=window.matchMedia("(max-width: 767px)"),c=()=>{b(window.innerWidth<768)};return a.addEventListener("change",c),b(window.innerWidth<768),()=>a.removeEventListener("change",c)},[]),!!a}},20598:a=>{a.exports=import("@radix-ui/react-label")},21839:(a,b,c)=>{c.d(b,{f:()=>f});var d=c(21638),e=c(68794);function f(a,b){let c=(0,d.a)(a);return isNaN(b)?(0,e.w)(a,NaN):(b&&c.setDate(c.getDate()+b),c)}},22199:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{default:()=>F});var e=c(8732),f=c(82015),g=c.n(f),h=c(28462),i=c(66345),j=c(48383),k=c(74952),l=c(95965),m=c(54725),n=c(8612),o=c(76569),p=c(95020),q=c(81575),r=c(62430),s=c(72737),t=c(71913),u=c(78059),v=c(57049),w=c(11178),x=c(87092),y=c(4720),z=c(59638),A=c(38661),B=c(68953),C=c(90192),D=c(58894),E=a([h,i,j,m,n,p,u,v,w,x,y,A,B,C]);[h,i,j,m,n,p,u,v,w,x,y,A,B,C]=E.then?(await E)():E;let F=g().memo(function(){let{toast:a}=(0,o.dj)(),b=(0,h.useQueryClient)(),[c,d]=(0,f.useState)(!1),[g,E]=(0,f.useState)(!1),[F,G]=(0,f.useState)(null),[H,I]=(0,f.useState)(!1),[J,K]=(0,f.useState)(""),[L,M]=(0,f.useState)(""),[N,O]=(0,f.useState)("all"),[P,Q]=(0,f.useState)("all"),[R,S]=(0,f.useState)(),{data:T,isLoading:U}=(0,h.useQuery)({queryKey:["fuel-logs"],queryFn:async()=>{let{data:a,error:b}=await l.N.from("fuel_logs").select(`
          *,
          vehicle:vehicles (
            make,
            model,
            registration
          )
        `).order("date",{ascending:!1});if(b)throw b;return(0,D.wH)(a)},staleTime:3e5,gcTime:6e5,refetchOnWindowFocus:!1,refetchOnMount:!1}),V=(0,f.useMemo)(()=>{if(!T)return[];let a=new Map;return T.forEach(b=>{if(b.vehicle){let c=b.vehicle_id;a.has(c)||a.set(c,{id:b.vehicle_id,name:`${b.vehicle.make} ${b.vehicle.model}`,registration:b.vehicle.registration})}}),Array.from(a.values())},[T]),W=(0,f.useMemo)(()=>["petrol","diesel"],[]),X=(0,f.useMemo)(()=>T?T.filter(a=>{if(L){let b=L.toLowerCase(),c=a.vehicle?`${a.vehicle.make} ${a.vehicle.model}`.toLowerCase():"",d=a.vehicle?.registration?.toLowerCase()||"",e=a.fuel_type.toLowerCase();if(!c.includes(b)&&!d.includes(b)&&!e.includes(b))return!1}if("all"!==N&&a.vehicle_id!==N||"all"!==P&&a.fuel_type!==P)return!1;if(R?.from||R?.to){let b=(0,q.H)(a.date);if(R.from&&b<R.from||R.to&&b>R.to)return!1}return!0}):[],[T,L,N,P,R]),[Y,Z]=(0,f.useState)(1),$=Math.ceil(X.length/20),_=(Y-1)*20,aa=_+20,ab=X.slice(_,aa);(0,f.useMemo)(()=>{if(!X)return{totalLogs:0,totalCost:0,totalVolume:0,averageCostPerLiter:0,recentLogs:0,highCostLogs:0};let a=X.length,b=X.reduce((a,b)=>a+b.cost,0),c=X.reduce((a,b)=>a+b.volume,0),d=(0,r.e)(new Date,7),e=X.filter(a=>(0,q.H)(a.date)>=d).length,f=X.filter(a=>a.cost>100).length;return{totalLogs:a,totalCost:b,totalVolume:c,averageCostPerLiter:c>0?b/c:0,recentLogs:e,highCostLogs:f}},[X]);let ac=async c=>{try{let{error:d}=await l.N.from("fuel_logs").delete().eq("id",c);if(d)throw d;b.invalidateQueries({queryKey:["fuel-logs"]}),(0,z.Hf)(),a({title:"Fuel log deleted",description:"The fuel log has been deleted successfully. Tank levels updated."})}catch(b){console.error("Error:",b),a({title:"Error",description:"Failed to delete fuel log",variant:"destructive"})}},ad=a=>{if(!a)return"—";let b=(0,q.H)(a);return(0,s.f)(b)?(0,t.GP)(b,"dd/MM/yyyy"):"Invalid Date"},ae=()=>{K(""),O("all"),Q("all"),S(void 0)},af=J||"all"!==N||"all"!==P||R?.from||R?.to,[ag,ah]=(0,f.useState)([]),[ai,aj]=(0,f.useState)({}),[ak,al]=(0,f.useState)(null),[am,an]=(0,f.useState)(null),[ao,ap]=(0,f.useState)([]),[aq,ar]=(0,f.useState)(!1),[as,at]=(0,f.useState)({fill_date:"",amount:"",cost_per_liter:"",total_cost:"",supplier:"",notes:""}),[au,av]=(0,f.useState)(!1),[aw,ax]=(0,f.useState)("logs"),[ay,az]=(0,f.useState)(null),[aA,aB]=(0,f.useState)(!1),[aC,aD]=(0,f.useState)([]),[aE,aF]=(0,f.useState)(!1),[aG,aH]=(0,f.useState)(null),aI=(0,f.useCallback)(async()=>{aF(!0),aH(null);try{let a=await (0,z.x6)(),b=(0,D.wH)(a);if(!b||0===b.length){ah([]),aj({}),aD([]),aF(!1);return}ah(b);let c=Array.from(new Set((b||[]).map(a=>a.fuel_type)));if(!am&&c.length>0){let a=c[0];an(a);let d=b.find(b=>b.fuel_type===a);al(d?d.id:null)}else if(am){let a=b.find(a=>a.fuel_type===am);a&&al(a.id)}let d=b.map(async a=>{try{let[b,c]=await Promise.all([(0,z.N$)(a.id),(0,z.RS)(a.id)]),d=(0,D.wH)(b),e=(0,D.to)(c)||0,f=d.reduce((a,b)=>a+(b.amount||0),0),g=d[0],h={currentLevel:f-e,lastFillDate:g?.fill_date,lastFillAmount:g?.amount},i=d.map(b=>({...b,tank_fuel_type:a.fuel_type}));return{tankId:a.id,stats:h,fills:i}}catch(b){return console.error(`Error processing tank ${a.id}:`,b),{tankId:a.id,stats:{},fills:[]}}}),e=await Promise.all(d),f={},g=[];e.forEach(({tankId:a,stats:b,fills:c})=>{f[a]=b,g.push(...c)}),aj(f),aD(g)}catch(b){console.error("Error fetching tank data:",b);let a=b?.message||b?.details||b?.hint||"Failed to fetch fuel tank data. Please check your connection and try again.";aH(a),ah([]),aj({}),aD([])}finally{aF(!1)}},[]);(0,f.useMemo)(()=>{if(!aC.length)return{diesel:{totalSpent:0,totalVolume:0,fillCount:0,avgCostPerLiter:0},petrol:{totalSpent:0,totalVolume:0,fillCount:0,avgCostPerLiter:0},total:{totalSpent:0,totalVolume:0,fillCount:0,avgCostPerLiter:0}};let a=aC.reduce((a,b)=>{let c=a["diesel"===b.tank_fuel_type?"diesel":"petrol"];return b.total_cost&&(c.totalSpent+=Number(b.total_cost)),b.amount&&(c.totalVolume+=Number(b.amount)),c.fillCount++,a},{diesel:{totalSpent:0,totalVolume:0,fillCount:0},petrol:{totalSpent:0,totalVolume:0,fillCount:0}});a.diesel.totalVolume>0&&(a.diesel.avgCostPerLiter=a.diesel.totalSpent/a.diesel.totalVolume),a.petrol.totalVolume>0&&(a.petrol.avgCostPerLiter=a.petrol.totalSpent/a.petrol.totalVolume);let b={totalSpent:a.diesel.totalSpent+a.petrol.totalSpent,totalVolume:a.diesel.totalVolume+a.petrol.totalVolume,fillCount:a.diesel.fillCount+a.petrol.fillCount,avgCostPerLiter:0};return b.totalVolume>0&&(b.avgCostPerLiter=b.totalSpent/b.totalVolume),{diesel:a.diesel,petrol:a.petrol,total:b}},[aC]);let aJ=async()=>{if(!ak)return void a({title:"No Storage Selected",description:"Please select a storage before saving a fill.",variant:"destructive"});av(!0);try{let b=ai[ak]?.currentLevel??0;ay?b=b-Number(ay.amount)+Number(as.amount):b+=Number(as.amount);let c=ag.find(a=>a.id===ak);if(c&&"number"==typeof c.capacity&&b>c.capacity){a({title:"Tank Overfill Prevented",description:`This fill would exceed the tank's capacity (${c.capacity} L). Please enter a lower amount.`,variant:"destructive"}),av(!1);return}ay?await l.N.from("tank_fills").update({fill_date:as.fill_date,amount:Number(as.amount),cost_per_liter:Number(as.cost_per_liter)||null,total_cost:Number(as.total_cost)||null,supplier:as.supplier,notes:as.notes}).eq("id",ay.id):await (0,z.rh)({fuel_management_id:ak,fill_date:as.fill_date,amount:Number(as.amount),cost_per_liter:Number(as.cost_per_liter)||void 0,total_cost:Number(as.total_cost)||void 0,supplier:as.supplier,notes:as.notes}),ar(!1),at({fill_date:"",amount:"",cost_per_liter:"",total_cost:"",supplier:"",notes:""}),az(null),ak&&(0,z.N$)(ak).then(a=>ap(a));let d=await (0,z.x6)();ah(d);let e={},f=[];for(let a of(0,D.wH)(d)){let b=await (0,z.N$)(a.id),c=await (0,z.RS)(a.id),d=b.reduce((a,b)=>a+(b.amount||0),0),g=b[0];e[a.id]={currentLevel:d-c,lastFillDate:g?.fill_date,lastFillAmount:g?.amount};let h=b.map(b=>({...b,tank_fuel_type:a.fuel_type}));f.push(...h)}aj(e),aD(f)}catch(b){a({title:"Error Saving Fill",description:b instanceof Error?b.message:"An unknown error occurred.",variant:"destructive"})}finally{av(!1)}},aK=async()=>{if(!ay)return;await l.N.from("tank_fills").delete().eq("id",ay.id),aB(!1),az(null),ak&&(0,z.N$)(ak).then(a=>ap(a));let a=await (0,z.x6)();ah(a);let b={},c=[];for(let d of(0,D.wH)(a)){let a=await (0,z.N$)(d.id),e=await (0,z.RS)(d.id),f=a.reduce((a,b)=>a+(b.amount||0),0),g=a[0];b[d.id]={currentLevel:f-e,lastFillDate:g?.fill_date,lastFillAmount:g?.amount};let h=a.map(a=>({...a,tank_fuel_type:d.fuel_type}));c.push(...h)}aj(b),aD(c)};return(0,e.jsx)("div",{className:"min-h-screen bg-background",children:(0,e.jsx)("div",{className:"p-4 px-6 space-y-6",children:(0,e.jsxs)(B.tU,{value:aw,onValueChange:ax,className:"space-y-8",children:[(0,e.jsx)("div",{className:"border-b border-border pb-4 pt-4",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsx)("div",{children:(0,e.jsx)("h1",{className:"text-2xl font-semibold text-foreground",children:"Fuel Management"})}),(0,e.jsxs)(B.j7,{children:[(0,e.jsx)(B.Xi,{value:"logs",children:"Fuel Logs"}),(0,e.jsx)(B.Xi,{value:"tanks",children:"Fuel Management"})]})]})}),"logs"===aw&&(0,e.jsxs)("div",{className:"flex gap-2",children:[(0,e.jsxs)(i.$,{variant:"outline",size:"sm",className:"gap-2 text-foreground border-border/50",onClick:()=>{if(!X||0===X.length)return void a({title:"No data to export",description:"There are no fuel logs to export.",variant:"destructive"});let b=X.map(a=>[ad(a.date),a.vehicle?`${a.vehicle.make} ${a.vehicle.model}`:"Unknown Vehicle",a.vehicle?.registration||"",a.fuel_type,a.volume.toFixed(1),a.cost.toFixed(2),a.previous_mileage?.toLocaleString()||"",a.current_mileage?.toLocaleString()||"",a.mileage?.toLocaleString()||"",a.volume>0?(a.cost/a.volume).toFixed(2):"0.00",a.notes||""]),c=[["Date","Vehicle","Registration","Fuel Type","Volume (L)","Cost (USD)","Previous Mileage (km)","Current Mileage (km)","Distance (km)","Cost per Liter (USD)","Notes"],...b].map(a=>a.map(a=>`"${a}"`).join(",")).join("\n"),d=new Blob([c],{type:"text/csv"}),e=window.URL.createObjectURL(d),f=document.createElement("a");f.href=e,f.download=`fuel-logs-${(0,t.GP)(new Date,"yyyy-MM-dd")}.csv`,document.body.appendChild(f),f.click(),document.body.removeChild(f),window.URL.revokeObjectURL(e),a({title:"Export successful",description:`Exported ${X.length} fuel logs to CSV.`})},children:[(0,e.jsx)(k.f5X,{className:"mr-2 h-4 w-4"})," Export"]}),(0,e.jsx)(i.$,{onClick:()=>d(!0),variant:"outline",size:"sm",className:"gap-2 text-foreground border-border/50",children:"Add Log"})]}),(0,e.jsxs)(B.av,{value:"logs",children:[(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4",children:[(0,e.jsxs)("div",{className:"flex-1 relative group",children:[(0,e.jsx)(k.vji,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground group-focus-within:text-primary transition-colors"}),(0,e.jsx)(u.p,{placeholder:"Search by vehicle, registration, or fuel type...",value:J,onChange:a=>K(a.target.value),className:"pl-9 h-11 border-border/50 focus:border-primary/50 transition-all duration-200"}),J&&(0,e.jsx)(i.$,{variant:"ghost",size:"sm",className:"absolute right-1 top-1 h-7 w-7 p-0 hover:bg-muted/50",onClick:()=>K(""),children:(0,e.jsx)(k.X,{className:"h-3 w-3"})})]}),(0,e.jsxs)("div",{className:"flex items-center gap-3",children:[(0,e.jsxs)(v.l6,{value:N,onValueChange:O,children:[(0,e.jsxs)(v.bq,{className:"w-[140px] h-11 border-border/50 focus:border-primary/50",children:[(0,e.jsx)(k.dJT,{className:"mr-2 h-4 w-4"}),(0,e.jsx)(v.yv,{placeholder:"Vehicle"})]}),(0,e.jsxs)(v.gC,{children:[(0,e.jsx)(v.eb,{value:"all",children:"All Vehicles"}),V.map(a=>(0,e.jsxs)(v.eb,{value:a.id,children:[a.name," (",a.registration,")"]},a.id))]})]}),(0,e.jsxs)(v.l6,{value:P,onValueChange:Q,children:[(0,e.jsx)(v.bq,{className:"w-[140px] h-11 border-border/50 focus:border-primary/50",children:(0,e.jsx)(v.yv,{placeholder:"Fuel Type"})}),(0,e.jsxs)(v.gC,{children:[(0,e.jsx)(v.eb,{value:"all",children:"All Fuel Types"}),W.map(a=>(0,e.jsx)(v.eb,{value:a,children:a.charAt(0).toUpperCase()+a.slice(1)},a))]})]}),(0,e.jsx)(w.U,{value:R,onChange:S})]})]}),af&&(0,e.jsxs)("div",{className:"flex items-center justify-between pt-3 border-t border-border/20",children:[(0,e.jsxs)("div",{className:"flex flex-wrap gap-2",children:[J&&(0,e.jsxs)(y.E,{variant:"secondary",className:"gap-1",children:['Search: "',J,'"',(0,e.jsx)(i.$,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-transparent",onClick:()=>K(""),children:(0,e.jsx)(k.X,{className:"h-3 w-3"})})]}),"all"!==N&&(0,e.jsxs)(y.E,{variant:"secondary",className:"gap-1",children:["Vehicle:"," ",V.find(a=>a.id===N)?.name,(0,e.jsx)(i.$,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-transparent",onClick:()=>O("all"),children:(0,e.jsx)(k.X,{className:"h-3 w-3"})})]}),"all"!==P&&(0,e.jsxs)(y.E,{variant:"secondary",className:"gap-1",children:["Fuel:"," ",P.charAt(0).toUpperCase()+P.slice(1),(0,e.jsx)(i.$,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-transparent",onClick:()=>Q("all"),children:(0,e.jsx)(k.X,{className:"h-3 w-3"})})]}),(R?.from||R?.to)&&(0,e.jsxs)(y.E,{variant:"secondary",className:"gap-1",children:["Date:"," ",R.from?(0,t.GP)(R.from,"MMM dd"):"Start"," ","-"," ",R.to?(0,t.GP)(R.to,"MMM dd"):"End",(0,e.jsx)(i.$,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-transparent",onClick:()=>S(void 0),children:(0,e.jsx)(k.X,{className:"h-3 w-3"})})]})]}),(0,e.jsxs)(i.$,{variant:"outline",size:"sm",onClick:ae,className:"shrink-0 text-muted-foreground hover:text-foreground",children:[(0,e.jsx)(k.X,{className:"mr-2 h-4 w-4"}),"Clear All"]})]})]}),(0,e.jsxs)("div",{className:"space-y-6 mt-8",children:[(0,e.jsx)("div",{className:"rounded-lg border border-border/50 overflow-hidden",children:(0,e.jsxs)(j.XI,{children:[(0,e.jsx)(j.A0,{children:(0,e.jsxs)(j.Hj,{className:"bg-muted/20",children:[(0,e.jsx)(j.nd,{className:"font-medium",children:"Date"}),(0,e.jsx)(j.nd,{className:"font-medium",children:"Vehicle"}),(0,e.jsx)(j.nd,{className:"font-medium",children:"Fuel Type"}),(0,e.jsx)(j.nd,{className:"font-medium",children:"Volume (L)"}),(0,e.jsx)(j.nd,{className:"font-medium",children:"Cost (USD)"}),(0,e.jsx)(j.nd,{className:"font-medium",children:"Cost/L (USD)"}),(0,e.jsx)(j.nd,{className:"font-medium",children:"Distance (km)"}),(0,e.jsx)(j.nd,{className:"font-medium",children:"Filled By"}),(0,e.jsx)(j.nd,{className:"w-[100px] font-medium",children:"Actions"})]})}),(0,e.jsx)(j.BF,{children:U?(0,e.jsx)(e.Fragment,{children:Array.from({length:5}).map((a,b)=>(0,e.jsxs)(j.Hj,{children:[(0,e.jsx)(j.nA,{children:(0,e.jsx)("div",{className:"h-4 bg-muted rounded animate-pulse w-20"})}),(0,e.jsx)(j.nA,{children:(0,e.jsx)("div",{className:"h-4 bg-muted rounded animate-pulse w-32"})}),(0,e.jsx)(j.nA,{children:(0,e.jsx)("div",{className:"h-4 bg-muted rounded animate-pulse w-16"})}),(0,e.jsx)(j.nA,{children:(0,e.jsx)("div",{className:"h-4 bg-muted rounded animate-pulse w-16"})}),(0,e.jsx)(j.nA,{children:(0,e.jsx)("div",{className:"h-4 bg-muted rounded animate-pulse w-20"})}),(0,e.jsx)(j.nA,{children:(0,e.jsx)("div",{className:"h-4 bg-muted rounded animate-pulse w-16"})}),(0,e.jsx)(j.nA,{children:(0,e.jsx)("div",{className:"h-4 bg-muted rounded animate-pulse w-20"})}),(0,e.jsx)(j.nA,{children:(0,e.jsx)("div",{className:"h-4 bg-muted rounded animate-pulse w-24"})}),(0,e.jsx)(j.nA,{children:(0,e.jsx)("div",{className:"h-4 bg-muted rounded animate-pulse w-16"})})]},`skeleton-${b}`))}):0===X.length?(0,e.jsx)(j.Hj,{children:(0,e.jsx)(j.nA,{colSpan:9,className:"text-center py-8",children:(0,e.jsxs)("div",{className:"flex flex-col items-center gap-2 text-muted-foreground",children:[(0,e.jsx)(k.XHo,{className:"h-8 w-8"}),af?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{className:"font-medium",children:"No fuel logs match your filters"}),(0,e.jsx)("p",{className:"text-sm",children:"Try adjusting your search criteria"}),(0,e.jsx)(i.$,{variant:"outline",size:"sm",onClick:ae,children:"Clear Filters"})]}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("p",{className:"font-medium",children:"No fuel logs found"}),(0,e.jsx)("p",{className:"text-sm",children:"Add your first fuel log to get started"}),(0,e.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>d(!0),children:"Add First Log"})]})]})})}):ab.map(a=>{let b=a.volume>0?a.cost/a.volume:0,c=a.cost>100;return(0,e.jsxs)(j.Hj,{className:"hover:bg-muted/30 transition-colors",children:[(0,e.jsx)(j.nA,{children:(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[(0,e.jsx)(k.VvS,{className:"h-3 w-3 text-muted-foreground"}),ad(a.date)]})}),(0,e.jsx)(j.nA,{children:(0,e.jsxs)("div",{className:"flex flex-col",children:[(0,e.jsx)("span",{className:"font-medium",children:a.vehicle?`${a.vehicle.make} ${a.vehicle.model}`:"Unknown Vehicle"}),a.vehicle?.registration&&(0,e.jsx)("span",{className:"text-xs text-muted-foreground",children:a.vehicle.registration})]})}),(0,e.jsx)(j.nA,{children:(0,e.jsx)(y.E,{variant:"outline",className:(0,x.cn)("capitalize","diesel"===a.fuel_type&&"border-blue-500/30 text-blue-400","petrol"===a.fuel_type&&"border-green-500/30 text-green-400",""),children:a.fuel_type})}),(0,e.jsx)(j.nA,{className:"font-mono",children:a.volume.toFixed(1)}),(0,e.jsx)(j.nA,{children:(0,e.jsxs)("div",{className:"flex items-center gap-1",children:[(0,e.jsxs)("span",{className:(0,x.cn)("font-mono",c&&"text-orange-400 font-semibold"),children:["$",a.cost.toFixed(2)]}),c&&(0,e.jsx)(k.hcu,{className:"h-3 w-3 text-orange-400"})]})}),(0,e.jsxs)(j.nA,{className:"font-mono text-muted-foreground",children:["$",b.toFixed(2)]}),(0,e.jsx)(j.nA,{className:"font-mono",children:a.mileage?a.mileage.toLocaleString():"—"}),(0,e.jsx)(j.nA,{children:(0,e.jsx)("span",{className:"text-sm text-muted-foreground",children:a.filled_by||"—"})}),(0,e.jsx)(j.nA,{children:(0,e.jsxs)("div",{className:"flex items-center gap-1",children:[(0,e.jsx)(i.$,{variant:"ghost",size:"icon",onClick:()=>{G(a),E(!0)},className:"h-8 w-8",children:(0,e.jsx)(k.gHP,{className:"h-3 w-3"})}),(0,e.jsx)(i.$,{variant:"ghost",size:"icon",onClick:()=>{G(a),I(!0)},className:"h-8 w-8 text-destructive hover:text-destructive",children:(0,e.jsx)(k.TBR,{className:"h-3 w-3"})})]})})]},a.id)})})]})}),(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsx)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:(0,e.jsxs)("span",{children:["Showing ",_+1,"-",Math.min(aa,X.length)," of"," ",X.length," fuel logs"]})}),(0,e.jsx)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:(0,e.jsxs)("span",{children:["Page ",Y," of ",$]})}),af&&(0,e.jsx)("div",{className:"flex items-center gap-2",children:(0,e.jsxs)(y.E,{variant:"outline",children:[X.length," of ",T?.length||0]})})]})]}),(0,e.jsx)(m.K,{open:c,onOpenChange:d}),F&&(0,e.jsx)(n.j,{open:g,onOpenChange:a=>{E(a),a||G(null)},fuelLog:F}),(0,e.jsx)(p.Lt,{open:H,onOpenChange:I,children:(0,e.jsxs)(p.EO,{children:[(0,e.jsxs)(p.wd,{children:[(0,e.jsx)(p.r7,{children:"Delete Fuel Log"}),(0,e.jsx)(p.$v,{children:"Are you sure you want to delete this fuel log? This action cannot be undone."})]}),(0,e.jsxs)(p.ck,{children:[(0,e.jsx)(p.Zr,{onClick:()=>I(!1),children:"Cancel"}),(0,e.jsx)(p.Rx,{onClick:()=>{F&&(ac(F.id),I(!1),G(null))},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})]}),(0,e.jsxs)(B.av,{value:"tanks",children:[(0,e.jsxs)("div",{className:"mb-4 flex items-center gap-4",children:[(0,e.jsxs)(v.l6,{value:am||"none",onValueChange:a=>{an(a);let b=ag.find(b=>b.fuel_type===a);al(b?b.id:null)},disabled:aE,children:[(0,e.jsx)(v.bq,{className:"w-64",children:(0,e.jsx)(v.yv,{placeholder:aE?"Loading...":0===ag.length?"No tanks available":"Select fuel type"})}),(0,e.jsx)(v.gC,{children:aE?(0,e.jsx)(v.eb,{value:"loading",disabled:!0,children:"Loading..."}):aG?(0,e.jsx)(v.eb,{value:"error",disabled:!0,children:"Error loading"}):["petrol","diesel"].filter(a=>ag.some(b=>b.fuel_type===a)).map(a=>(0,e.jsx)(v.eb,{value:a,children:a},a))})]}),aG&&(0,e.jsxs)("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[(0,e.jsx)(k.hcu,{className:"h-4 w-4"}),(0,e.jsx)("span",{children:aG}),(0,e.jsx)(i.$,{variant:"outline",size:"sm",onClick:aI,disabled:aE,className:"h-6 px-2 text-xs",children:"Retry"})]}),(0,e.jsx)(i.$,{onClick:()=>ar(!0),disabled:!ak||aE,children:"Add Fill"}),(0,e.jsxs)(i.$,{variant:"outline",onClick:()=>{if(!ao.length)return;let a=[["Date","Amount (L)","Cost per Liter","Total Cost","Supplier","Notes"],...ao.map(a=>[a.fill_date,a.amount,a.cost_per_liter||"",a.total_cost||"",a.supplier||"",a.notes||""])].map(a=>a.join(",")).join("\n"),b=new Blob([a],{type:"text/csv"}),c=URL.createObjectURL(b),d=document.createElement("a");d.href=c,d.download="tank_fills.csv",d.click(),URL.revokeObjectURL(c)},disabled:!ao.length||aE,className:"gap-2",children:[(0,e.jsx)(k.f5X,{className:"h-4 w-4"})," Export"]})]}),ak&&(0,e.jsx)("div",{className:"space-y-4",children:aE?(0,e.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,e.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,e.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"}),(0,e.jsx)("span",{children:"Loading tank data..."})]})}):aG?(0,e.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,e.jsxs)("div",{className:"text-center text-muted-foreground",children:[(0,e.jsx)(k.hcu,{className:"h-8 w-8 mx-auto mb-2 text-red-500"}),(0,e.jsx)("p",{className:"text-sm text-red-600 mb-2",children:aG}),(0,e.jsx)(i.$,{variant:"outline",size:"sm",onClick:aI,disabled:aE,children:"Retry"})]})}):(0,e.jsxs)(j.XI,{children:[(0,e.jsx)(j.A0,{children:(0,e.jsxs)(j.Hj,{children:[(0,e.jsx)(j.nd,{children:"Date"}),(0,e.jsx)(j.nd,{children:"Amount (L)"}),(0,e.jsx)(j.nd,{children:"Cost/L"}),(0,e.jsx)(j.nd,{children:"Total Cost"}),(0,e.jsx)(j.nd,{children:"Supplier"}),(0,e.jsx)(j.nd,{children:"Notes"}),(0,e.jsx)(j.nd,{})]})}),(0,e.jsx)(j.BF,{children:0===ao.length?(0,e.jsx)(j.Hj,{children:(0,e.jsx)(j.nA,{colSpan:7,className:"text-center text-muted-foreground",children:"No fill history for this tank."})}):ao.map(a=>(0,e.jsxs)(j.Hj,{children:[(0,e.jsx)(j.nA,{children:a.fill_date}),(0,e.jsx)(j.nA,{children:a.amount}),(0,e.jsx)(j.nA,{children:a.cost_per_liter?`$${Number(a.cost_per_liter).toFixed(2)}`:"-"}),(0,e.jsx)(j.nA,{children:a.total_cost?`$${Number(a.total_cost).toFixed(2)}`:"-"}),(0,e.jsx)(j.nA,{children:a.supplier||"-"}),(0,e.jsx)(j.nA,{children:a.notes||"-"}),(0,e.jsx)(j.nA,{children:(0,e.jsxs)(C.rI,{children:[(0,e.jsx)(C.ty,{asChild:!0,children:(0,e.jsx)(i.$,{variant:"ghost",size:"icon",children:(0,e.jsx)(k.GvN,{className:"h-4 w-4"})})}),(0,e.jsxs)(C.SQ,{children:[(0,e.jsxs)(C._2,{onClick:()=>{az(a),at({fill_date:a.fill_date,amount:String(a.amount),cost_per_liter:a.cost_per_liter?String(a.cost_per_liter):"",total_cost:a.total_cost?String(a.total_cost):"",supplier:a.supplier||"",notes:a.notes||""}),ar(!0)},children:[(0,e.jsx)(k.gHP,{className:"h-4 w-4 mr-2"})," Edit"]}),(0,e.jsxs)(C._2,{onClick:()=>{az(a),aB(!0)},className:"text-destructive",children:[(0,e.jsx)(k.TBR,{className:"h-4 w-4 mr-2"})," Delete"]})]})]})})]},a.id))})]})}),$>1&&(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[(0,e.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>Z(Math.max(1,Y-1)),disabled:1===Y,className:"h-8 px-3",children:"Previous"}),(0,e.jsx)("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,$)},(a,b)=>{let c=b+1;return $<=5||1===c||c===$||c>=Y-1&&c<=Y+1?(0,e.jsx)(i.$,{variant:Y===c?"default":"outline",size:"sm",onClick:()=>Z(c),className:"h-8 w-8 p-0",children:c},c):c===Y-2||c===Y+2?(0,e.jsx)("span",{className:"px-2 text-muted-foreground",children:"..."},c):null})}),(0,e.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>Z(Math.min($,Y+1)),disabled:Y===$,className:"h-8 px-3",children:"Next"})]}),(0,e.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,e.jsx)("span",{children:"•"}),(0,e.jsxs)("span",{children:["Last updated: ",new Date().toLocaleTimeString()]})]})]}),(0,e.jsx)(A.lG,{open:aq,onOpenChange:ar,children:(0,e.jsxs)(A.Cf,{children:[(0,e.jsx)(A.c7,{children:(0,e.jsx)(A.L3,{children:ay?"Edit Tank Fill":"Add Tank Fill"})}),(0,e.jsxs)("form",{className:"space-y-4",onSubmit:a=>{a.preventDefault(),aJ()},children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{className:"block mb-1",children:"Date"}),(0,e.jsx)(u.p,{type:"date",value:as.fill_date,onChange:a=>at(b=>({...b,fill_date:a.target.value})),required:!0})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{className:"block mb-1",children:"Amount (L)"}),(0,e.jsx)(u.p,{type:"number",step:"0.01",value:as.amount,onChange:a=>at(b=>({...b,amount:a.target.value})),required:!0})]}),(0,e.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{className:"block mb-1",children:"Cost per Liter"}),(0,e.jsx)(u.p,{type:"number",step:"0.01",value:as.cost_per_liter,onChange:a=>{let b=a.target.value;at(a=>{let c=Number(a.amount),d=Number(b),e=c&&d?(c*d).toFixed(2):"";return{...a,cost_per_liter:b,total_cost:e}})},placeholder:"0.00"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{className:"block mb-1",children:"Total Cost"}),(0,e.jsx)(u.p,{type:"number",step:"0.01",value:as.total_cost,onChange:a=>{let b=a.target.value;at(a=>{let c=Number(a.amount),d=Number(b),e=c&&d?(d/c).toFixed(2):"";return{...a,total_cost:b,cost_per_liter:e}})},placeholder:"0.00"})]})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{className:"block mb-1",children:"Supplier"}),(0,e.jsx)(u.p,{type:"text",value:as.supplier,onChange:a=>at(b=>({...b,supplier:a.target.value}))})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{className:"block mb-1",children:"Notes"}),(0,e.jsx)(u.p,{type:"text",value:as.notes,onChange:a=>at(b=>({...b,notes:a.target.value}))})]}),(0,e.jsx)(i.$,{type:"submit",disabled:au||!ak,className:"w-full",children:au?(0,e.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,e.jsxs)("svg",{className:"animate-spin h-4 w-4 mr-2",viewBox:"0 0 24 24",children:[(0,e.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,e.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})]}),"Saving..."]}):ay?"Save Changes":"Save Fill"})]})]})}),(0,e.jsx)(p.Lt,{open:aA,onOpenChange:aB,children:(0,e.jsxs)(p.EO,{children:[(0,e.jsxs)(p.wd,{children:[(0,e.jsx)(p.r7,{children:"Delete Tank Fill"}),(0,e.jsx)(p.$v,{children:"Are you sure you want to delete this tank fill? This action cannot be undone."})]}),(0,e.jsxs)(p.ck,{children:[(0,e.jsx)(p.Zr,{children:"Cancel"}),(0,e.jsx)(p.Rx,{onClick:aK,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})]})]})})})});d()}catch(a){d(a)}})},28462:a=>{a.exports=import("@tanstack/react-query")},30101:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{y:()=>i});var e=c(8732),f=c(40273),g=c(78059),h=a([f,g]);function i({form:a}){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(f.J,{htmlFor:"volume",children:"Volume (L)"}),(0,e.jsx)(g.p,{id:"volume",type:"number",step:"0.01",...a.register("volume",{valueAsNumber:!0,onChange:b=>{let c=parseFloat(b.target.value);a.setValue("volume",isNaN(c)?0:c)}})}),a.formState.errors.volume&&(0,e.jsx)("p",{className:"text-sm text-destructive",children:a.formState.errors.volume.message})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(f.J,{htmlFor:"price_per_liter",children:"Price per Liter"}),(0,e.jsx)(g.p,{id:"price_per_liter",type:"number",step:"0.01",...a.register("price_per_liter",{valueAsNumber:!0,onChange:b=>{let c=parseFloat(b.target.value);a.setValue("price_per_liter",isNaN(c)?0:c)}})}),a.formState.errors.price_per_liter&&(0,e.jsx)("p",{className:"text-sm text-destructive",children:a.formState.errors.price_per_liter.message})]})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(f.J,{htmlFor:"cost",children:"Total Cost (USD)"}),(0,e.jsx)(g.p,{id:"cost",type:"number",step:"0.01",value:a.watch("cost"),readOnly:!0,className:"bg-background border border-input"}),(0,e.jsx)("p",{className:"text-xs text-muted-foreground",children:"Calculated: Volume \xd7 Price per Liter"}),a.formState.errors.cost&&(0,e.jsx)("p",{className:"text-sm text-destructive",children:a.formState.errors.cost.message})]})]})}[f,g]=h.then?(await h)():h,d()}catch(a){d(a)}})},33873:a=>{a.exports=require("path")},36307:a=>{a.exports=import("@radix-ui/react-dropdown-menu")},36421:(a,b,c)=>{function d(a){let b=a.watch("volume"),c=a.watch("price_per_liter");return{volume:b,pricePerLiter:c,previousMileage:a.watch("previous_mileage"),currentMileage:a.watch("current_mileage")}}c.d(b,{q:()=>d}),c(82015)},40361:a=>{a.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},41415:a=>{a.exports=import("sonner")},42971:a=>{a.exports=import("zod")},45311:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{config:()=>r,default:()=>n,getServerSideProps:()=>q,getStaticPaths:()=>p,getStaticProps:()=>o,handler:()=>z,reportWebVitals:()=>s,routeModule:()=>y,unstable_getServerProps:()=>w,unstable_getServerSideProps:()=>x,unstable_getStaticParams:()=>v,unstable_getStaticPaths:()=>u,unstable_getStaticProps:()=>t});var e=c(63885),f=c(80237),g=c(81413),h=c(65611),i=c.n(h),j=c(74780),k=c(22199),l=c(12289),m=a([j,k]);[j,k]=m.then?(await m)():m;let n=(0,g.M)(k,"default"),o=(0,g.M)(k,"getStaticProps"),p=(0,g.M)(k,"getStaticPaths"),q=(0,g.M)(k,"getServerSideProps"),r=(0,g.M)(k,"config"),s=(0,g.M)(k,"reportWebVitals"),t=(0,g.M)(k,"unstable_getStaticProps"),u=(0,g.M)(k,"unstable_getStaticPaths"),v=(0,g.M)(k,"unstable_getStaticParams"),w=(0,g.M)(k,"unstable_getServerProps"),x=(0,g.M)(k,"unstable_getServerSideProps"),y=new e.PagesRouteModule({definition:{kind:f.RouteKind.PAGES,page:"/FuelLogs",pathname:"/FuelLogs",bundlePath:"",filename:""},distDir:".next-fleet",relativeProjectDir:"",components:{App:j.default,Document:i()},userland:k}),z=(0,l.U)({srcPage:"/FuelLogs",config:r,userland:k,routeModule:y,getStaticPaths:p,getStaticProps:o,getServerSideProps:q});d()}catch(a){d(a)}})},46060:a=>{a.exports=require("next/dist/shared/lib/no-fallback-error.external.js")},47860:a=>{a.exports=import("@radix-ui/react-select")},48303:a=>{a.exports=import("@radix-ui/react-tooltip")},50802:a=>{a.exports=import("clsx")},52307:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{C5:()=>u,MJ:()=>s,Rr:()=>t,eI:()=>q,lR:()=>r,lV:()=>l,zB:()=>n});var e=c(8732),f=c(82015),g=c(9640),h=c(56884),i=c(87092),j=c(40273),k=a([g,h,i,j]);[g,h,i,j]=k.then?(await k)():k;let l=h.FormProvider,m=f.createContext({}),n=({...a})=>(0,e.jsx)(m.Provider,{value:{name:a.name},children:(0,e.jsx)(h.Controller,{...a})}),o=()=>{let a=f.useContext(m),b=f.useContext(p),{getFieldState:c,formState:d}=(0,h.useFormContext)(),e=c(a.name,d);if(!a)throw Error("useFormField should be used within <FormField>");let{id:g}=b;return{id:g,name:a.name,formItemId:`${g}-form-item`,formDescriptionId:`${g}-form-item-description`,formMessageId:`${g}-form-item-message`,...e}},p=f.createContext({}),q=f.forwardRef(({className:a,...b},c)=>{let d=f.useId();return(0,e.jsx)(p.Provider,{value:{id:d},children:(0,e.jsx)("div",{ref:c,className:(0,i.cn)("space-y-2",a),...b})})});q.displayName="FormItem";let r=f.forwardRef(({className:a,...b},c)=>{let{error:d,formItemId:f}=o();return(0,e.jsx)(j.J,{ref:c,className:(0,i.cn)(d&&"text-destructive",a),htmlFor:f,...b})});r.displayName="FormLabel";let s=f.forwardRef(({...a},b)=>{let{error:c,formItemId:d,formDescriptionId:f,formMessageId:h}=o();return(0,e.jsx)(g.Slot,{ref:b,id:d,"aria-describedby":c?`${f} ${h}`:`${f}`,"aria-invalid":!!c,...a})});s.displayName="FormControl";let t=f.forwardRef(({className:a,...b},c)=>{let{formDescriptionId:d}=o();return(0,e.jsx)("p",{ref:c,id:d,className:(0,i.cn)("text-sm text-muted-foreground",a),...b})});t.displayName="FormDescription";let u=f.forwardRef(({className:a,children:b,...c},d)=>{let{error:f,formMessageId:g}=o(),h=f?String(f?.message):b;return h?(0,e.jsx)("p",{ref:d,id:g,className:(0,i.cn)("text-sm font-medium text-destructive",a),...c,children:h}):null});u.displayName="FormMessage",d()}catch(a){d(a)}})},54725:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{K:()=>q});var e=c(8732);c(82015);var f=c(38661),g=c(94142),h=c(1971),i=c(75644),j=c(88324),k=c(30101),l=c(71429),m=c(99141),n=c(80655),o=c(52307),p=a([f,g,h,i,j,k,l,m,n,o]);function q({open:a,onOpenChange:b}){let{form:c,vehicles:d,isSubmitting:p,handleSubmit:q,shouldCloseDialog:r,resetCloseDialog:s,hasPreviousMileage:t}=(0,h.Z)();return(0,e.jsx)(f.lG,{open:a,onOpenChange:b,children:(0,e.jsxs)(f.Cf,{className:"max-w-xl",children:[(0,e.jsxs)(f.c7,{children:[(0,e.jsx)(f.L3,{children:"Add New Fuel Log"}),(0,e.jsx)(f.rr,{children:"Enter the fuel log details below. Required fields are marked with an asterisk."})]}),(0,e.jsx)(g.F,{className:"max-h-[calc(80vh-4rem)] pr-4",type:"always",children:(0,e.jsx)(o.lV,{...c,children:(0,e.jsxs)("form",{onSubmit:c.handleSubmit(q),className:"space-y-6 px-1",children:[(0,e.jsx)(i.B,{form:c,vehicles:d}),(0,e.jsx)(j.x,{form:c,vehicles:d}),(0,e.jsx)(k.y,{form:c}),(0,e.jsx)(l.C,{form:c,hasPreviousMileage:t}),(0,e.jsx)(m.a,{form:c}),(0,e.jsx)(n.I,{onCancel:()=>b(!1),isSubmitting:p,isEdit:!1})]})})})]})})}[f,g,h,i,j,k,l,m,n,o]=p.then?(await p)():p,d()}catch(a){d(a)}})},56884:a=>{a.exports=import("react-hook-form")},57312:a=>{a.exports=import("next-themes")},57973:a=>{a.exports=import("@radix-ui/react-alert-dialog")},58894:(a,b,c)=>{function d(a){return a&&"object"==typeof a&&"error"in a&&!0===a.error}function e(a){return Array.isArray(a)?a.filter(a=>!d(a)):[]}function f(a){return d(a)?null:a}c.d(b,{to:()=>f,wH:()=>e})},59638:(a,b,c)=>{c.d(b,{rh:()=>j,Hf:()=>l,N$:()=>i,x6:()=>h,Sw:()=>f,RS:()=>k,kw:()=>e,wE:()=>g});var d=c(95965);async function e(){try{let{data:a,error:b}=await d.N.from("vehicles").select("id, make, model, registration, fuel_type").order("make");if(b){if(b.message?.includes("fuel_type")||"42703"===b.code){console.log("fuel_type column not found, fetching vehicles without it");let{data:a,error:b}=await d.N.from("vehicles").select("id, make, model, registration").order("make");if(b)throw b;return a}throw b}return a}catch(a){throw console.error("Error fetching vehicles:",a),a}}async function f(a){if(!a)return{value:0,hasPrevious:!1};console.log("Fetching latest mileage for vehicle:",a);let{data:b,error:c}=await d.N.from("fuel_logs").select("current_mileage, date, created_at").eq("vehicle_id",a).order("date",{ascending:!1}).order("created_at",{ascending:!1}).limit(1);if(c)throw console.error("Error fetching latest mileage:",c),c;return(console.log("Latest mileage data:",b),b&&0!==b.length)?{value:Number(b[0]?.current_mileage??0)||0,hasPrevious:!0}:{value:0,hasPrevious:!1}}async function g(a,b){try{let c;console.log("Saving fuel log with values:",a);let e={vehicle_id:a.vehicle_id,date:a.date,fuel_type:(c=a.fuel_type,"diesel"===c?"diesel":"petrol"),volume:Number(a.volume),cost:Number(a.cost),previous_mileage:Number(a.previous_mileage),current_mileage:Number(a.current_mileage),mileage:Number(a.mileage),notes:a.notes||null,filled_by:a.filled_by||null,fuel_management_id:a.fuel_management_id?a.fuel_management_id:null},f={...e,...a.price_per_liter&&{price_per_liter:Number(a.price_per_liter)}};if(console.log("Formatted values:",f),e.fuel_management_id)try{let{data:a,error:b}=await d.N.from("fuel_management").select("id, fuel_type").eq("id",e.fuel_management_id).single();if(b)throw b;if(a&&a.fuel_type&&a.fuel_type!==e.fuel_type)throw Error(`Selected storage fuel type (${a.fuel_type}) does not match log fuel type (${e.fuel_type}).`)}catch(a){throw console.error("Storage validation failed:",a),a}if(b){console.log("Updating existing fuel log:",b);let{data:c,error:e}=await d.N.from("fuel_logs").update(f).eq("id",b).select(`
          *,
          vehicle:vehicles (
            make,
            model,
            registration
          )
        `).single();if(e)throw console.error("Update fuel log error:",e),console.error("Error details:",{message:e.message,code:e.code,details:e.details,hint:e.hint}),e;return console.log("Fuel log updated successfully:",c),a.fuel_management_id&&(console.log("Refreshing storage stats after fuel log update"),l()),{isNewRecord:!1,data:c}}{console.log("Creating new fuel log");let{data:b,error:c}=await d.N.from("fuel_logs").insert(f).select(`
          *,
          vehicle:vehicles (
            make,
            model,
            registration
          )
        `).single();if(c)throw console.error("Insert fuel log error:",c),console.error("Error details:",{message:c.message,code:c.code,details:c.details,hint:c.hint}),c;return console.log("Fuel log created successfully:",b),a.fuel_management_id&&(console.log("Refreshing storage stats after fuel log creation"),l()),{isNewRecord:!0,data:b}}}catch(a){throw console.error("saveFuelLog error:",a),a}}async function h(){try{let{data:a,error:b}=await d.N.from("fuel_management").select("*").order("fuel_type");if(b)throw console.error("Supabase error in getFuelStorages:",b),b;return a||[]}catch(a){throw console.error("Exception in getFuelStorages:",a),a}}async function i(a){try{let{data:b,error:c}=await d.N.from("fuel_fills").select("*").eq("fuel_management_id",a).order("fill_date",{ascending:!1});if(c)throw console.error(`Supabase error in getFuelFills for ${a}:`,c),c;return b||[]}catch(b){throw console.error(`Exception in getFuelFills for ${a}:`,b),b}}async function j(a){let{data:b,error:c}=await d.N.from("fuel_fills").insert([a]).select("*").single();if(c)throw c;return b}async function k(a){try{let{data:b,error:c}=await d.N.from("fuel_logs").select("volume").eq("fuel_management_id",a);if(c)throw console.error(`Error in getStorageDispensed for ${a}:`,c),c;return b?.reduce((a,b)=>a+(b.volume||0),0)||0}catch(b){throw console.error(`Error in getStorageDispensed for ${a}:`,b),b}}function l(){let a=new CustomEvent("fuelStorageDataUpdate",{detail:{timestamp:Date.now()}});window.dispatchEvent(a)}},60461:a=>{a.exports=import("@radix-ui/react-popover")},62430:(a,b,c)=>{c.d(b,{e:()=>e});var d=c(21839);function e(a,b){return(0,d.f)(a,-b)}},68953:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{Xi:()=>l,av:()=>m,j7:()=>k,tU:()=>j});var e=c(8732),f=c(82015),g=c(19640),h=c(87092),i=a([g,h]);[g,h]=i.then?(await i)():i;let j=g.Root,k=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.List,{ref:c,className:(0,h.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...b}));k.displayName=g.List.displayName;let l=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Trigger,{ref:c,className:(0,h.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...b}));l.displayName=g.Trigger.displayName;let m=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Content,{ref:c,className:(0,h.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...b}));m.displayName=g.Content.displayName,d()}catch(a){d(a)}})},71429:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{C:()=>i});var e=c(8732),f=c(40273),g=c(78059),h=a([f,g]);function i({form:a,hasPreviousMileage:b}){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(f.J,{htmlFor:"previous_mileage",children:"Previous Mileage (km)"}),(0,e.jsx)("input",{type:"number",...a.register("previous_mileage",{valueAsNumber:!0}),style:{display:"none"}}),(0,e.jsx)(g.p,{id:"previous_mileage_display",type:"text",value:b?String(a.watch("previous_mileage")??""):"-",readOnly:!0,className:"bg-muted"}),a.formState.errors.previous_mileage&&(0,e.jsx)("p",{className:"text-sm text-destructive",children:a.formState.errors.previous_mileage.message}),(0,e.jsx)("p",{className:"text-xs text-muted-foreground",children:"Last recorded odometer reading from previous fuel log"})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(f.J,{htmlFor:"current_mileage",children:"Current Mileage (km)"}),(0,e.jsx)(g.p,{id:"current_mileage",type:"number",placeholder:"Enter current odometer reading",...a.register("current_mileage",{valueAsNumber:!0,onChange:c=>{let d=parseInt(c.target.value);if(a.setValue("current_mileage",isNaN(d)?0:d),b){let b=a.getValues("previous_mileage"),c=Math.max(0,d-b);a.setValue("mileage",c)}else a.setValue("previous_mileage",isNaN(d)?0:d),a.setValue("mileage",0)}})}),a.formState.errors.current_mileage&&(0,e.jsx)("p",{className:"text-sm text-destructive",children:a.formState.errors.current_mileage.message})]})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(f.J,{htmlFor:"mileage",children:"Distance (km)"}),(0,e.jsx)(g.p,{id:"mileage",type:"text",value:String(a.watch("mileage")??""),readOnly:!0,className:"bg-muted border border-input"}),(0,e.jsx)("p",{className:"text-xs text-muted-foreground",children:"Calculated: Current Mileage − Previous Mileage"}),a.formState.errors.mileage&&(0,e.jsx)("p",{className:"text-sm text-destructive",children:a.formState.errors.mileage.message})]})]})}[f,g]=h.then?(await h)():h,d()}catch(a){d(a)}})},75644:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{B:()=>i});var e=c(8732),f=c(57049),g=c(52307),h=a([f,g]);function i({form:a,vehicles:b}){let c=c=>{a.setValue("vehicle_id",c);let d=b?.find(a=>a.id===c);if(d?.fuel_type){let b=d.fuel_type.toLowerCase();["petrol","diesel"].includes(b)&&a.setValue("fuel_type",b)}};return(0,e.jsx)(g.zB,{control:a.control,name:"vehicle_id",render:({field:a})=>(0,e.jsxs)(g.eI,{children:[(0,e.jsx)(g.lR,{children:"Vehicle"}),(0,e.jsxs)(f.l6,{onValueChange:c,defaultValue:a.value,children:[(0,e.jsx)(g.MJ,{children:(0,e.jsx)(f.bq,{children:(0,e.jsx)(f.yv,{placeholder:"Select a vehicle"})})}),(0,e.jsx)(f.gC,{children:b?.map(a=>(0,e.jsxs)(f.eb,{value:a.id,children:[a.make," ",a.model," - ",a.registration,a.fuel_type&&(0,e.jsxs)("span",{className:"text-muted-foreground ml-2",children:["(",a.fuel_type,")"]})]},a.id))})]}),(0,e.jsx)(g.C5,{})]})})}[f,g]=h.then?(await h)():h,d()}catch(a){d(a)}})},75979:a=>{a.exports=import("tailwind-merge")},80655:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{I:()=>i});var e=c(8732),f=c(66345),g=c(74952),h=a([f]);function i({onCancel:a,isSubmitting:b,isEdit:c,onDelete:d}){return(0,e.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,e.jsx)(f.$,{type:"button",variant:"outline",onClick:a,children:"Cancel"}),c&&d&&(0,e.jsxs)(f.$,{type:"button",variant:"destructive",onClick:d,children:[(0,e.jsx)(g.lMJ,{className:"h-4 w-4 mr-2"}),"Delete"]}),(0,e.jsx)(f.$,{type:"submit",disabled:b,children:b?"Saving...":c?"Update":"Save"})]})}f=(h.then?(await h)():h)[0],d()}catch(a){d(a)}})},81575:(a,b,c)=>{c.d(b,{H:()=>e});var d=c(73502);function e(a,b){let c,e,n=b?.additionalDigits??2,o=function(a){let b,c={},d=a.split(f.dateTimeDelimiter);if(d.length>2)return c;if(/:/.test(d[0])?b=d[0]:(c.date=d[0],b=d[1],f.timeZoneDelimiter.test(c.date)&&(c.date=a.split(f.timeZoneDelimiter)[0],b=a.substr(c.date.length,a.length))),b){let a=f.timezone.exec(b);a?(c.time=b.replace(a[1],""),c.timezone=a[1]):c.time=b}return c}(a);if(o.date){let a=function(a,b){let c=RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+b)+"})|(\\d{2}|[+-]\\d{"+(2+b)+"})$)"),d=a.match(c);if(!d)return{year:NaN,restDateString:""};let e=d[1]?parseInt(d[1]):null,f=d[2]?parseInt(d[2]):null;return{year:null===f?e:100*f,restDateString:a.slice((d[1]||d[2]).length)}}(o.date,n);c=function(a,b){var c,d,e,f,h,i,k;if(null===b)return new Date(NaN);let n=a.match(g);if(!n)return new Date(NaN);let o=!!n[4],p=j(n[1]),q=j(n[2])-1,r=j(n[3]),s=j(n[4]),t=j(n[5])-1;if(o){return(c=s,d=t,c>=1&&c<=53&&d>=0&&d<=6)?function(a,b,c){let d=new Date(0);d.setUTCFullYear(a,0,4);let e=d.getUTCDay()||7;return d.setUTCDate(d.getUTCDate()+((b-1)*7+c+1-e)),d}(b,s,t):new Date(NaN)}{let a=new Date(0);return(e=b,f=q,h=r,f>=0&&f<=11&&h>=1&&h<=(l[f]||(m(e)?29:28))&&(i=b,(k=p)>=1&&k<=(m(i)?366:365)))?(a.setUTCFullYear(b,q,Math.max(p,r)),a):new Date(NaN)}}(a.restDateString,a.year)}if(!c||isNaN(c.getTime()))return new Date(NaN);let p=c.getTime(),q=0;if(o.time&&isNaN(q=function(a){var b,c,e;let f=a.match(h);if(!f)return NaN;let g=k(f[1]),i=k(f[2]),j=k(f[3]);return(b=g,c=i,e=j,24===b?0===c&&0===e:e>=0&&e<60&&c>=0&&c<60&&b>=0&&b<25)?g*d.s0+i*d.Cg+1e3*j:NaN}(o.time)))return new Date(NaN);if(o.timezone){if(isNaN(e=function(a){var b;if("Z"===a)return 0;let c=a.match(i);if(!c)return 0;let e="+"===c[1]?-1:1,f=parseInt(c[2]),g=c[3]&&parseInt(c[3])||0;return(b=g)>=0&&b<=59?e*(f*d.s0+g*d.Cg):NaN}(o.timezone)))return new Date(NaN)}else{let a=new Date(p+q),b=new Date(0);return b.setFullYear(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()),b.setHours(a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()),b}return new Date(p+q+e)}let f={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},g=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,h=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,i=/^([+-])(\d{2})(?::?(\d{2}))?$/;function j(a){return a?parseInt(a):1}function k(a){return a&&parseFloat(a.replace(",","."))||0}let l=[31,null,31,30,31,30,31,31,30,31,30,31];function m(a){return a%400==0||a%4==0&&a%100!=0}},82015:a=>{a.exports=require("react")},86093:a=>{a.exports=require("react-day-picker")},87967:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{T:()=>i});var e=c(8732),f=c(82015),g=c(87092),h=a([g]);g=(h.then?(await h)():h)[0];let i=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)("textarea",{className:(0,g.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-0 focus-visible:ring-0 focus:ring-offset-0 focus-visible:ring-offset-0 focus:border-ring focus-visible:border-ring disabled:cursor-not-allowed disabled:opacity-50 transition-colors",a),ref:c,...b}));i.displayName="Textarea",d()}catch(a){d(a)}})},88324:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{x:()=>p});var e=c(8732),f=c(57049),g=c(52307),h=c(52670),i=c(81575),j=c(71913),k=c(78059),l=c(82015);c(59638);var m=c(4720),n=c(74952),o=a([f,g,h,k,m]);function p({form:a,vehicles:b}){let[c,d]=(0,l.useState)([]),o=a.watch("fuel_type"),p=a.watch("vehicle_id");c.filter(a=>a.fuel_type===o);let q=b?.find(a=>a.id===p),r=q?.fuel_type&&p;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(g.zB,{control:a.control,name:"date",render:({field:a})=>(0,e.jsxs)(g.eI,{className:"space-y-2",children:[(0,e.jsx)(g.lR,{children:"Date"}),(0,e.jsx)(g.MJ,{children:(0,e.jsx)(h.l,{date:a.value?(0,i.H)(a.value):void 0,onDateChange:b=>a.onChange(b?(0,j.GP)(b,"yyyy-MM-dd"):""),className:"w-full"})}),(0,e.jsx)(g.C5,{})]})}),(0,e.jsx)(g.zB,{control:a.control,name:"fuel_type",render:({field:a})=>{var b;return(0,e.jsxs)(g.eI,{className:"space-y-2",children:[(0,e.jsx)(g.lR,{children:"Fuel Type"}),r?(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2 p-3 border rounded-md bg-muted/50",children:[(0,e.jsx)(n.XHo,{className:"h-4 w-4 text-muted-foreground"}),(0,e.jsx)("span",{className:`font-medium ${(a=>{switch(a){case"diesel":return"text-orange-600";case"petrol":return"text-gray-600";default:return"text-muted-foreground"}})(a.value)}`,children:{petrol:"Petrol",diesel:"Diesel"}[b=a.value]||b}),(0,e.jsx)(m.E,{variant:"secondary",className:"ml-auto text-xs",children:"Auto-filled from vehicle"})]}),(0,e.jsx)(g.Rr,{className:"text-xs",children:"Fuel type automatically selected based on vehicle's fuel type. To change, select a different vehicle."})]}):(0,e.jsxs)(f.l6,{onValueChange:a.onChange,value:a.value,children:[(0,e.jsx)(g.MJ,{children:(0,e.jsx)(f.bq,{children:(0,e.jsx)(f.yv,{placeholder:"Select fuel type"})})}),(0,e.jsxs)(f.gC,{children:[(0,e.jsx)(f.eb,{value:"petrol",children:"Petrol"}),(0,e.jsx)(f.eb,{value:"diesel",children:"Diesel"})]})]}),(0,e.jsx)(g.C5,{})]})}}),(0,e.jsx)(g.zB,{control:a.control,name:"filled_by",render:({field:a})=>(0,e.jsxs)(g.eI,{className:"space-y-2",children:[(0,e.jsx)(g.lR,{children:"Filled By"}),(0,e.jsx)(g.MJ,{children:(0,e.jsx)(k.p,{type:"text",placeholder:"Enter name of person who filled the fuel",...a})}),(0,e.jsx)(g.C5,{})]})})]})}[f,g,h,k,m]=o.then?(await o)():o,d()}catch(a){d(a)}})},90192:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{SQ:()=>m,_2:()=>n,lp:()=>o,mB:()=>p,rI:()=>k,ty:()=>l});var e=c(8732),f=c(82015),g=c(36307),h=c(74952),i=c(87092),j=a([g,i]);[g,i]=j.then?(await j)():j;let k=g.Root,l=g.Trigger;g.Group,g.Portal,g.Sub,g.RadioGroup,f.forwardRef(({className:a,inset:b,children:c,...d},f)=>(0,e.jsxs)(g.SubTrigger,{ref:f,className:(0,i.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",b&&"pl-8",a),...d,children:[c,(0,e.jsx)(h.c_$,{className:"ml-auto h-4 w-4"})]})).displayName=g.SubTrigger.displayName,f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.SubContent,{ref:c,className:(0,i.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...b})).displayName=g.SubContent.displayName;let m=f.forwardRef(({className:a,sideOffset:b=4,...c},d)=>(0,e.jsx)(g.Portal,{children:(0,e.jsx)(g.Content,{ref:d,sideOffset:b,className:(0,i.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...c})}));m.displayName=g.Content.displayName;let n=f.forwardRef(({className:a,inset:b,...c},d)=>(0,e.jsx)(g.Item,{ref:d,className:(0,i.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",b&&"pl-8",a),...c}));n.displayName=g.Item.displayName,f.forwardRef(({className:a,children:b,checked:c,...d},f)=>(0,e.jsxs)(g.CheckboxItem,{ref:f,className:(0,i.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:c,...d,children:[(0,e.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,e.jsx)(g.ItemIndicator,{children:(0,e.jsx)(h.Jlk,{className:"h-4 w-4"})})}),b]})).displayName=g.CheckboxItem.displayName,f.forwardRef(({className:a,children:b,...c},d)=>(0,e.jsxs)(g.RadioItem,{ref:d,className:(0,i.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...c,children:[(0,e.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,e.jsx)(g.ItemIndicator,{children:(0,e.jsx)(h.jlt,{className:"h-2 w-2 fill-current"})})}),b]})).displayName=g.RadioItem.displayName;let o=f.forwardRef(({className:a,inset:b,...c},d)=>(0,e.jsx)(g.Label,{ref:d,className:(0,i.cn)("px-2 py-1.5 text-sm font-semibold",b&&"pl-8",a),...c}));o.displayName=g.Label.displayName;let p=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Separator,{ref:c,className:(0,i.cn)("-mx-1 my-1 h-px bg-muted",a),...b}));p.displayName=g.Separator.displayName,d()}catch(a){d(a)}})},90627:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{i:()=>j});var e=c(8732),f=c(95020),g=c(76569),h=c(95965),i=a([f]);function j({open:a,onOpenChange:b,fuelLog:c,onDelete:d}){let{toast:i}=(0,g.dj)(),j=async()=>{if(c)try{let{error:a}=await h.N.from("fuel_logs").delete().eq("id",c.id).single();if(a)throw a;i({title:"Fuel log deleted",description:"The fuel log has been deleted successfully."}),d()}catch(a){console.error("Error:",a),i({title:"Error",description:a instanceof Error?a.message:"Failed to delete fuel log",variant:"destructive"})}};return(0,e.jsx)(f.Lt,{open:a,onOpenChange:b,children:(0,e.jsxs)(f.EO,{children:[(0,e.jsxs)(f.wd,{children:[(0,e.jsx)(f.r7,{children:"Are you sure?"}),(0,e.jsx)(f.$v,{children:"This will permanently delete this fuel log. This action cannot be undone."})]}),(0,e.jsxs)(f.ck,{children:[(0,e.jsx)(f.Zr,{children:"Cancel"}),(0,e.jsx)(f.Rx,{onClick:j,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})}f=(i.then?(await i)():i)[0],d()}catch(a){d(a)}})},92175:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{q:()=>g});var e=c(42971),f=a([e]);let g=(e=(f.then?(await f)():f)[0]).z.object({vehicle_id:e.z.string().min(1,"Vehicle is required"),date:e.z.string().min(1,"Date is required"),fuel_type:e.z.enum(["petrol","diesel"]),volume:e.z.number().min(.01,"Volume must be greater than 0"),price_per_liter:e.z.number().min(.01,"Price per liter must be greater than 0"),cost:e.z.number().min(.01,"Cost must be greater than 0"),previous_mileage:e.z.number().min(0,"Previous mileage must be a positive number"),current_mileage:e.z.number().min(0,"Current mileage must be a positive number"),mileage:e.z.number().min(0,"Mileage must be a positive number"),notes:e.z.string().optional(),filled_by:e.z.string().optional(),fuel_management_id:e.z.union([e.z.string().uuid(),e.z.literal("")]).optional()}).refine(a=>a.current_mileage>=a.previous_mileage,{message:"Current mileage must be greater than or equal to previous mileage",path:["current_mileage"]}).refine(a=>a.mileage===Math.max(0,a.current_mileage-a.previous_mileage),{message:"Mileage must equal current mileage minus previous mileage",path:["mileage"]});d()}catch(a){d(a)}})},93939:a=>{a.exports=require("@supabase/supabase-js")},94142:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{F:()=>j});var e=c(8732),f=c(82015),g=c(14505),h=c(87092),i=a([g,h]);[g,h]=i.then?(await i)():i;let j=f.forwardRef(({className:a,children:b,...c},d)=>(0,e.jsxs)(g.Root,{ref:d,className:(0,h.cn)("relative overflow-hidden",a),...c,children:[(0,e.jsx)(g.Viewport,{className:"h-full w-full rounded-[inherit]",children:b}),(0,e.jsx)(k,{}),(0,e.jsx)(g.Corner,{})]}));j.displayName=g.Root.displayName;let k=f.forwardRef(({className:a,orientation:b="vertical",...c},d)=>(0,e.jsx)(g.ScrollAreaScrollbar,{ref:d,orientation:b,className:(0,h.cn)("flex touch-none select-none transition-colors","vertical"===b&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===b&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...c,children:(0,e.jsx)(g.ScrollAreaThumb,{className:"relative flex-1 rounded-full bg-border"})}));k.displayName=g.ScrollAreaScrollbar.displayName,d()}catch(a){d(a)}})},95020:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{$v:()=>r,EO:()=>n,Lt:()=>k,Rx:()=>s,Zr:()=>t,ck:()=>p,r7:()=>q,wd:()=>o});var e=c(8732),f=c(82015),g=c(57973),h=c(87092),i=c(66345),j=a([g,h,i]);[g,h,i]=j.then?(await j)():j;let k=g.Root;g.Trigger;let l=g.Portal,m=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Overlay,{className:(0,h.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...b,ref:c}));m.displayName=g.Overlay.displayName;let n=f.forwardRef(({className:a,...b},c)=>(0,e.jsxs)(l,{children:[(0,e.jsx)(m,{}),(0,e.jsx)(g.Content,{ref:c,className:(0,h.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...b})]}));n.displayName=g.Content.displayName;let o=({className:a,...b})=>(0,e.jsx)("div",{className:(0,h.cn)("flex flex-col space-y-2 text-center sm:text-left",a),...b});o.displayName="AlertDialogHeader";let p=({className:a,...b})=>(0,e.jsx)("div",{className:(0,h.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...b});p.displayName="AlertDialogFooter";let q=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Title,{ref:c,className:(0,h.cn)("text-lg font-semibold",a),...b}));q.displayName=g.Title.displayName;let r=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Description,{ref:c,className:(0,h.cn)("text-sm text-muted-foreground",a),...b}));r.displayName=g.Description.displayName;let s=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Action,{ref:c,className:(0,h.cn)((0,i.r)(),a),...b}));s.displayName=g.Action.displayName;let t=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Cancel,{ref:c,className:(0,h.cn)((0,i.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...b}));t.displayName=g.Cancel.displayName,d()}catch(a){d(a)}})},98825:a=>{a.exports=import("@hookform/resolvers/zod")},99141:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{a:()=>i});var e=c(8732),f=c(52307),g=c(87967),h=a([f,g]);function i({form:a}){return(0,e.jsx)(f.zB,{control:a.control,name:"notes",render:({field:a})=>(0,e.jsxs)(f.eI,{children:[(0,e.jsx)(f.lR,{children:"Notes"}),(0,e.jsx)(f.MJ,{children:(0,e.jsx)(g.T,{placeholder:"Any additional notes about this fuel log...",...a,value:a.value||""})}),(0,e.jsx)(f.C5,{})]})})}[f,g]=h.then?(await h)():h,d()}catch(a){d(a)}})}};var b=require("../webpack-runtime.js");b.C(a);var c=b.X(0,[4952,5611,5781,1913,4780,5833],()=>b(b.s=45311));module.exports=c})();