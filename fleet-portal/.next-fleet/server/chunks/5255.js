"use strict";exports.id=5255,exports.ids=[5255],exports.modules={5146:(a,b,c)=>{c.d(b,{O:()=>d});function d(a=[],b=[],c=[]){let e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map((a,b)=>({month:a,maintenance:0,fuel:0,spareParts:0,total:0}));return a&&Array.isArray(a)&&a.filter(a=>a?.status==="completed").forEach(a=>{if(a.date){let b=new Date(a.date).getMonth();e[b].maintenance+=Number(a.cost||0)}}),b&&Array.isArray(b)&&b.forEach(a=>{if(a.date){let b=new Date(a.date).getMonth();e[b].fuel+=Number(a.cost||0)}}),c&&Array.isArray(c)&&c.forEach(a=>{let b=a.last_used_date||a.purchase_date,c=Number(a.quantity_used||0);if(b&&c>0){let d=new Date(b).getMonth(),f=Number(a.unit_price||0);e[d].spareParts+=c*f}}),e.forEach(a=>{a.total=a.maintenance+a.fuel+a.spareParts}),e}},15449:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{j:()=>j});var e=c(82015),f=c(28462),g=c(95965),h=c(76569),i=a([f]);function j(a){let{toast:b}=(0,h.dj)(),c=new Date().getFullYear(),[d,i]=(0,e.useState)(null),j=Array.from({length:5},(a,b)=>(c-b).toString()),{data:k}=(0,f.useQuery)({queryKey:["vehicles-for-cost-analytics"],queryFn:async()=>{try{let{data:a,error:b}=await g.N.from("vehicles").select("id, make, model, registration");if(b)return console.error("Vehicles lookup data fetch error:",b),[];return a||[]}catch(a){return console.error("Error fetching vehicles lookup data:",a),[]}},staleTime:3e5}),{data:l,isLoading:m,error:n}=(0,f.useQuery)({queryKey:["maintenanceCosts",a],queryFn:async()=>{try{let{data:c,error:d}=await g.N.from("maintenance").select("cost, description, date, vehicle_id, status").gte("date",`${a}-01-01`).lte("date",`${a}-12-31`);if(d)return console.error("Maintenance data fetch error:",d),b({title:"Error fetching maintenance data",description:d.message,variant:"destructive"}),[];return console.log("Fetched maintenance data:",c),c||[]}catch(a){return console.error("Error fetching maintenance data:",a),[]}},retry:1,staleTime:3e5}),{data:o,isLoading:p,error:q}=(0,f.useQuery)({queryKey:["fuelCosts",a],queryFn:async()=>{try{let{data:c,error:d}=await g.N.from("fuel_logs").select("cost, fuel_type, date, vehicle_id, vehicles!fuel_logs_vehicle_id_fkey(make, model, registration)").gte("date",`${a}-01-01`).lte("date",`${a}-12-31`);if(d)return console.error("Fuel data fetch error:",d),b({title:"Error fetching fuel data",description:d.message,variant:"destructive"}),[];return c||[]}catch(a){return console.error("Error fetching fuel data:",a),[]}},retry:1,staleTime:3e5}),{data:r,isLoading:s,error:t}=(0,f.useQuery)({queryKey:["tripsRevenue",a],queryFn:async()=>{try{let{data:c,error:d}=await g.N.from("trips").select("id, amount, date, status, vehicle_id, vehicles!trips_vehicle_id_fkey(make, model, registration)").gte("date",`${a}-01-01`).lte("date",`${a}-12-31`).in("status",["completed"]);if(d)return console.error("Trips data fetch error:",d),b({title:"Error fetching trips data",description:d.message,variant:"destructive"}),[];return c||[]}catch(a){return console.error("Error fetching trips data:",a),[]}},retry:1,staleTime:3e5}),{data:u,isLoading:v,error:w}=(0,f.useQuery)({queryKey:["sparePartsCosts",a],queryFn:async()=>{try{let{data:c,error:d}=await g.N.from("spare_parts").select("*").not("purchase_date","is",null).gte("purchase_date",`${a}-01-01`).lte("purchase_date",`${a}-12-31`);if(d)return console.error("Spare parts data fetch error:",d),b({title:"Error fetching spare parts data",description:d.message,variant:"destructive"}),[];let e=c||[];console.log(`Filtered ${e.length} relevant spare parts for year ${a}`);let{data:f,error:h}=await g.N.from("maintenance").select("id, description, vehicle_id, vehicles!maintenance_vehicle_id_fkey(make, model, registration)");if(h)return console.error("Maintenance records fetch error:",h),[];let i={};f&&Array.isArray(f)&&f.forEach(a=>{a&&a.id&&(i[a.id]=a)});let j={};k&&Array.isArray(k)&&k.forEach(a=>{a&&a.id&&(j[a.id]=a)});let l=e.map(a=>{let b={...a,status:a.status,vehicles:null},c=null;if(b.maintenance_id&&i[b.maintenance_id]){let a=i[b.maintenance_id];a.vehicle_id&&j[a.vehicle_id]?c={make:j[a.vehicle_id].make,model:j[a.vehicle_id].model,registration:j[a.vehicle_id].registration}:a.vehicles&&(c=a.vehicles)}return{...b,vehicles:c}});return console.log("Processed spare parts data with vehicle relationships:",l),l}catch(a){return console.error("Error fetching spare parts data:",a),[]}},retry:1,staleTime:3e5}),{data:x,isLoading:y,error:z}=(0,f.useQuery)({queryKey:["maintenanceCosts",d],queryFn:async()=>{if(!d)return[];try{let{data:a,error:c}=await g.N.from("maintenance").select("cost, description, date, vehicle_id, status").gte("date",`${d}-01-01`).lte("date",`${d}-12-31`);if(c)return console.error("Comparison maintenance data fetch error:",c),b({title:"Error fetching comparison maintenance data",description:c.message,variant:"destructive"}),[];return a||[]}catch(a){return console.error("Error fetching comparison maintenance data:",a),[]}},enabled:!!d,retry:1,staleTime:3e5}),{data:A,isLoading:B,error:C}=(0,f.useQuery)({queryKey:["fuelCosts",d],queryFn:async()=>{if(!d)return[];try{let{data:a,error:c}=await g.N.from("fuel_logs").select("cost, fuel_type, date, vehicle_id, vehicles!fuel_logs_vehicle_id_fkey(make, model, registration)").gte("date",`${d}-01-01`).lte("date",`${d}-12-31`);if(c)return console.error("Comparison fuel data fetch error:",c),b({title:"Error fetching comparison fuel data",description:c.message,variant:"destructive"}),[];return a||[]}catch(a){return console.error("Error fetching comparison fuel data:",a),[]}},enabled:!!d,retry:1,staleTime:3e5}),{data:D,isLoading:E,error:F}=(0,f.useQuery)({queryKey:["tripsRevenue",d],queryFn:async()=>{if(!d)return[];try{let{data:a,error:c}=await g.N.from("trips").select("id, amount, date, status, vehicle_id, vehicles!trips_vehicle_id_fkey(make, model, registration)").gte("date",`${d}-01-01`).lte("date",`${d}-12-31`).in("status",["completed"]);if(c)return console.error("Comparison trips data fetch error:",c),b({title:"Error fetching comparison trips data",description:c.message,variant:"destructive"}),[];return a||[]}catch(a){return console.error("Error fetching comparison trips data:",a),[]}},enabled:!!d,retry:1,staleTime:3e5}),{data:G,isLoading:H,error:I}=(0,f.useQuery)({queryKey:["sparePartsCosts",d],queryFn:async()=>{if(!d)return[];try{let{data:a,error:c}=await g.N.from("spare_parts").select("*").not("purchase_date","is",null).gte("purchase_date",`${d}-01-01`).lte("purchase_date",`${d}-12-31`);if(c)return console.error("Comparison spare parts data fetch error:",c),b({title:"Error fetching comparison spare parts data",description:c.message,variant:"destructive"}),[];let e=a||[];console.log(`Filtered ${e.length} relevant comparison spare parts for year ${d}`);let{data:f,error:h}=await g.N.from("maintenance").select("id, description, vehicle_id, vehicles!maintenance_vehicle_id_fkey(make, model, registration)");if(h)return console.error("Maintenance records fetch error for comparison:",h),[];let i={};f&&Array.isArray(f)&&f.forEach(a=>{a&&a.id&&(i[a.id]=a)});let j={};return k&&Array.isArray(k)&&k.forEach(a=>{a&&a.id&&(j[a.id]=a)}),e.map(a=>{let b={...a,status:a.status,vehicles:null},c=null;if(b.maintenance_id&&i[b.maintenance_id]){let a=i[b.maintenance_id];a.vehicle_id&&j[a.vehicle_id]?c={make:j[a.vehicle_id].make,model:j[a.vehicle_id].model,registration:j[a.vehicle_id].registration}:a.vehicles&&(c=a.vehicles)}return{...b,vehicles:c}})}catch(a){return console.error("Error fetching comparison spare parts data:",a),[]}},enabled:!!d,retry:1,staleTime:3e5}),J=m||p||s||v||!!d&&(y||B||E||H);return{maintenanceData:l||[],fuelData:o||[],tripsData:r||[],sparePartsData:u||[],comparisonMaintenanceData:x||[],comparisonFuelData:A||[],comparisonTripsData:D||[],comparisonSparePartsData:G||[],isLoading:J,yearOptions:j,comparisonYear:d,setComparisonYear:i}}f=(i.then?(await i)():i)[0],d()}catch(a){d(a)}})},17535:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{S:()=>i});var e=c(28462),f=c(76569),g=c(16823),h=a([e]);function i(a){let b=(0,e.useQueryClient)(),{toast:c}=(0,f.dj)(),{data:d=[],isLoading:h,error:i,refetch:j}=(0,e.useQuery)({queryKey:["lease-invoices",a],queryFn:()=>(0,g.Qz)(a),staleTime:3e5}),k=(0,e.useMutation)({mutationFn:g.zw,onSuccess:a=>{a.success?c({title:"Invoices Generated Successfully",description:`Generated ${a.generatedCount} invoices for the current month.`}):c({title:"Invoice Generation Completed with Errors",description:`${a.generatedCount} invoices generated, ${a.errors.length} errors occurred.`,variant:"destructive"}),b.invalidateQueries({queryKey:["lease-invoices"]}),b.invalidateQueries({queryKey:["invoices"]})},onError:a=>{c({title:"Failed to Generate Invoices",description:a instanceof Error?a.message:"Unknown error occurred",variant:"destructive"})}}),l=(0,e.useMutation)({mutationFn:({leaseInvoiceId:a,status:b})=>(0,g.R9)(a,b),onSuccess:()=>{c({title:"Status Updated",description:"Lease invoice status updated successfully."}),b.invalidateQueries({queryKey:["lease-invoices"]})},onError:a=>{c({title:"Failed to Update Status",description:a instanceof Error?a.message:"Unknown error occurred",variant:"destructive"})}});return{leaseInvoices:d,isLoading:h,error:i,refetch:j,generateInvoices:k.mutate,isGenerating:k.isPending,updateStatus:l.mutate,isUpdating:l.isPending}}e=(h.then?(await h)():h)[0],d()}catch(a){d(a)}})},22779:(a,b,c)=>{c.d(b,{H:()=>d});function d(a=[],b=[],c=[]){let e={};return a&&Array.isArray(a)&&a.filter(a=>a?.status==="completed").forEach(a=>{let b=a.vehicle_id;if(!b)return;let c=a.vehicles?`${a.vehicles.make} ${a.vehicles.model} - ${a.vehicles.registration}`:"Unknown Vehicle";e[b]||(e[b]={vehicle_id:b,vehicle_name:c,maintenance:0,fuel:0,spareParts:0,total:0}),e[b].maintenance+=Number(a.cost||0)}),b&&Array.isArray(b)&&b.forEach(a=>{let b=a.vehicle_id;if(!b)return;let c=a.vehicles?`${a.vehicles.make} ${a.vehicles.model} - ${a.vehicles.registration}`:"Unknown Vehicle";e[b]||(e[b]={vehicle_id:b,vehicle_name:c,maintenance:0,fuel:0,spareParts:0,total:0}),e[b].fuel+=Number(a.cost||0)}),c&&Array.isArray(c)&&c.forEach(a=>{let b=a.vehicle_id;if(!b)return;let c=a.vehicle_name||"Unknown Vehicle";e[b]||(e[b]={vehicle_id:b,vehicle_name:c,maintenance:0,fuel:0,spareParts:0,total:0});let d=Number(a.quantity_used||0),f=Number(a.unit_price||0);e[b].spareParts+=d*f}),Object.values(e).forEach(a=>{a.total=a.maintenance+a.fuel+a.spareParts}),Object.values(e).sort((a,b)=>b.total-a.total)}},38807:(a,b,c)=>{c.d(b,{l:()=>d});let d=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d"]},45075:(a,b,c)=>{function d(a=[]){let b={};return a&&a.forEach(a=>{let c=a.description.split(" ")[0]||"Uncategorized";b[c]||(b[c]=0),b[c]+=Number(a.cost)}),Object.entries(b).map(([a,b])=>({name:a,value:b})).sort((a,b)=>b.value-a.value)}function e(a=[]){let b={};return a&&a.forEach(a=>{let c=a.fuel_type||"Other";b[c]||(b[c]=0),b[c]+=Number(a.cost)}),Object.entries(b).map(([a,b])=>({name:a,value:b})).sort((a,b)=>b.value-a.value)}c.d(b,{Y:()=>e,o:()=>d})},55686:(a,b,c)=>{function d(a=[],b=[],c=[],f=[],g=[],h=[],i,j){let k={currentYear:i,previousYear:j||"",maintenance:{current:0,previous:0,percentChange:0},fuel:{current:0,previous:0,percentChange:0},spareParts:{current:0,previous:0,percentChange:0},total:{current:0,previous:0,percentChange:0}};if(!j)return k;let l=Array.isArray(a)?a:[],m=Array.isArray(b)?b:[],n=Array.isArray(c)?c:[],o=Array.isArray(f)?f:[],p=Array.isArray(g)?g:[],q=Array.isArray(h)?h:[],r=l.filter(a=>a?.status==="completed"),s=o.filter(a=>a?.status==="completed");return k.maintenance.current=r.reduce((a,b)=>a+Number(b?.cost||0),0),k.fuel.current=m.reduce((a,b)=>a+Number(b?.cost||0),0),k.spareParts.current=n.reduce((a,b)=>a+Number(b?.quantity_used||0)*Number(b?.unit_price||0),0),k.total.current=k.maintenance.current+k.fuel.current+k.spareParts.current,k.maintenance.previous=s.reduce((a,b)=>a+Number(b?.cost||0),0),k.fuel.previous=p.reduce((a,b)=>a+Number(b?.cost||0),0),k.spareParts.previous=q.reduce((a,b)=>a+Number(b?.quantity_used||0)*Number(b?.unit_price||0),0),k.total.previous=k.maintenance.previous+k.fuel.previous+k.spareParts.previous,k.maintenance.percentChange=e(k.maintenance.previous,k.maintenance.current),k.fuel.percentChange=e(k.fuel.previous,k.fuel.current),k.spareParts.percentChange=e(k.spareParts.previous,k.spareParts.current),k.total.percentChange=e(k.total.previous,k.total.current),k}function e(a,b){return 0===a?100*(0!==b):(b-a)/a*100}c.d(b,{l:()=>d})},68953:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{Xi:()=>l,av:()=>m,j7:()=>k,tU:()=>j});var e=c(8732),f=c(82015),g=c(19640),h=c(87092),i=a([g,h]);[g,h]=i.then?(await i)():i;let j=g.Root,k=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.List,{ref:c,className:(0,h.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...b}));k.displayName=g.List.displayName;let l=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Trigger,{ref:c,className:(0,h.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...b}));l.displayName=g.Trigger.displayName;let m=f.forwardRef(({className:a,...b},c)=>(0,e.jsx)(g.Content,{ref:c,className:(0,h.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...b}));m.displayName=g.Content.displayName,d()}catch(a){d(a)}})},71277:(a,b,c)=>{function d(a=[],b=[],c=[],e=[],f=[],g=[]){let h=Array.isArray(a)?a:[],i=Array.isArray(b)?b:[],j=Array.isArray(c)?c:[],k=Array.isArray(e)?e:[],l=Array.isArray(f)?f:[],m=Array.isArray(g)?g:[],n=h.reduce((a,b)=>a+Number(b.amount||0),0),o=m.filter(a=>"paid"===a.status||"paid"===a.invoice_status).reduce((a,b)=>a+Number(b.amount||0),0),p=n+o,q=i.filter(a=>a&&"completed"===a.status);console.log("Financial Calcs - Completed maintenance items:",q.length);let r=q.reduce((a,b)=>a+Number(b.cost||0),0),s=j.reduce((a,b)=>a+Number(b.cost||0),0),t=k.reduce((a,b)=>{let c=Number(b.quantity_used||0);if(c>0){let d=Number(b.unit_price||0),e=c*d;return console.log("Part usage:",b.name,"Quantity used:",c,"Cost per unit:",d,"Usage cost:",e),a+e}return a},0),u=r+s+t;console.log("Financial Calcs - Maintenance costs:",r),console.log("Financial Calcs - Fuel costs:",s),console.log("Financial Calcs - Spare parts costs:",t),console.log("Financial Calcs - Total expenses:",u);let v=p-u,w=h.length;return{totalRevenue:p,totalExpenses:u,profit:v,profitMargin:p>0?v/p*100:0,tripCount:w,averageTripRevenue:w>0?p/w:0,monthlyData:function(a=[],b=[],c=[],d=[],e=[],f=[]){let g={};return Array.isArray(a)&&a.forEach(a=>{if(a.date)try{let b=new Date(a.date);if(isNaN(b.getTime()))return;let c=`${b.getFullYear()}-${String(b.getMonth()+1).padStart(2,"0")}`,d=b.toLocaleString("default",{month:"short",year:"numeric"});g[c]||(g[c]={month:d,revenue:0,expenses:0,profit:0,maintenance:0,fuel:0,spareParts:0,tripRevenue:0,leaseRevenue:0});let e=Number(a.amount||0);g[c].revenue+=e,g[c].tripRevenue=(g[c].tripRevenue||0)+e}catch(b){console.warn("Error processing trip date:",a.date,b)}}),Array.isArray(f)&&f.filter(a=>"paid"===a.status||"paid"===a.invoice_status).forEach(a=>{if(a.billing_period_start)try{let b=new Date(a.billing_period_start);if(isNaN(b.getTime()))return;let c=`${b.getFullYear()}-${String(b.getMonth()+1).padStart(2,"0")}`,d=b.toLocaleString("default",{month:"short",year:"numeric"});g[c]||(g[c]={month:d,revenue:0,expenses:0,profit:0,maintenance:0,fuel:0,spareParts:0,tripRevenue:0,leaseRevenue:0});let e=Number(a.amount||0);g[c].revenue+=e,g[c].leaseRevenue=(g[c].leaseRevenue||0)+e}catch(b){console.warn("Error processing lease invoice dates:",a.billing_period_start,b)}}),Array.isArray(b)&&b.forEach(a=>{if(a.date)try{let b=new Date(a.date);if(isNaN(b.getTime()))return;let c=`${b.getFullYear()}-${String(b.getMonth()+1).padStart(2,"0")}`,d=b.toLocaleString("default",{month:"short",year:"numeric"});g[c]||(g[c]={month:d,revenue:0,expenses:0,profit:0,maintenance:0,fuel:0,spareParts:0,tripRevenue:0,leaseRevenue:0});let e=Number(a.cost||0),f=g[c];f&&(f.maintenance=(f.maintenance||0)+e,f.expenses=(f.expenses||0)+e)}catch(b){console.warn("Error processing maintenance date:",a.date,b)}}),Array.isArray(c)&&c.forEach(a=>{if(a.date)try{let b=new Date(a.date);if(isNaN(b.getTime()))return;let c=`${b.getFullYear()}-${String(b.getMonth()+1).padStart(2,"0")}`,d=b.toLocaleString("default",{month:"short",year:"numeric"});g[c]||(g[c]={month:d,revenue:0,expenses:0,profit:0,maintenance:0,fuel:0,spareParts:0,tripRevenue:0,leaseRevenue:0});let e=Number(a.cost||0),f=g[c];f&&(f.fuel=(f.fuel||0)+e,f.expenses=(f.expenses||0)+e)}catch(b){console.warn("Error processing fuel date:",a.date,b)}}),Array.isArray(d)&&d.forEach(a=>{let b=Number(a.quantity_used||0);if(b>0){let c=a.last_used_date||a.purchase_date;if(!c)return;try{let d=new Date(c);if(isNaN(d.getTime()))return;let e=`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}`,f=d.toLocaleString("default",{month:"short",year:"numeric"});g[e]||(g[e]={month:f,revenue:0,expenses:0,profit:0,maintenance:0,fuel:0,spareParts:0});let h=Number(a.unit_price||0),i=b*h,j=g[e];j&&(j.spareParts=(j.spareParts||0)+i,j.expenses=(j.expenses||0)+i)}catch(a){console.warn("Error processing spare part date:",c,a)}}}),Object.values(g).forEach(a=>{a.profit=a.revenue-a.expenses}),Object.entries(g).sort(([a],[b])=>a.localeCompare(b)).map(([a,b])=>b)}(h,q,j,k,l,m),expenseBreakdown:{maintenance:r+t,fuel:s,spareParts:0},revenueBreakdown:{trips:n,vehicleLeases:o}}}function e(){let a=d([{amount:100,date:"2024-01-01"},{amount:200,date:"2024-01-15"},{amount:150,date:"2024-02-01"}],[{cost:50,status:"completed",date:"2024-01-10"},{cost:75,status:"completed",date:"2024-02-05"},{cost:25,status:"pending",date:"2024-01-20"}],[{cost:30,date:"2024-01-05"},{cost:45,date:"2024-02-01"}],[{quantity_used:2,unit_price:10,last_used_date:"2024-01-15"},{quantity_used:1,unit_price:25,last_used_date:"2024-02-10"},{quantity_used:0,unit_price:15,last_used_date:"2024-01-20"}],[{daily_rate:50,monthly_rate:1500,lease_status:"active",lease_start_date:"2024-01-01",lease_end_date:"2024-12-31"},{daily_rate:75,monthly_rate:2250,lease_status:"active",lease_start_date:"2024-02-01",lease_end_date:"2024-11-30"}],[]);return console.log("Test Results:",{expectedRevenue:4200,actualRevenue:a.totalRevenue,expectedExpenses:200,actualExpenses:a.totalExpenses,expectedProfit:4e3,actualProfit:a.profit,expectedMaintenance:125,actualMaintenance:a.expenseBreakdown.maintenance,expectedFuel:75,actualFuel:a.expenseBreakdown.fuel,expectedSpareParts:0,actualSpareParts:a.expenseBreakdown.spareParts,expectedTripRevenue:450,actualTripRevenue:a.revenueBreakdown.trips,expectedLeaseRevenue:3750,actualLeaseRevenue:a.revenueBreakdown.vehicleLeases}),a}c.d(b,{A:()=>e,a:()=>d})},90333:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{T:()=>k});var e=c(8732),f=c(39655),g=c(68953),h=c(90029),i=c(74952),j=a([f,g]);[f,g]=j.then?(await j)():j;let k=({comparisonData:a})=>{if(!a)return(0,e.jsx)(g.av,{value:"comparison",className:"space-y-4",children:(0,e.jsxs)(f.Zp,{children:[(0,e.jsxs)(f.aR,{children:[(0,e.jsx)(f.ZB,{children:"Year-over-Year Comparison"}),(0,e.jsx)(f.BT,{children:"Select a previous year to compare costs"})]}),(0,e.jsx)(f.Wu,{className:"flex items-center justify-center h-[300px]",children:(0,e.jsx)("p",{className:"text-muted-foreground",children:"No comparison data available. Please select a different year."})})]})});let{currentYear:b,previousYear:c,maintenance:d,fuel:j,total:k}=a,l=[{category:"Maintenance",[c]:d.previous,[b]:d.current},{category:"Fuel",[c]:j.previous,[b]:j.current},{category:"Total",[c]:k.previous,[b]:k.current}],m=a=>a>0?(0,e.jsxs)("div",{className:"flex items-center text-red-500",children:[(0,e.jsx)(i.Kpk,{className:"h-4 w-4 mr-1"}),a.toFixed(1),"%"]}):a<0?(0,e.jsxs)("div",{className:"flex items-center text-green-500",children:[(0,e.jsx)(i.ZLN,{className:"h-4 w-4 mr-1"}),Math.abs(a).toFixed(1),"%"]}):(0,e.jsxs)("div",{className:"flex items-center text-muted-foreground",children:[(0,e.jsx)(i.QGg,{className:"h-4 w-4 mr-1"}),"0%"]});return(0,e.jsxs)(g.av,{value:"comparison",className:"space-y-4",children:[(0,e.jsxs)(f.Zp,{children:[(0,e.jsxs)(f.aR,{children:[(0,e.jsx)(f.ZB,{children:"Year-over-Year Comparison"}),(0,e.jsxs)(f.BT,{children:["Comparing costs between ",b," and ",c]})]}),(0,e.jsx)(f.Wu,{className:"h-[400px] w-full",children:(0,e.jsx)(h.uf,{width:"100%",height:"100%",children:(0,e.jsxs)(h.Es,{data:l,margin:{top:20,right:30,left:20,bottom:5},children:[(0,e.jsx)(h.WX,{dataKey:"category"}),(0,e.jsx)(h.h8,{}),(0,e.jsx)(h.m_,{formatter:a=>[`$${a.toFixed(2)}`,void 0],contentStyle:{backgroundColor:"hsl(var(--background))",borderColor:"hsl(var(--border))",borderRadius:"6px"}}),(0,e.jsx)(h.s$,{}),(0,e.jsx)(h.yP,{name:c,dataKey:c,fill:"#8884d8"}),(0,e.jsx)(h.yP,{name:b,dataKey:b,fill:"#82ca9d"})]})})})]}),(0,e.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,e.jsxs)(f.Zp,{children:[(0,e.jsx)(f.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:(0,e.jsx)(f.ZB,{className:"text-sm font-medium",children:"Maintenance"})}),(0,e.jsx)(f.Wu,{children:(0,e.jsxs)("div",{className:"flex justify-between items-center",children:[(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-2xl font-bold",children:["$",d.current.toFixed(2)]}),(0,e.jsxs)("p",{className:"text-xs text-muted-foreground",children:["vs $",d.previous.toFixed(2)]})]}),(0,e.jsx)("div",{className:"text-lg",children:m(d.percentChange)})]})})]}),(0,e.jsxs)(f.Zp,{children:[(0,e.jsx)(f.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:(0,e.jsx)(f.ZB,{className:"text-sm font-medium",children:"Fuel"})}),(0,e.jsx)(f.Wu,{children:(0,e.jsxs)("div",{className:"flex justify-between items-center",children:[(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-2xl font-bold",children:["$",j.current.toFixed(2)]}),(0,e.jsxs)("p",{className:"text-xs text-muted-foreground",children:["vs $",j.previous.toFixed(2)]})]}),(0,e.jsx)("div",{className:"text-lg",children:m(j.percentChange)})]})})]}),(0,e.jsxs)(f.Zp,{children:[(0,e.jsx)(f.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:(0,e.jsx)(f.ZB,{className:"text-sm font-medium",children:"Total Costs"})}),(0,e.jsx)(f.Wu,{children:(0,e.jsxs)("div",{className:"flex justify-between items-center",children:[(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-2xl font-bold",children:["$",k.current.toFixed(2)]}),(0,e.jsxs)("p",{className:"text-xs text-muted-foreground",children:["vs $",k.previous.toFixed(2)]})]}),(0,e.jsx)("div",{className:"text-lg",children:m(k.percentChange)})]})})]})]})]})};d()}catch(a){d(a)}})},97203:(a,b,c)=>{c.d(b,{J:()=>d});function d(a=[],b=[],c=[]){let e=Array.isArray(a)?a:[],f=Array.isArray(b)?b:[],g=Array.isArray(c)?c:[],h=e.filter(a=>a?.status==="completed");console.log("Completed maintenance items:",h.length);let i=h.reduce((a,b)=>{let c=Number(b?.cost||0);return isNaN(c)?(console.warn("Invalid maintenance cost:",b?.cost,"for item:",b?.id),a):a+c},0),j=f.reduce((a,b)=>{let c=Number(b?.cost||0);return isNaN(c)?(console.warn("Invalid fuel cost:",b?.cost,"for item:",b?.id),a):a+c},0),k=g.reduce((a,b)=>{let c=Number(b?.quantity_used||0);if(c>0){let d=Number(b?.unit_price||0);if(isNaN(c)||isNaN(d))return console.warn("Invalid spare part data:",{quantity_used:b?.quantity_used,unit_price:b?.unit_price,part_id:b?.id}),a;let e=c*d;return console.log(`Spare part ${b.name}: ${c} used \xd7 $${d} = $${e}`),a+e}return a},0),l={maintenance:i+k,fuel:j,spareParts:0,total:0};return l.total=l.maintenance+l.fuel+l.spareParts,console.log("Calculated maintenance costs (including parts):",l.maintenance),console.log("Calculated fuel costs:",l.fuel),console.log("Calculated spare parts costs (included in maintenance):",k),console.log("Calculated total costs:",l.total),l}}};